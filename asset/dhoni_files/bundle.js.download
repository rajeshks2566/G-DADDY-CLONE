!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=19)}([function(t,e,n){"use strict";n.d(e,"o",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"l",(function(){return l})),n.d(e,"m",(function(){return f})),n.d(e,"t",(function(){return d})),n.d(e,"i",(function(){return h})),n.d(e,"k",(function(){return g})),n.d(e,"s",(function(){return m})),n.d(e,"r",(function(){return v})),n.d(e,"q",(function(){return y})),n.d(e,"p",(function(){return b})),n.d(e,"d",(function(){return E})),n.d(e,"g",(function(){return _})),n.d(e,"f",(function(){return S})),n.d(e,"n",(function(){return T})),n.d(e,"h",(function(){return O}));var r=n(6);function i(t,e){return!(!u(t)||!u(e))&&t.slice(0,e.length)===e}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!u(t)||!u(e))&&(n&&(t=t.toLowerCase(),e=e.toLowerCase()),t.slice(t.length-e.length)===e)}function a(t,e,n){var r=n;try{var i=e.split("."),o=t;i.forEach((function(t){return o=o[t]})),void 0!==o&&(r=o)}catch(t){}return r}function s(t,e){if(Array.isArray(t)&&"function"==typeof e)for(var n=0;n<t.length;n++)if(!0===e(t[n],n,t))return n;return-1}function c(t,e){var n;if(h(t))for(var r=Object.keys(t),i=0;i<r.length&&!n;i++){var o=r[i];e(t[o],o,t)&&(n=t[o])}else if(Array.isArray(t))for(var a=0;a<t.length&&!n;a++){e(t[a],a,t)&&(n=t[a])}return n}function u(t){return"string"==typeof t||t instanceof String}function l(t){return t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&(Number.isFinite?Number.isFinite(t):isFinite(t))}function f(t){return t instanceof Number&&(t=t.valueOf()),t!=t}var p=-1;function d(){return p++}function h(t){return t&&"object"===Object(r.a)(t)&&t.constructor===Object}function g(t,e){var n=t;h(e)&&Object.keys(e).forEach((function(t){var r=e[t];h(r)&&(r=n[t]&&h(n[t])?g({},n[t],r):g({},r)),void 0!==r&&(n[t]=r)}));for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];if(i&&i.length){var a=i.splice(0,1)[0];n=g.apply(void 0,[n,a].concat(i))}return n}function m(t){var e={};return t.filter((function(t){return!Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=!0)}))}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,n={};return t.filter((function(t){var r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)}))}function y(t){if(null==t)return"";if("string"==typeof t)return t;if(Array.isArray(t))return t.map((function(t){return u(t)?t:""}))+"";var e=t+"";return"0"===e&&1/t===Number.NEGATIVE_INFINITY?"-0":e}function b(t){if("number"==typeof t)return t;if(h(t)&&"function"==typeof t.valueOf){var e=t.valueOf();t=h(e)?e+"":e}return"string"!=typeof t?0===t?t:+t:+(t=t.replace(/^\s+|\s+$/g,""))}function E(t,e){return Object.keys(t).forEach((function(n){return e(t[n],n,t)})),t}function _(t,e){var n={};if(Array.isArray(t)&&u(e))for(var r=0;r<t.length;r++){var i=t[r][e];u(i)&&(n[i]||(n[i]=[]),n[i].push(t[r]))}return n}function S(t){return t.name?t.name:(t.toString().match(/function (.+?)\(/)||["",""])[1]}function T(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=t[e[r]];return n}function O(t){return!0===t||!1===t}},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return p}));var r=n(5),i=n(10),o=n(0),a=function(t){return!!Object(o.b)(r.a,(function(e){return t===e}))},s={showLevel:!0,displayAllErrors:!1},c=!1;void 0!==t&&void 0!==t.version&&t.version&&(c=!0);var u=String(c?t.env.SPLITIO_DEBUG:Object(i.a)()?localStorage.getItem("splitio_debug"):""),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r.b(t,Object(o.k)(e,s))},f=l("splitio-utils:logger"),p={enable:function(){Object(r.c)(r.a.DEBUG)},setLogLevel:function(t){a(t)?Object(r.c)(t):f.error("Invalid Log Level - No changes to the logs will be applied.")},disable:function(){Object(r.c)(r.a.NONE)},LogLevel:r.a};/^(enabled?|on)/i.test(u)?p.enable(r.a.DEBUG):a(u)?p.setLogLevel(u):p.disable(),e.b=l}).call(this,n(44))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))i.call(n,l)&&(c[l]=n[l]);if(r){s=r(n);for(var f=0;f<s.length;f++)o.call(n,s[f])&&(c[s[f]]=n[s[f]])}}return c}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return f}));var r=n(2),i=n(3),o=n(4),a=n.n(o),s={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"},c=s.DEBUG,u=function(t){c=t},l={showLevel:!0,displayAllErrors:!1},f=function(){function t(e,n){Object(r.a)(this,t),this.category=e,this.options=a()({},l,n)}return Object(i.a)(t,[{key:"debug",value:function(t){this._shouldLog(s.DEBUG)&&this._log(s.DEBUG,t)}},{key:"info",value:function(t){this._shouldLog(s.INFO)&&this._log(s.INFO,t)}},{key:"warn",value:function(t){this._shouldLog(s.WARN)&&this._log(s.WARN,t)}},{key:"error",value:function(t){(this.options.displayAllErrors||this._shouldLog(s.ERROR))&&this._log(s.ERROR,t)}},{key:"_log",value:function(t,e){var n=this._generateLogMessage(t,e);console.log(n)}},{key:"_generateLogMessage",value:function(t,e){var n="";return this.options.showLevel&&(n+="["+t+"]"+(t===s.INFO||t===s.WARN?" ":"")+" "),this.category&&(n+=this.category+" => "),n+e}},{key:"_shouldLog",value:function(t){var e=c,n=Object.keys(s).map((function(t){return s[t]}));return n.indexOf(t)>=n.indexOf(e)}}]),t}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var i,o,a,s;if(u(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),void 0===a)a=o[e]=n,++t._eventsCount;else if("function"==typeof a?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(t))>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return t}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=p.bind(r);return i.listener=n,r.wrapFn=i,i}function h(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):m(i,i.length)}function g(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[t];if(void 0===c)return!1;if("function"==typeof c)o(c,this,e);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)o(l[n],this,e)}return!0},s.prototype.addListener=function(t,e){return f(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return f(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,d(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,d(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,i,o,a;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return h(this,t,!0)},s.prototype.rawListeners=function(t){return h(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(t,e,n){"use strict";const{idTypes:r,PARAMETER_LABEL:i}=n(12),{validateApp:o,updateCohortAllocationsWithEid:a,generateDefaultAllocations:s,groupEligibleExperimentsById:c}=n(26),{getSubjectKey:u,getCohortId:l,getSubjectIdType:f,treatmentsToCohortAllocations:p,transformSplitToExperiment:d}=n(27),h=n(30);t.exports={hivemindConstants:{idTypes:r,PARAMETER_LABEL:i},MockWrapper:h,validateApp:o,updateCohortAllocationsWithEid:a,generateDefaultAllocations:s,groupEligibleExperimentsById:c,getSubjectKey:u,getCohortId:l,getSubjectIdType:f,treatmentsToCohortAllocations:p,transformSplitToExperiment:d}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"hivemindConstants",{enumerable:!0,get:function(){return i.hivemindConstants}}),Object.defineProperty(e,"getClient",{enumerable:!0,get:function(){return o.getClient}}),e.default=void 0;var r,i=n(8),o=n(31);var a=((r=n(16))&&r.__esModule?r:{default:r}).default;e.default=a},function(t,e,n){"use strict";function r(){var t="__SPLITSOFTWARE__";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}n.d(e,"a",(function(){return r}))},function(t,e,n){t.exports=n(45)},function(t,e){t.exports={idTypes:{SHOPPER_ID:"shopperId",VISITOR_GUID:"visitorGuid"},DEFAULT_COHORT:"ineligible",PARAMETER_LABEL:"parameter"}},function(t,e,n){"use strict";e.__esModule=!0,e._setWindow=e._setNavigator=e._setDocument=e._getWindowEvent=e._getEventElement=e._getClickCoordinates=e._findPosY=e._findPosX=e.parseCookie=e.getPromoEventData=e.isSupported=e.isCorporateHost=e.iterateAncestors=e.isValidHrefElement=e.getWindow=e.getNavigator=e.getHost=e.getDocument=e.getClickEventData=e.getBaseHost=e.getAttributeFromElement=e.formatPageName=void 0;var r,i=n(33),o=(r=i)&&r.__esModule?r:{default:r},a=n(14);var s,c,u,l=(c={document:s={cookie:""}},u={},"undefined"==typeof window?{window:c,document:s,navigator:u}:{window:window||c,document:window.document||s,navigator:navigator||u}),f=function(){return l.window},p=function(){return l.document};var d=function(){return l.navigator},h=function(){var t=f().location;return t&&t.hostname?t.hostname:""},g=function(t){var e=h();t&&o.default.isSet(t)&&(e=o.default.get(t));var n=e.split(".");n.length>=2&&(e=n.slice(n.length-2).join("."));return e},m=function(t,e,n){if(n&&n.clientX&&n.clientY&&n.pageX&&n.pageY){var r={};if(t&&e&&-1!==e.userAgent.indexOf("MSIE")){var i="CSS1Compat"===t.compatMode?t.documentElement:t.body;r.pagex=Math.round(n.clientX+(i.scrollLeft?i.scrollLeft:0)),r.pagey=Math.round(n.clientY+(i.scrollTop?i.scrollTop:0))}else r.pagex=Math.round(n.pageX),r.pagey=Math.round(n.pageY);return r.clientx=Math.round(n.clientX),r.clienty=Math.round(n.clientY),r}},v=function(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetLeft,t=t.offsetParent;else t.x&&(e+=t.x);return e},y=function(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e+=t.y);return e},b=function t(e,n,r){var i=r||1;if(n&&!(i>10)){var o=e(n);return!o&&n.parentNode?t(e,n.parentNode,i+1):o}},E=function(){return f().event},_=function(){var t=E();if(null!=t){var e=t.target||t.srcElement;if(null!=e)return e.nodeType&&3===e.nodeType&&(e=e.parentNode),e}},S=function(t,e){if(t&&t.attributes&&t.attributes[e]&&t.attributes[e].value)return t.attributes[e].value},T=function(t){var e=t.nodeName;return"A"===e||"AREA"===e};e.formatPageName=function(t){return"string"!=typeof t||void 0===t||""===t?"notspecified":(t.lastIndexOf("/")===t.length-1&&(t=t.substring(0,t.length-1)),0!==t.indexOf("/")&&(t="/"+t),t)},e.getAttributeFromElement=S,e.getBaseHost=g,e.getClickEventData=function(t,e){var n=p(),r=d(),i=e||E(),o=t||_(),s={};if(o){s.type=o.type,s.eventid=o.id,s.eventclass=o.className,s.eventname=o.name,b((function(t){var e=S(t,"data-tcode"),n=S(t,"data-tdata"),r=S(t,"data-ci"),i=S(t,"data-tms"),o=S(t,"data-eid");o||(o=S(t,"data-e_id")),o||(o=S(t,"e_id"));var a=void 0;if(T(t)&&(a=S(t,"href")),e||n||r||i||o||a)return e&&(s.tcode=e),n&&(s.usrin=n),r&&(s.ci=r),i&&(s.tms=i),o&&(s.e_id=o),a&&(s.href=a),s}),o);var c=m(n,r,i);if(c)s.absolutex=c.pagex,s.absolutey=c.pagey,s.relativex=c.clientx,s.relativey=c.clienty;else{var u=v(o),l=y(o);s.absolutex=u,s.absolutey=l,s.relativex=u,s.relativey=l}}return(0,a.removeUndefined)(s),s},e.getDocument=p,e.getHost=h,e.getNavigator=d,e.getWindow=f,e.isValidHrefElement=T,e.iterateAncestors=b,e.isCorporateHost=function(t){var e=t||g();return e.indexOf("godaddy.com")>=0||e.indexOf("secureserver.net")>=0},e.isSupported=function(){var t=d().userAgent.toLowerCase();return!/msie [1-8]\./.test(t)},e.getPromoEventData=function(t){var e=t||_(),n={},r={schema:"data-schema",id:"data-promo-id",name:"data-promo-name",creative_name:"data-creative-name",creative_slot:"data-creative-slot"};return e&&b((function(t){(0,a.map)(r,(function(e,r){var i=S(t,r);i&&!n[e]&&(n[e]=i)})),T(t)&&(n.href=S(t,"href"))}),e),n},e.parseCookie=function(t){for(var e=t.split(";"),n=Object.create(null),r=0;r<e.length;r++){var i=/([^=]*)*=([\s\S]*)/.exec(e[r]);if(i&&i[2]){var o=i[1].trim(),a=decodeURIComponent(i[2].trim());n[o]=a}}return n},e._findPosX=v,e._findPosY=y,e._getClickCoordinates=m,e._getEventElement=_,e._getWindowEvent=E,e._setDocument=function(t){var e=t||{};l.window.document=e,l.document=e},e._setNavigator=function(t){l.navigator=t||{}},e._setWindow=function(t){l.window=t||{}}},function(t,e,n){"use strict";e.__esModule=!0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=arguments,o=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];try{if(e(n,r))return t}catch(t){}}return t},a=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var a={},s=0;s<i.length;s++){var c=e[s];"object"===(void 0===c?"undefined":r(c))&&o(c,(function(t,e){a[t]=e}))}return a},s=function(t){for(var e in t)void 0===t[e]&&delete t[e]},c=function(t){if(2===t.length)return t[1]},u=function(t,e,n){if("string"!=typeof t)return{};for(var r={},i=t.split(e),o=0;o<i.length;o++){var a=i[o].split(n);r[a[0]]=c(a)}return r},l=function(t,e,n){var r=[];return o(t,(function(t,e){r.push(""+t+n+e)})),0===r.length?"":r.join(e)},f=function(t,e,n){t&&e&&o(t,(function(r,i){var o=(r+"").split(e).join(n||"");delete t[r],t[o]=i}))};e.cleanKeyNames=f,e.map=o,e.merge=a,e.parseString=u,e.parseValue=c,e.stringify=l,e.removeUndefined=s},function(t,e,n){"use strict";e.__esModule=!0,e._resetCookieCache=e._notifyWatchers=e.watchCookie=e.setCookie=e.getCookieValues=e.getCookieValue=e.getCookieObj=e.getCookieKeys=e.findCookie=e.checkCookiesEnabled=void 0;var r=n(13),i=n(14),o=void 0,a=void 0,s=function(t,e,n,i){var o=new Date;o.setTime(o.getTime()+60*n*1e3),(0,r.getDocument)().cookie=t+"="+encodeURI(e)+"; domain="+(0,r.getBaseHost)()+(n?"; expires="+o.toGMTString():"")+(i?"; path="+i:"")},c=function(t){var e=(0,r.getDocument)().cookie;return o!==e&&(a=(0,r.parseCookie)(e),o=e),a[t]},u=function(t){var e=c(t);return(0,i.parseString)(e,"&","=")},l=void 0,f=void 0,p=[],d=function(){for(var t=0;t<p.length;t++)try{!0===p[t]()&&p.splice(t,1)}catch(t){continue}};e.checkCookiesEnabled=function(t){var e=!!t.cookieEnabled;return void 0!==t.cookieEnabled||e||(s((0,r.getDocument)(),"testcookie"),e=-1!==(0,r.getDocument)().cookie.indexOf("testcookie")),e},e.findCookie=c,e.getCookieKeys=function(){for(var t=[],e=(0,r.getDocument)().cookie.split(";"),n=0;n<e.length;n++){var i=e[n].split("=")[0];""!==i&&t.push(i.trim())}return t},e.getCookieObj=function(t){var e=c(t);try{return e=JSON.parse(e)}catch(t){return}},e.getCookieValue=function(t,e){var n=u(t);if(n.hasOwnProperty(e))return n[e]},e.getCookieValues=u,e.setCookie=s,e.watchCookie=function(t){!0!==t()&&(p.push(t),1===p.length&&(f=setInterval((function(){l!==(0,r.getDocument)().cookie&&(l=(0,r.getDocument)().cookie,d()),0===p.length&&clearInterval(f)}),200)))},e._notifyWatchers=d,e._resetCookieCache=function(){o=void 0,a=Object.create(null)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSubjectKeys=h,e.logCohorts=g,e.default=void 0;var r=n(8),i=a(n(40)),o=a(n(43));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function t(e){var n=this,a=e.app,s=e.splitioWrappers,c=e.splitioOptions,u=e.subject,f=e.loadLocalStorage,p=void 0===f?i.default:f,d=e.readyTimeout,h=void 0===d?3e3:d,g=e.mockData,m=e.preloadLocation,v=e.usePreload,y=void 0===v||v;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(0,r.validateApp)(a),this._app=a,this._readyTimeout=h;var b=!1;y&&Object.entries(u).forEach((function(t){var e=l(t,2),r=e[0],i=e[1];b=p({app:n._app,idType:r,id:i,preloadLocation:m})})),this._subject=u,g&&(s=this._getMockWrappers(g,u)),this._splitioWrappers=s||Object.entries(u).reduce((function(t,e){var r=l(e,2),i=r[0],a=r[1];return t[i]=new o.default({app:n._app,idType:i,id:a,splitioOptions:c,preloadExists:b,usePreload:y}),t}),{}),this._defaultSplitioWrapper=Object.values(this._splitioWrappers)[0],this._ready=new Promise((function(t){return Promise.race([Promise.all(Object.values(n._splitioWrappers).map((function(t){return t.ready}))),new Promise((function(t,e){return setTimeout((function(){return e(new Error("timeout"))}),n._readyTimeout)}))]).then(t).catch((function(e){console.log("Hivemind Client not ready from cache. Will return default values.",e),t("timeout")}))}))}var e,n,a;return e=t,(n=[{key:"setMockData",value:function(t){this._splitioWrappers=this._getMockWrappers(t,this._subject),this._defaultSplitioWrapper=Object.values(this._splitioWrappers)[0]}},{key:"_getMockWrappers",value:function(t,e){return Object.entries(e).reduce((function(e,n){var i=l(n,2),o=i[0];return i[1],e[o]=new r.MockWrapper({mockData:t}),e}),{})}},{key:"getCohorts",value:function(t){var e=t.experiments,n=void 0===e?[]:e,r=t.labels,i=void 0===r?[]:r,o=t.attributes,a=void 0===o?{}:o,s=t.windowOverride,c=void 0===s?window:s;if(n.length){var u=this._defaultSplitioWrapper.getExperimentsById(n);return this._getCohorts({experimentsMetadata:u,experiments:n,attributes:a,windowOverride:c})}if(i.length){var l=this._getExperimentsByLabel(i),f=Object.keys(l);return this._getCohorts({experimentsMetadata:l,experiments:f,attributes:a,windowOverride:c})}return console.log("No experiments or labels provided"),this._getCohorts({attributes:a,windowOverride:c})}},{key:"_getCohorts",value:function(t){var e=this,n=t.experimentsMetadata,i=void 0===n?{}:n,o=t.experiments,a=void 0===o?[]:o,s=t.attributes,u=void 0===s?{}:s,f=t.windowOverride,p=void 0===f?window:f,d=(0,r.groupEligibleExperimentsById)({subject:this._subject,experiments:a,experimentsMetadata:i}),m=d.experimentsByIdType,v=d.ineligibleExperiments,y={};Object.entries(m).map((function(t){var n=l(t,2),r=n[0],i=n[1],o=e._splitioWrappers[r].getCohortAllocations({experiments:i,attributes:u});y=c(c({},y),o)})),y=(0,r.updateCohortAllocationsWithEid)(y,this._app);var b=h(this._subject);g(y,b,p),Object.keys(y).forEach((function(t){return delete y[t].error}));var E=(0,r.generateDefaultAllocations)(v);return{cohorts:y=c(c({},y),E)}}},{key:"getExperiments",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.labels,n=void 0===e?[]:e,r=n.length?this._getExperimentsByLabel(n):this._defaultSplitioWrapper.getExperiments();return Object.values(r)}},{key:"_getExperimentsByLabel",value:function(t){var e=this._defaultSplitioWrapper.getExperiments();return Object.entries(e).reduce((function(e,n){var r=l(n,2),i=r[0],o=r[1];return t.every((function(t){return o.labels.includes(t)}))&&(e[i]=o),e}),{})}},{key:"getParameterValue",value:function(t){var e=t.parameter,n=t.defaultValue,i=t.attributes,o=void 0===i?{}:i,a=t.windowOverride,s=void 0===a?window:a,c=this._getExperimentsByLabel([this._app,r.hivemindConstants.PARAMETER_LABEL]),u=Object.entries(c).reduce((function(t,n){var r=l(n,2),i=r[0],o=r[1];return Object.values(o.cohortData).some((function(t){return e in t}))&&(t[i]=o),t}),{}),f=Object.keys(u),p=f.length;if(1===p){var d=this._getCohorts({experimentsMetadata:u,experiments:f,attributes:o,windowOverride:s}).cohorts[f[0]],h=d.data;return{parameterValue:e in h?h[e]:n,cohortId:d.cohortId,experimentId:f[0]}}return p>1&&console.log("Multiple experiments containing the same parameter definition."),{parameterValue:n,cohortId:null,experimentId:null}}},{key:"ready",get:function(){return this._ready}}])&&p(e.prototype,n),a&&p(e,a),t}();function h(t){var e={};return Object.entries(t).forEach((function(t){var n=l(t,2),i=n[0],o=n[1];e[i]=(0,r.getSubjectKey)({idType:i,id:o})})),e}function g(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;for(var i in n._expDataLayer=n._expDataLayer||[],t)n._expDataLayer.push({schema:"add_experiment_assignment",type:"abn",version:"v1",data:{experiment_id:i,variant_id:t[i].error?"error":t[i].cohortId}}),n._expDataLayer.push({schema:"add_impression",version:"v1",data:{eid:t[i].eid,properties:{hashedShopperId:e[r.hivemindConstants.idTypes.SHOPPER_ID],visitorGuid:e[r.hivemindConstants.idTypes.VISITOR_GUID]}}})}e.default=d},function(t){t.exports=JSON.parse('{"_args":[["@splitsoftware/splitio@10.15.2","/app"]],"_development":true,"_from":"@splitsoftware/splitio@10.15.2","_id":"@splitsoftware/splitio@10.15.2","_inBundle":false,"_integrity":"sha1-WsjBtJP09gaAmuLapNwA7EyFNOA=","_location":"/@splitsoftware/splitio","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"@splitsoftware/splitio@10.15.2","name":"@splitsoftware/splitio","escapedName":"@splitsoftware%2fsplitio","scope":"@splitsoftware","rawSpec":"10.15.2","saveSpec":null,"fetchSpec":"10.15.2"},"_requiredBy":["/@godaddy/hivemind-sdk-browser"],"_resolved":"https://artifactory.secureserver.net/artifactory/api/npm/node-virt/@splitsoftware/splitio/-/splitio-10.15.2.tgz","_spec":"10.15.2","_where":"/app","author":{"name":"Facundo Cabrera","email":"facundo@split.io"},"bugs":{"url":"https://github.com/splitio/javascript-client/issues"},"contributors":[{"name":"Nico Zelaya","email":"nicolas.zelaya@split.io","url":"https://github.com/NicoZelaya"}],"dependencies":{"@babel/runtime":"^7.10.2","@types/google.analytics":"0.0.40","@types/node":"^13.9.1","events":"3.1.0","eventsource":"^1.0.7","ioredis":"4.18.0","ip":"1.1.5","js-yaml":"3.13.1","node-fetch":"^2.6.1","object-assign":"^4.1.1","unfetch":"^4.1.0","utfx":"1.0.1"},"description":"Split SDK","devDependencies":{"@babel/cli":"^7.10.5","@babel/core":"^7.10.2","@babel/plugin-transform-runtime":"^7.10.1","@babel/preset-env":"^7.10.2","@babel/register":"^7.10.1","babel-loader":"^8.1.0","copyfiles":"^2.2.0","cross-env":"^7.0.2","csv-streamify":"4.0.0","eslint":"^6.8.0","eslint-plugin-compat":"^3.8.0","fetch-mock":"^9.4.0","karma":"^5.1.1","karma-chrome-launcher":"^3.1.0","karma-tap":"4.1.4","karma-webpack":"^4.0.2","lodash":"^4.17.19","proxyquire":"^2.1.3","puppeteer":"^3.0.0","redis-dump":"0.1.10","redis-server":"1.2.2","rimraf":"^3.0.2","sinon":"^9.0.2","tap-summary":"4.0.0","tape":"4.13.2","tape-catch":"1.0.6","webpack":"^4.42.0","webpack-cli":"^3.3.11","webpack-merge":"^4.2.2"},"engines":{"node":">=6","npm":">=3"},"files":["README.md","CONTRIBUTORS-GUIDE.md","LICENSE","CHANGES.txt","lib","types/*.d.ts","es","src"],"greenkeeper":{"ignore":["karma","karma-tap","karma-webpack"]},"homepage":"https://github.com/splitio/javascript-client#readme","license":"Apache-2.0","main":"lib/index.js","module":"es/index.js","name":"@splitsoftware/splitio","optionalDependencies":{"eventsource":"^1.0.7"},"repository":{"type":"git","url":"git+https://github.com/splitio/javascript-client.git"},"scripts":{"browser-test-suite":"npm run test-browser-ci && npm run test-browser-e2e-ci && npm run test-browser-offline && npm run test-browser-destroy && npm run test-browser-errors && npm run test-browser-gaintegration","build-cjs":"rimraf lib && cross-env NODE_ENV=cjs babel ./src -d lib --ignore \'__tests__\'","build-es":"rimraf es && cross-env NODE_ENV=es babel ./src -d es --ignore \'__tests__\'","build-umd":"webpack --config webpack.dev.js && webpack --config webpack.prod.js","build-umd:ci":"webpack --config webpack.ci.dev.js --env.branch=$BUILD_BRANCH --env.commit_hash=$BUILD_COMMIT && webpack --config webpack.ci.prod.js --env.branch=$BUILD_BRANCH --env.commit_hash=$BUILD_COMMIT","build-umd:stats":"webpack --progress --env production --json > ./stats/stat_results.json","canary":"npm run rebuild && npm publish --tag canary","lint":"eslint src","node-test-suite":"npm run test-node && npm run test-node-e2e && npm run test-node-destroy && npm run test-node-offline && npm run test-node-redis && npm run test-node-errors","postbuild-cjs":"cross-env NODE_ENV=cjs node scripts/copy.packages.json.js","postbuild-es":"cross-env NODE_ENV=es node scripts/copy.packages.json.js","posttest-ts-decls":"npm unlink && npm install","pretest-ts-decls":"npm run build-es && npm run build-cjs && npm link","rebuild":"rimraf lib umd es && npm run build-cjs && npm run build-es && npm run build-umd","rebuild:ci":"rimraf lib umd es && npm run build-cjs && npm run build-es && npm run build-umd:ci","rebuild:npm":"rimraf lib es && npm run build-cjs && npm run build-es","stable":"npm run rebuild && npm publish","test":"npm run browser-test-suite && npm run node-test-suite","test-browser-ci":"cross-env NODE_ENV=test karma start karma/ci.karma.conf.js","test-browser-destroy":"cross-env NODE_ENV=test karma start karma/destroy.ci.karma.conf.js","test-browser-e2e-ci":"cross-env NODE_ENV=test karma start karma/e2e.ci.karma.conf.js","test-browser-e2e-local":"cross-env NODE_ENV=test karma start karma/e2e.local.karma.conf.js","test-browser-errors":"cross-env NODE_ENV=test karma start karma/errors.ci.karma.conf.js","test-browser-gaintegration":"cross-env NODE_ENV=test karma start karma/gaintegration.ci.karma.conf.js","test-browser-local":"cross-env NODE_ENV=test karma start karma/local.karma.conf.js","test-browser-offline":"cross-env NODE_ENV=test karma start karma/offline.karma.conf.js","test-browser-push":"cross-env NODE_ENV=test karma start karma/push.ci.karma.conf.js","test-node":"cross-env NODE_ENV=test tape -r @babel/register \\"src/*/**/__tests__/**/!(browser).spec.js\\" | tap-summary","test-node-destroy":"cross-env NODE_ENV=test tape -r @babel/register src/__tests__/destroy/node.spec.js | tap-summary","test-node-e2e":"cross-env NODE_ENV=test tape -r @babel/register src/__tests__/node.spec.js | tap-summary","test-node-errors":"cross-env NODE_ENV=test tape -r @babel/register src/__tests__/errorCatching/node.spec.js | tap-summary","test-node-offline":"cross-env NODE_ENV=test tape -r @babel/register src/__tests__/offline/node.spec.js | tap-summary","test-node-push":"cross-env NODE_ENV=test tape -r @babel/register src/__tests__/push/node.spec.js | tap-summary","test-node-redis":"cross-env NODE_ENV=test tape -r @babel/register \\"src/__tests__/node_redis.spec.js\\" | tap-summary","test-ts-decls":"./scripts/ts-tests.sh"},"types":"types","version":"10.15.2"}')},function(t,e){t.exports='<div id=gdchat-tray-button-dynamic class="gdchat-tray-button m-b-1"> </div> <div id=gdchat-tray-button-native class="gdchat-tray-button m-b-1"> </div>'},function(t,e,n){n(20),t.exports=n(47)},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var u={};function l(){}function f(){}function p(){}var d={};d[i]=function(){return this};var h=Object.getPrototypeOf,g=h&&h(h(T([])));g&&g!==e&&n.call(g,i)&&(d=g);var m=p.prototype=l.prototype=Object.create(d);function v(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function y(t){var e;this._invoke=function(r,i){function o(){return new Promise((function(e,o){!function e(r,i,o,a){var s=c(t[r],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(l).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,a)}))}a(s.arg)}(r,i,e,o)}))}return e=e?e.then(o,o):o()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=m.constructor=p,p.constructor=f,p[a]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},v(y.prototype),y.prototype[o]=function(){return this},t.AsyncIterator=y,t.async=function(e,n,r,i){var o=new y(s(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},v(m),m[a]="Generator",m[i]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){var r=n(22);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(24)(r,i);r.locals&&(t.exports=r.locals)},function(t,e,n){(e=n(23)(!1)).push([t.i,"/*==============================*/\n/*  Helper Styles               */\n/*==============================*/\n\n/* Box Sizing */\n.liveEngage__bz-Border-Box, .liveEngage__bz-Border-Box * { box-sizing: border-box; }\n.liveEngage__bz-Content-Box, .liveEngage__bz-Content-Box * { box-sizing: content-box; }\n\n/* Display */\n.liveEngage__ds-Block { display: block; }\n.liveEngage__ds-Flex { display: flex; }\n.liveEngage__ds-Table { display: table; }\n.liveEngage__ds-Table-Cell { display: table-cell; }\n.liveEngage__ds-Inline-Block { display: inline-block; }\n\n/* Background Colors */\n.liveEngage__bg-White { background-color: #fff; }\n.liveEngage__bg-Gray-Light { background-color: #e8e8e8; }\n.liveEngage__bg-Purple { background-color: #7a0087; }\n.liveEngage__bg-Green { background-color: #00ab55; }\n\n/* Font Colors */\n.liveEngage__fc-White { color: #fff; }\n.liveEngage__fc-Gray-Medium-Dark { color: #7a7a7a; }\n.liveEngage__fc-Purple { color: #7a0087; }\n\n/* Hover States */\n.liveEngage__hv-Opacity { transition: opacity 150ms; }\n.liveEngage__hv-Opacity:hover { opacity: 0.66; }\n.liveEngage__hv-Purple-White { transition: background-color 150ms, color 150ms; }\n.liveEngage__hv-Purple-White:hover { background-color: #7a0087; color: #fff; }\n\n/* Font Families */\n.liveEngage__ff-Boing-Bold { font-family: Boing-Bold, \"Arial Black\", sans-serif; }\n.liveEngage__ff-Sans-Serif { font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif; }\n\n/* Text Alignment */\n.liveEngage__ta-Left { text-align: left; }\n.liveEngage__ta-Center { text-align: center; }\n.liveEngage__ta-Right { text-align: right; }\n\n/* Borders */\n.liveEngage__bd-TRBL { border: solid 1px; }\n.liveEngage__bd-RBL { border: solid 1px; border-top: none; }\n.liveEngage__bd-TRL { border: solid 1px; border-bottom: none; }\n.liveEngage__bdc-Gray-Medium { border-color: #a1a1a1; }\n.liveEngage__bdr-3px { border-radius: 3px; }\n.liveEngage__bdr-5px { border-radius: 5px; }\n\n/* Cursor */\n.liveEngage__crs-Default { cursor: default; }\n.liveEngage__crs-Pointer { cursor: pointer; }\n.liveEngage__crs-Help { cursor: help; }\n\n/* Box Shadows */\n.liveEngage__bs-Dialog { box-shadow: rgba(0, 0, 0, 0.08) 0 4px 12px,\n                         rgba(0, 0, 0, 0.14) 0 2px 8px,\n                         rgba(0, 0, 0, 0.20) 0 1px 3px;\n}\n\n/* Overflow */\n.liveEngage__ov-Hidden { overflow: hidden; }\n.liveEngage__ov-ScrollX { overflow-x: scroll; overflow-y: hidden; }\n.liveEngage__ov-ScrollY { overflow-x: hidden; overflow-y: scroll; }\n.liveEngage__ov-Visible { overflow: visible; }\n\n/* Padding */\n.liveEngage__pd-10px { padding: 10px; }\n.liveEngage__pd-20px { padding: 20px; }\n\n/* SVG */\n.liveEngage__svg-Fill-White { fill: #fff; }\n.liveEngage__svg-Fill-Purple { fill: #7a0087; }\n.liveEngage__svg-Fill-Green { fill: #00ab55; }\n.liveEngage__svg-Fill-Gray-Light { fill: #e8e8e8; }\n.liveEngage__svg-Fill-Gray-Medium { fill: #a1a1a1; }\n.liveEngage__svg-Fill-Gray-Medium-Dark { fill: #7a7a7a; }\n\n/* Transforms */\n.liveEngage__tf-Origin-Center { transform-origin: 50% 50%; }\n\n/* User Select */\n.liveEngage__us-None { user-select: none; }\n.liveEngage__us-Text { user-select: text; }\n\n/* Animations */\n@keyframes liveEngage__fade {\n  0% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes liveEngage__ballBlink {\n  0% {\n    opacity: 0.7;\n  }\n  33.33% {\n    opacity: 0.55;\n  }\n  66.67% {\n    opacity: 0.4;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes liveEngage__hide {\n  100% {\n    opacity: 0;\n    margin-left: -9999em;\n  }\n}\n\n.liveEngage__anim-Fade-In { animation: liveEngage__fade 150ms ease-in 0s 1 forwards; }\n.liveEngage__anim-Ball-Blink { animation: liveEngage__ballBlink 1.1s 0s infinite cubic-bezier(0.445, 0.050, 0.550, 0.950); }\n.liveEngage__anim-Hide { animation: liveEngage__hide 300ms 0s 1 forwards; }\n.liveEngage__anim-Delay-300ms { animation-delay: 300ms; }\n.liveEngage__anim-Delay-500ms { animation-delay: 500ms; }\n.liveEngage__anim-Delay-600ms { animation-delay: 600ms; }\n.liveEngage__anim-Delay-4900ms { animation-delay: 4900ms; }\n.liveEngage__anim-Delay-3s { animation-delay: 3s; }\n.liveEngage__anim-Delay-4s { animation-delay: 4s; }\n.liveEngage__anim-Delay-5s { animation-delay: 5s; }\n.liveEngage__anim-Delay-6s { animation-delay: 6s; }\n\n/* Tip Offset and Alignment */\n.liveEngage__offset-Left {\n  margin-right: 10px;\n  margin-bottom: 80px;\n}\n@media screen and (min-width: 480px) {\n  .liveEngage__offset-Left {\n    margin-right: 90px;\n    margin-bottom: 10px;\n  }\n}\n\n\n\n/*==============================*/\n/*  GD Chat Styles              */\n/*==============================*/\n\n.gdchat-fixed-bottom-right {\n  position: fixed;\n  bottom: 0px;\n  right: 0px;\n  z-index: 108000;\n  margin: 0.6em;\n}\n\n.gdchat-fixed-bottom-left {\n  position: fixed;\n  bottom: 0px;\n  left: 0px;\n  z-index: 108000;\n  margin: 0.6em;\n}\n\n.gdchat-fixed-bottom-right > div {\n  pointer-events: none;\n}\n\n.gdchat-fixed-bottom-left > div {\n  pointer-events: none;\n}\n\n.gdchat-fixed-bottom-right > div * {\n  pointer-events: auto;\n}\n\n.gdchat-fixed-bottom-left > div * {\n  pointer-events: auto;\n}\n\n.gdchat-fixed-bottom-right .chat-image-circle {\n  background-color: #7a0087;\n  border: 1px solid #7a0087;\n  cursor: pointer;\n  min-width: 0;\n}\n\n.gdchat-fixed-bottom-left .chat-image-circle {\n  background-color: #7a0087;\n  border: 1px solid #7a0087;\n  cursor: pointer;\n  min-width: 0;\n}\n\n.chat-image-circle {\n  display: block;\n  border-radius: 50% !important;\n  padding: 0.7em !important;\n  margin: 0 auto;\n  min-width: 0;\n}\n\n.chat-image-circle img {\n  display: block;\n}\n\n.gdchat-proactive .chat-image-circle {\n  background-color: #e8e8e8;\n  border: 1px solid #e8e8e8;\n  padding: 0.3em;\n  margin-bottom: 0.3em;\n}\n\n\n/* Styles for LiveEngage Q4 2020 visual refresh */\n\n/* Hero image area */\n.lp-window-root .lp_agent_image_area_wrapper {\n  border-bottom: none !important;\n  margin-top: 25px !important;\n}\n\n/* Routing buttons */\n.lp-window-root .lp-json-pollock-layout-vertical {\n  border: none !important;\n  background: none !important;\n}\n.lp-window-root .lpc_message_agent.lpc_message_card {\n  padding: 0 !important;\n}\n.lp-window-root .lp-json-pollock-element-text {\n  background-color: #D9DFFD !important;\n  padding: 12px 18px !important;\n  font-size: 14px !important;\n  line-height: 18px !important;\n  border-radius: 14px !important;\n  border-bottom-left-radius: 0 !important;\n  margin-bottom: 10px !important;\n}\n.lp-window-root .lp-json-pollock-element-button {\n  border: none !important;\n  margin: 6px 0 !important;\n}\n.lp-window-root .lp-json-pollock-element-button button {\n  background-color: #fff !important;\n  border: 1px solid #D1D1D1 !important;\n  border-radius: 20px !important;\n  color: #6B6B6B !important;\n  font-size: 14px !important;\n  line-height: 18px !important;\n  padding: 2px 10px !important;\n  text-align: center !important;\n  cursor: pointer !important;\n}\n\n/* Agent and user messages */\n.lp-window-root .lpc_message_agent {\n  padding: 12px 18px !important;\n  font-size: 14px !important;\n  line-height: 18px !important;\n}\n.lp-window-root .agent_avatar {\n  border-radius: 50% !important;\n  width: 45px !important;\n  height: 45px !important;\n}\n.lp-window-root .lpc_message_visitor {\n  padding: 12px 18px !important;\n  font-size: 14px !important;\n  line-height: 18px !important;\n}\n.lp-window-root .lp_line_state {\n  padding-right: 12px !important;\n}\n\n/* LP logo */\n.lp-window-root .lp_top_logo_bar {\n  display: none !important;\n}\n\n/* All other buttons */\n.lp-window-root .chips-item,\n.lp-window-root .lp_confirm_button,\n.lp-window-root .lp_cancel_button {\n  background-color: #fff !important;\n  border: 1px solid #D1D1D1 !important;\n  border-radius: 20px !important;\n  color: #6B6B6B !important;\n  font-size: 14px !important;\n  line-height: 18px !important;\n  padding: 2px 10px !important;\n  text-align: center !important;\n}\n.lp-window-root button:hover {\n  box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.15) !important;\n  color: #000 !important;\n}\n\n/* Links */\n.lp-window-root .lp-json-pollock-element-button[style*='background-color:###link;'] {\n  position: relative !important;\n}\n\n.lp-window-root .lp-json-pollock-element-button[style*='background-color:###link;'] button {\n  border: none !important;\n  text-decoration: underline !important;\n  text-align: left !important;\n  background-color: transparent !important;\n  margin-left: 20px;\n  padding: 2px 0 !important;\n  color: #09757a !important;\n}\n\n.lp-window-root .lp-json-pollock-element-button[style*='background-color:###link;'] button:hover {\n  box-shadow: none !important;\n  color: #00a4a6 !important;\n}\n\n.lp-window-root .lp-json-pollock-element-button[style*='background-color:###link;'] button::before {\n  background-image: url('https://img1.wsimg.com/dc-assets/live-engage/images/link-icon.png');\n  background-size: 14px 14px;\n  width: 14px; \n  height: 14px;\n  content: \"\";\n  position: absolute;\n  left: 0;\n  top: 10px;\n}\n\n.lp-window-root .lp-json-pollock-element-button[style*='background-color:###link;'] button:hover::before {\n  background-image: url('https://img1.wsimg.com/dc-assets/live-engage/images/link-icon-hover.png');\n}\n\n.lp-window-root .lp-json-pollock-element-image {\n  border: none !important;\n  position: relative !important;\n}\n\n/* Styles for Contact Us and Chat Now buttons */\n\n.help--contact-us {\n  display: flex;\n  outline: none !important;\n  border: none !important;\n  background: none !important;\n}\n\n.help--contact-us div {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 30px;\n  height: 40px;\n  padding: 0 20px;\n  background: linear-gradient(166.66deg, #1F75CE 4.62%, #1779CF 4.62%, #744BC4 86.29%);\n  cursor: pointer;\n}\n\n.help--contact-us[disabled] div {\n  background: #c4c4c4;\n  cursor: default;\n}\n\n.help--contact-us img {\n  width: 24px;\n  height: 24px;\n  margin-right: 5px;\n}\n\n.help--contact-us span {\n  color: #fff;\n  font-size: 16px;\n  font-weight: bold;\n}\n\n.help--chat-now {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 100px;\n  padding: 10px 20px;\n  background-color: #000;\n  cursor: pointer;\n}\n\n.help--chat-now[disabled] {\n  opacity: 0.4;\n  cursor: default;\n}\n\n.help--chat-now img {\n  margin-right: 10px;\n  width: 22px !important;\n  height: 22px;\n}\n\n.help--chat-now span {\n  color: #fff;\n  font-weight: bold;\n  font-size: 16px;\n  white-space: nowrap;\n}\n\n@keyframes help--load-spin {\n  100% { \n    transform: rotate(360deg); \n  } \n}\n\n.help--media-hover {\n  position: absolute !important;\n  left: 0px;\n  top: 0px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.help--media-hover .hover-icon {\n  background-color: #fff;\n  padding: 10px;\n  margin: 5px;\n  border-radius: 50%;\n  cursor: pointer;\n}\n\n.help--media-overlay {\n  position: absolute;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 99999999;\n}\n\n.help--media-overlay .button-container {\n  display: flex;\n  align-items: center;\n  position: absolute;\n  right: 25px;\n  top: 25px;\n}\n\n.help--media-overlay .button-container img {\n  width: 24px;\n  height: 24px;\n  cursor: pointer;  \n}\n\n.help--media-overlay .button-container div:first-child {\n  border-right: 1px solid #fff;\n  padding: 0px 10px 0px 10px;\n}\n\n.help--media-overlay .button-container div:last-child {\n  padding: 0px 0px 0px 10px;\n}\n\n/* Override the LPM container z-index to ensure that the UI will cover the button for engagements that implement LiveEngage's \"Eye-Catcher\" feature */\n\n.LPMcontainer {\n  z-index: 108001 !important;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(o).concat([i]).join("\n")}var a,s,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){var r,i,o={},a=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=r.apply(this,arguments)),i}),s=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t.call(this,n)),e[n]}}((function(t){return document.querySelector(t)})),c=null,u=0,l=[],f=n(25);function p(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(y(r.parts[a],e))}else{var s=[];for(a=0;a<r.parts.length;a++)s.push(y(r.parts[a],e));o[r.id]={id:r.id,refs:1,parts:s}}}}function d(t,e){for(var n=[],r={},i=0;i<t.length;i++){var o=t[i],a=e.base?o[0]+e.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function h(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),l.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function m(t){var e=document.createElement("style");return t.attrs.type="text/css",v(e,t.attrs),h(t,e),e}function v(t,e){Object.keys(e).forEach((function(n){t.setAttribute(n,e[n])}))}function y(t,e){var n,r,i,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var a=u++;n=c||(c=m(e)),r=_.bind(null,n,a,!1),i=_.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",v(e,t.attrs),h(t,e),e}(e),r=T.bind(null,n,e),i=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),r=S.bind(null,n),i=function(){g(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=d(t,e);return p(n,e),function(t){for(var r=[],i=0;i<n.length;i++){var a=n[i];(s=o[a.id]).refs--,r.push(s)}t&&p(d(t,e),e);for(i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}};var b,E=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function _(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=E(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function S(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function T(t,e,n){var r=n.css,i=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||o)&&(r=f(r)),i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var i,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?t:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:r+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(t,e,n){"use strict";const{DEFAULT_COHORT:r}=n(12);t.exports={validateApp:function(t=""){if(!t.match(/^[a-z0-9_-]+$/))throw new Error("Parameter 'app' must match regex '/^[a-z0-9_-]+$/'")},updateCohortAllocationsWithEid:function(t,e){return Object.keys(t).forEach(n=>{const r=t[n].error?"error":t[n].cohortId;t[n].eid=`hivemind.${e}.experiment.${n}.${r}.impression`}),t},generateDefaultAllocations:function(t){return t.reduce((t,e)=>Object.assign(t,{[e]:{cohortId:r,data:{}}}),{})},groupEligibleExperimentsById:function({subject:t,experiments:e,experimentsMetadata:n}){const r=e.filter(t=>!(t in n));return{experimentsByIdType:Object.entries(n).reduce((e,[n,i])=>(t[i.subjectIdType]?(e[i.subjectIdType]||(e[i.subjectIdType]=[]),e[i.subjectIdType].push(n)):r.push(n),e),{}),ineligibleExperiments:r}}}},function(t,e,n){"use strict";const{unflatten:r}=n(28),{idTypes:i,DEFAULT_COHORT:o}=n(12),{sha256:a}=n(29);function s(t){return"control"===t?o:t}function c(t){switch(t){case"shopper":return i.SHOPPER_ID;case"visitor":return i.VISITOR_GUID;default:return t}}t.exports={getCohortId:s,getSubjectKey:function({id:t,idType:e}){switch(e){case i.SHOPPER_ID:return a(t);case i.VISITOR_GUID:return t;default:throw new Error("Invalid subject idType")}},getSubjectIdType:c,treatmentsToCohortAllocations:function(t){const e={};return Object.keys(t).forEach(n=>{const{treatment:i,config:o}=t[n];e[n]={cohortId:s(i),error:"control"===i,data:r(JSON.parse(o)||{})}}),e},transformSplitToExperiment:function(t){const e={experimentId:t.name,subjectIdType:c(t.trafficType),killed:t.killed,cohorts:t.treatments,cohortData:Object.keys(t.configs).reduce((e,n)=>(e[n]=r(JSON.parse(t.configs[n])||{}),e),{})},n=Object.values(e.cohortData).find(t=>t.labels);return e.labels=n?n.labels:[],e}}},function(t,e){function n(t){return t&&t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function r(t){return t}function i(t,e){const i=(e=e||{}).delimiter||".",o=e.maxDepth,a=e.transformKey||r,s={};return function t(r,c,u){u=u||1,Object.keys(r).forEach((function(l){const f=r[l],p=e.safe&&Array.isArray(f),d=Object.prototype.toString.call(f),h=n(f),g="[object Object]"===d||"[object Array]"===d,m=c?c+i+a(l):a(l);if(!p&&!h&&g&&Object.keys(f).length&&(!e.maxDepth||u<o))return t(f,m,u+1);s[m]=f}))}(t),s}t.exports=i,i.flatten=i,i.unflatten=function t(e,o){const a=(o=o||{}).delimiter||".",s=o.overwrite||!1,c=o.transformKey||r,u={};if(n(e)||"[object Object]"!==Object.prototype.toString.call(e))return e;function l(t){const e=Number(t);return isNaN(e)||-1!==t.indexOf(".")||o.object?t:e}return e=Object.keys(e).reduce((function(t,n){const r=Object.prototype.toString.call(e[n]);return!("[object Object]"===r||"[object Array]"===r)||function(t){const e=Object.prototype.toString.call(t),n="[object Array]"===e,r="[object Object]"===e;if(!t)return!0;if(n)return!t.length;if(r)return!Object.keys(t).length}(e[n])?(t[n]=e[n],t):function(t,e,n){return Object.keys(n).reduce((function(e,r){return e[t+a+r]=n[r],e}),e)}(n,t,i(e[n],o))}),{}),Object.keys(e).forEach((function(n){const r=n.split(a).map(c);let i=l(r.shift()),f=l(r[0]),p=u;for(;void 0!==f;){if("__proto__"===i)return;const t=Object.prototype.toString.call(p[i]),e="[object Object]"===t||"[object Array]"===t;if(!s&&!e&&void 0!==p[i])return;(s&&!e||!s&&null==p[i])&&(p[i]="number"!=typeof f||o.object?{}:[]),p=p[i],r.length>0&&(i=l(r.shift()),f=l(r[0]))}p[i]=t(e[n],o)})),u}},function(t,e){t.exports={sha256:t=>{const e=(t,e)=>{const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},n=(t,e)=>t>>>e|t<<32-e,r=(t,e)=>t>>>e,i=(t,e,n)=>t&e^~t&n,o=(t,e,n)=>t&e^t&n^e&n,a=t=>n(t,2)^n(t,13)^n(t,22),s=t=>n(t,6)^n(t,11)^n(t,25),c=t=>n(t,7)^n(t,18)^r(t,3);return(t=>{const e="0123456789abcdef";let n="";for(let r=0;r<4*t.length;r++)n+=e.charAt(t[r>>2]>>8*(3-r%4)+4&15)+e.charAt(t[r>>2]>>8*(3-r%4)&15);return n})(((t,u)=>{const l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],p=new Array(64);let d,h,g,m,v,y,b,E,_,S,T,O;for(t[u>>5]|=128<<24-u%32,t[15+(u+64>>9<<4)]=u,_=0;_<t.length;_+=16){for(d=f[0],h=f[1],g=f[2],m=f[3],v=f[4],y=f[5],b=f[6],E=f[7],S=0;S<64;S++)p[S]=S<16?t[S+_]:e(e(e((w=p[S-2],n(w,17)^n(w,19)^r(w,10)),p[S-7]),c(p[S-15])),p[S-16]),T=e(e(e(e(E,s(v)),i(v,y,b)),l[S]),p[S]),O=e(a(d),o(d,h,g)),E=b,b=y,y=v,v=e(m,T),m=g,g=h,h=d,d=e(T,O);f[0]=e(d,f[0]),f[1]=e(h,f[1]),f[2]=e(g,f[2]),f[3]=e(m,f[3]),f[4]=e(v,f[4]),f[5]=e(y,f[5]),f[6]=e(b,f[6]),f[7]=e(E,f[7])}var w;return f})((t=>{const e=[];for(let n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e})(t=(t=>{t=t.replace(/\r\n/g,"\n");let e="";for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e})(t)),8*t.length))}}},function(t,e,n){"use strict";t.exports=class{constructor({mockData:t}){this._mockData=t}get ready(){return Promise.resolve()}getCohortAllocations({experiments:t}){const{cohorts:e}=this._mockData;return Object.entries(e).reduce((e,[n,r])=>{if(t.includes(n)){const{data:t,cohortId:i}=r;e[n]={data:t,cohortId:i}}return e},{})}getExperimentsById(t){const{cohorts:e}=this._mockData;return Object.keys(e).reduce((e,n)=>(t.includes(n)&&Object.assign(e,this._getExperimentById(n)),e),{})}getExperiments(){const{cohorts:t}=this._mockData;return Object.keys(t).reduce((t,e)=>Object.assign(t,this._getExperimentById(e)),{})}_getExperimentById(t){const{cohorts:e}=this._mockData,n=e[t].cohortId,r=e[t].data||{};return{[t]:{experimentId:t,subjectIdType:e[t].subjectType,killed:!1,cohorts:[n],cohortData:{[n]:r},labels:r.labels||[]}}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initHivemind=d,e.getClient=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.readyTimeout,n=t.mockData,r=t.usePreload,a=t.Client,c=void 0===a?s.default:a,u=t.initClient,l=void 0===u?d:u,f=window,p=f.ux,h=(p=void 0===p?{}:p).data,g=(h=void 0===h?{}:h).app,m=void 0===g?"default":g,v=h.env,y=void 0===v?"dev":v;(0,i.updateAuthTokens)();var b=(0,i.getShopperId)(),E=(0,o.getVisitorId)(),_={Client:c,app:m,env:y,shopperId:b,visitorGuid:E,readyTimeout:e,mockData:n,usePreload:r};return E?l(_):new Promise((function(t){window._expDataLayer.push({schema:"get_tracking_values",version:"v1",data:{callback:function(e){var n=e.vtg;_.visitorGuid=n,t(l(_))}}})}))},e.browserSdkKeys=void 0;var r,i=n(32),o=n(36),a=n(8),s=(r=n(16))&&r.__esModule?r:{default:r};function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={},p={dev:"mbqv2tai7f3k04c7rm4dnombdfuvvddtmgku",test:"k0kgs7d57kss5jbkfsdto70ierl2tgvivl0v",prod:"pbqj1rfhsn00ukm2lv96jcg4rmbktkrdsmm0"};function d(t){var e=t.Client,n=t.app,r=t.env,i=t.shopperId,o=t.visitorGuid,s=t.readyTimeout,c=t.mockData,d=t.usePreload,h="".concat(n).concat(r).concat(i).concat(o).concat(s).concat(!!c).concat(d);return f[h]||(f[h]=new e({app:n.replace(/\./g,"-"),splitioOptions:{core:{authorizationKey:p[r]}},subject:u(u({},i&&l({},a.hivemindConstants.idTypes.SHOPPER_ID,i)),o&&l({},a.hivemindConstants.idTypes.VISITOR_GUID,o)),preloadLocation:"__hivemindPreload",readyTimeout:s,mockData:c,usePreload:d})),f[h].ready.then((function(){return f[h]}))}e.browserSdkKeys=p},function(t,e,n){"use strict";e.__esModule=!0,e._cryptOrUndefined=e._getDelegationClaims=e._getInfoTokenClaim=e._getInfoTokenClaims=e.getUserId=e.updateAuthTokens=e.isEmployee=e.isDelegated=e.isAuthenticated=e.getShopperId=e.getUserRealm=e.getCustomerId=e.getFederationPartnerId=e.getEmployeeId=e.getDelegateEmployeeId=e.getDelegateCustomerId=e.getClaimFromInfoToken=void 0;var r=n(15),i=n(35),o={},a=["idp","jomax"],s={idp:"info_shopperId",jomax:"info_accountName"},c=function(t){return Object.keys(t).length<1},u=function(t){var e={},n="info_"+t,i=(0,r.findCookie)(n);if(i)try{e=JSON.parse(i)}catch(t){}return e},l=function(){return!c(o)},f=function t(e){return"del"in e?t(e.del):e},p=function(t,e){return t?e?(0,i.sha256)(e):void 0:e},d=function(t,e){if(l()&&"basic"!==o.auth){var n=f(o);return p(e,n[t])}},h=function(t){return d(s.jomax,t)},g=function t(e,n,r){var i=e.typ;if(void 0===r||!i||i===r){var o=void 0,a=e.auth;if(a&&"basic"!==a)o=t(e[a],n,r);else o=e[n];return o}};e.getClaimFromInfoToken=function(t){if(l())return g(o,t)},e.getDelegateCustomerId=function(t){return d("info_cid",t)},e.getDelegateEmployeeId=h,e.getEmployeeId=function(t){if(l()){var e=o.typ,n=o.auth,r=s.jomax;if(e&&"jomax"===e)return p(t,o[r]);if(n&&"basic"!==n&&"e"===n.charAt(0))return h(t);var i=u("jomax");if(!c(i))return p(t,i[r])}},e.getFederationPartnerId=function(){if(l()){var t=g(o,"fpid");if(!t){var e=o.typ;void 0!==e&&(t=(0,r.findCookie)("brand_"+e))}return t}},e.getCustomerId=function(t){if(l())return p(t,g(o,"info_cid"))},e.getUserRealm=function(){if(l())return o.typ},e.getShopperId=function(t){if(l()&&"idp"===o.typ)return p(t,g(o,"info_shopperId"))},e.isAuthenticated=l,e.isDelegated=function(){if(!l())return!1;var t=o.auth;return t&&"basic"!==t},e.isEmployee=function(){if(!l())return!1;var t=o.typ,e=o.auth;if(t&&"jomax"===t)return!0;if(e&&"basic"!==e&&"e"===e.charAt(0))return!0;var n=u("jomax");return!c(n)},e.updateAuthTokens=function(){for(var t={},e=0;e<a.length;e++){var n=u(a[e]);!c(n)&&(c(t)||t.iat<n.iat)&&(t=n)}o=t},e.getUserId=function(t){if(l()){var e=o.typ;return p(t,g(o,s[e]))}},e._getInfoTokenClaims=u,e._getInfoTokenClaim=g,e._getDelegationClaims=f,e._cryptOrUndefined=p},function(t,e,n){"use strict";e.__esModule=!0;var r,i=n(34);var o=new((r=i)&&r.__esModule?r:{default:r}).default;e.default=o},function(t,e,n){"use strict";e.__esModule=!0;var r=n(14);var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.properties=e||{}}return t.prototype.clear=function(){this.properties={}},t.prototype.get=function(t){if(this.properties.hasOwnProperty(t))return this.properties[t]},t.prototype.set=function(t,e){this.properties[t]=e},t.prototype.isSet=function(t){if(this.properties.hasOwnProperty(t))return!0},t.prototype.delete=function(t){delete this.properties[t]},t.prototype.getProperties=function(t){var e={},n=function(){return!1};return t||"function"!=typeof t||(n=t),(0,r.map)(this.properties,(function(t,r){n(t)||(e[t]=r)})),e},t.prototype.merge=function(e){var n=this,i=e;i instanceof t&&(i=e.getProperties()),(0,r.map)(i,(function(t,e){n.set(t,e)}))},t}();e.default=i},function(t,e,n){"use strict";e.__esModule=!0;e.sha256=function(t){var e=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},n=function(t,e){return t>>>e|t<<32-e},r=function(t,e){return t>>>e},i=function(t,e,n){return t&e^~t&n},o=function(t,e,n){return t&e^t&n^e&n},a=function(t){return n(t,2)^n(t,13)^n(t,22)},s=function(t){return n(t,6)^n(t,11)^n(t,25)},c=function(t){return n(t,7)^n(t,18)^r(t,3)};return function(t){for(var e="0123456789abcdef",n="",r=0;r<4*t.length;r++)n+=e.charAt(t[r>>2]>>8*(3-r%4)+4&15)+e.charAt(t[r>>2]>>8*(3-r%4)&15);return n}(function(t,u){var l,f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],d=new Array(64),h=void 0,g=void 0,m=void 0,v=void 0,y=void 0,b=void 0,E=void 0,_=void 0,S=void 0,T=void 0,O=void 0,w=void 0;for(t[u>>5]|=128<<24-u%32,t[15+(u+64>>9<<4)]=u,S=0;S<t.length;S+=16){for(h=p[0],g=p[1],m=p[2],v=p[3],y=p[4],b=p[5],E=p[6],_=p[7],T=0;T<64;T++)d[T]=T<16?t[T+S]:e(e(e((l=d[T-2],n(l,17)^n(l,19)^r(l,10)),d[T-7]),c(d[T-15])),d[T-16]),O=e(e(e(e(_,s(y)),i(y,b,E)),f[T]),d[T]),w=e(a(h),o(h,g,m)),_=E,E=b,b=y,y=e(v,O),v=m,m=g,g=h,h=e(O,w);p[0]=e(h,p[0]),p[1]=e(g,p[1]),p[2]=e(m,p[2]),p[3]=e(v,p[3]),p[4]=e(y,p[4]),p[5]=e(b,p[5]),p[6]=e(E,p[6]),p[7]=e(_,p[7])}return p}(function(t){for(var e=[],n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(t)),8*t.length))}},function(t,e,n){"use strict";e.__esModule=!0,e.getVisitorId=void 0;var r=n(15),i=n(37);e.getVisitorId=function(){var t=function(){var t=(0,r.getCookieValues)("visitor");if(t)return t.vid}();return t||(0,i.debug)("A user identifier was unable to be retrived"),t}},function(t,e,n){"use strict";e.__esModule=!0,e._errorInit=e._logInit=e.error=e.info=e.debug=e.log=void 0;var r=n(38),i=n(13),o=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=(0,i.getWindow)().console;return!(0,r.isProduction)()&&o&&o.log?Function.prototype.bind?Function.prototype.bind.call(o.log,o):function(){Function.prototype.apply.call(o.log,o,e)}:function(){}},a=o(),s=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=(0,i.getWindow)().console;return!(0,r.isProduction)()&&o&&o.error?Function.prototype.bind?Function.prototype.bind.call(o.error,o):function(){Function.prototype.apply.call(o.error,o,e)}:function(){}},c=s();e.log=a,e.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];(0,r.isDebug)()&&a.apply(null,e)},e.info=a,e.error=c,e._logInit=o,e._errorInit=s},function(t,e,n){"use strict";e.__esModule=!0,e.getEnvName=e.setDebug=e.isTest=e.isProduction=e.isDevelopment=e.isDebug=void 0;var r=n(13),i=n(39),o=function(t){var e=(0,r.getBaseHost)(t);return!e||(0,i.startsWith)(e,"dev-")||(0,i.startsWith)(e,"localhost")},a=function(t){var e=(0,r.getBaseHost)(t);return(0,i.startsWith)(e,"test-")||(0,i.startsWith)(e,"stg-")},s=function(){return!o()&&!a()},c=!1;e.isDebug=function(){return c},e.isDevelopment=o,e.isProduction=s,e.isTest=a,e.setDebug=function(t){c=!0===t||"true"===t},e.getEnvName=function(){return a()?"test":s()?"prod":"dev"}},function(t,e,n){"use strict";e.__esModule=!0;e.endsWith=function(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e},e.pad=function(t,e){if(void 0===t)return t;void 0===e&&(e=2);for(var n=String(t);n.length<e;)n="0"+n;return n},e.stringifyArray=function(t,e,n){for(var r="",i=0;i<(t.length<e?t.length:e);i++)r+=n(t[i])+"^";return r.substring(0,r.length-1)},e.startsWith=function(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.app,n=t.idType,r=t.id,a=t.preloadLocation,s=void 0===a?"__splitCachePreload":a,c=t.windowOverride,u=void 0===c?window:c,l=t.loadData;return(l===void 0?i["default"]:l)({serializedData:u[s],userId:(0,o.getSubjectKey)({idType:n,id:r}),storagePrefix:"".concat(e,".").concat(n)}),!!u[s]};var r,i=(r=n(41))&&r.__esModule?r:{default:r},o=n(8)},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=((r=n(42))&&r.__esModule?r:{default:r}).default;e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=t.serializedData,n=void 0===e?{}:e,i=t.userId,o=void 0===i?"":i,a=t.storagePrefix,s=void 0===a?"":a,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.localStorage,u=s?"".concat(s,".").concat("SPLITIO"):"SPLITIO",l="".concat(u,".splits.till");if(0===Object.keys(n).length)return;var f=n.segmentsData,p=void 0===f?{}:f,d=n.since,h=void 0===d?0:d,g=n.splitsData,m=void 0===g?{}:g,v=n.usingSegmentsCount,y=void 0===v?0:v;if(h<=c.getItem(l))return;r({windowLocalStorage:c,localStoragePrefix:u});try{c.setItem(l,h),Object.keys(m).forEach((function(t){c.setItem("".concat(u,".split.").concat(t),m[t])})),c.setItem("".concat(u,".splits.usingSegments"),y),Object.keys(p).forEach((function(t){var e="".concat(o,".").concat(u,".segment.").concat(t);JSON.parse(p[t]).added.includes(o)&&"1"!==c.getItem(e)&&c.setItem(e,"1")}))}catch(t){console.error("Error setting localstorage",t),r({windowLocalStorage:c,localStoragePrefix:u})}},e.cleanLocalStorage=r;function r(t){var e=t.windowLocalStorage,n=void 0===e?window.localStorage:e,r=t.localStoragePrefix;Object.keys(n).forEach((function(t){t.includes(r)&&n.removeItem(t)}))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(46),i=n(8);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){var n,o=this,a=e.splitioOptions,s=e.app,c=e.id,u=e.idType,l=e.splitioClient,f=e.splitioManager,p=e.preloadExists,d=e.usePreload,h=void 0===d||d,g=e.windowOverride,m=void 0===g?window:g;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a.core.key=(0,i.getSubjectKey)({id:c,idType:u}),a.storage={type:h?"LOCALSTORAGE":"MEMORY",prefix:"".concat(s,".").concat(u)},a.streamingEnabled=!1,l&&f||(n=(0,r.SplitFactory)(a)),l||(l=n.client()),f||(f=n.manager()),this._splitioClient=l,this._splitioManager=f,this._clientReady=new Promise((function(t){return o._splitioClient.on(p?o._splitioClient.Event.SDK_READY_FROM_CACHE:o._splitioClient.Event.SDK_READY,t)})),this._managerReady=new Promise((function(t){return o._splitioManager.on(p?o._splitioManager.Event.SDK_READY_FROM_CACHE:o._splitioManager.Event.SDK_READY,t)})),this._allReady=Promise.all([this._clientReady,this._managerReady]),h||this._clearLocalStorage({app:s,idType:u,windowOverride:m})}var e,n,a;return e=t,(n=[{key:"_clearLocalStorage",value:function(t){var e=this,n=t.app,r=t.idType,i=t.windowOverride;this._splitioManager.on(this._splitioManager.Event.SDK_READY,(function(){e._splitioManager.splits().forEach((function(t){return i.localStorage.removeItem("".concat(n,".").concat(r,".SPLITIO.split.").concat(t.name))})),i.localStorage.removeItem("".concat(n,".").concat(r,".SPLITIO.splits.lastUpdated")),i.localStorage.removeItem("".concat(n,".").concat(r,".SPLITIO.splits.till")),i.localStorage.removeItem("".concat(n,".").concat(r,".SPLITIO.splits.usingSegments"))}))}},{key:"getCohortAllocations",value:function(t){var e=t.experiments,n=void 0===e?[]:e,r=t.attributes,o=void 0===r?{}:r,a=this._splitioClient.getTreatmentsWithConfig(n,o);return(0,i.treatmentsToCohortAllocations)(a)}},{key:"getExperimentsById",value:function(t){var e=this,n=t.map((function(t){return e._splitioManager.split(t)}));return t.reduce((function(t,e,r){var o=n[r];return null!==o&&(t[e]=(0,i.transformSplitToExperiment)(o)),t}),{})}},{key:"getExperiments",value:function(){return this._splitioManager.splits().reduce((function(t,e){return t[e.name]=(0,i.transformSplitToExperiment)(e),t}),{})}},{key:"destroy",value:function(){var t=this;return this._splitioClient.destroy().then((function(){delete t._splitioClient}))}},{key:"ready",get:function(){return this._allReady}}])&&o(e.prototype,n),a&&o(e,a),t}();e.default=a},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var c,u=[],l=!1,f=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):f=-1,u.length&&d())}function d(){if(!l){var t=s(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||l||s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var r,i;
/**
 * @license utfx (c) 2014 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/utfx for details
 */void 0===(i="function"==typeof(r=function(){"use strict";Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var t={MAX_CODEPOINT:1114111,encodeUTF8:function(t,e){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?e(127&n):n<2048?(e(n>>6&31|192),e(63&n|128)):n<65536?(e(n>>12&15|224),e(n>>6&63|128),e(63&n|128)):(e(n>>18&7|240),e(n>>12&63|128),e(n>>6&63|128),e(63&n|128)),n=null},decodeUTF8:function(t,e){for(var n,r,i,o,a=function(t){t=t.slice(0,t.indexOf(null));var e=Error(t.toString());throw e.name="TruncatedError",e.bytes=t,e};null!==(n=t());)if(0==(128&n))e(n);else if(192==(224&n))null===(r=t())&&a([n,r]),e((31&n)<<6|63&r);else if(224==(240&n))(null===(r=t())||null===(i=t()))&&a([n,r,i]),e((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=t())||null===(i=t())||null===(o=t()))&&a([n,r,i,o]),e((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(t,e){for(var n,r=null;null!==(n=null!==r?r:t());)n>=55296&&n<=57343&&null!==(r=t())&&r>=56320&&r<=57343?(e(1024*(n-55296)+r-56320+65536),r=null):e(n);null!==r&&e(r)},UTF8toUTF16:function(t,e){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?e(n):(e(55296+((n-=65536)>>10)),e(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,n){t.UTF16toUTF8(e,(function(e){t.encodeUTF8(e,n)}))},decodeUTF8toUTF16:function(e,n){t.decodeUTF8(e,(function(e){t.UTF8toUTF16(e,n)}))},calculateCodePoint:function(t){return t<128?1:t<2048?2:t<65536?3:4},calculateUTF8:function(t){for(var e,n=0;null!==(e=t());)n+=e<128?1:e<2048?2:e<65536?3:4;return n},calculateUTF16asUTF8:function(e){var n=0,r=0;return t.UTF16toUTF8(e,(function(t){++n,r+=t<128?1:t<2048?2:t<65536?3:4})),[n,r]}},e=String.fromCharCode;return t.arraySource=function(t){if(!Array.isArray(t))throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t[e++]}},t.arrayDestination=function(t){if(!Array.isArray(t))throw TypeError("Illegal argument: "+typeof t);return Array.prototype.push.bind(t)},t.stringSource=function(t){if("string"!=typeof t)throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t.charCodeAt(e++)}},t.stringDestination=function(){var t=[],n=[];return function(){if(0===arguments.length)return n.join("")+e.apply(String,t);t.length+arguments.length>1024&&(n.push(e.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}},t.assertCharCode=function(t){if("number"!=typeof t||t!=t)throw TypeError("Illegal char code: "+typeof t);if(t<0||t>65535)throw RangeError("Illegal char code: "+t);return t},t.assertCodePoint=function(e){if("number"!=typeof e||e!=e)throw TypeError("Illegal code point: "+typeof e);if(e<0||e>t.MAX_CODEPOINT)throw RangeError("Illegal code point: "+e);return e},t.fromCodePoint=function(e){var n,r=0,i=arguments,o=i.length;return t.UTF8toUTF16((function(){return r<o?t.assertCodePoint(i[r++]):null}),n=t.stringDestination()),n()},t.codePointAt=function(e,n){if("string"!=typeof e&&!(e&&e instanceof String)||"number"!=typeof n)throw TypeError("Illegal arguments: "+typeof e+", "+typeof n);var r,i;if(!(n<0||n>=(r=e.length)))return t.UTF16toUTF8((function(){return void 0===i&&n<r?e.charCodeAt(n++):null}),(function(t){i=t})),i},t.polyfill=function(e){return String.fromCodePoint&&!e||(String.fromCodePoint=t.fromCodePoint),String.prototype.codePointAt&&!e||(String.prototype.codePointAt=function(e){return t.codePointAt(this,e)}),t},t})?r.call(e,n,e,t):r)||(t.exports=i)},function(t,e,n){"use strict";n.r(e),n.d(e,"SplitFactory",(function(){return To}));var r=n(4),i=n.n(r),o=function(t){return null!=t&&"function"==typeof t.then},a=n(0),s=n(1),c=Object(s.b)("",{displayAllErrors:!0}),u={};function l(t){u[t]&&u[t]--,0===u[t]&&delete u[t]}var f=Object(s.b)("");var p=Object(s.b)(""),d=/^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/;function h(t,e){if(null==t)p.error("".concat(e,": you passed a null or undefined event_type, event_type must be a non-empty string."));else if(Object(a.j)(t))if(0===t.length)p.error("".concat(e,": you passed an empty event_type, event_type must be a non-empty string."));else{if(d.test(t))return t;p.error("".concat(e,': you passed "').concat(t,'", event_type must adhere to the regular expression /^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/g. This means an event_type must be alphanumeric, cannot be more than 80 characters long, and can only include a dash, underscore, period, or colon as separators of alphanumeric characters.'))}else p.error("".concat(e,": you passed an invalid event_type, event_type must be a non-empty string."));return!1}var g=Object(s.b)("");function m(t,e){return Object(a.l)(t)||null==t?t:(g.error("".concat(e,": value must be a finite number.")),!1)}var v=Object(s.b)(""),y=0,b=2,E=4,_=8;function S(t,e){if(null==t)return{properties:null,size:1024};if(!Object(a.i)(t))return v.error("".concat(e,": properties must be a plain object.")),{properties:!1,size:1024};var n=Object.keys(t),r=Object(a.n)(t),i={properties:r,size:1024};n.length>300&&v.warn("".concat(e,": Event has more than 300 properties. Some of them will be trimmed when processed."));for(var o=0;o<n.length;o++){i.size+=n[o].length*b;var s=r[n[o]],c=Object(a.j)(s),u=Object(a.l)(s),l=Object(a.h)(s),f=null===s;if(c||u||l||f||(r[n[o]]=null,s=null,f=!0,v.warn("".concat(e,": Property ").concat(n[o]," is of invalid type. Setting value to null."))),f?i.size+=y:u?i.size+=_:l?i.size+=E:c&&(i.size+=s.length*b),i.size>32768){v.error("".concat(e,": The maximum size allowed for the properties is 32768 bytes, which was exceeded. Event not queued.")),i.properties=!1;break}}return i}var T=Object(s.b)("");function O(t,e,n){if(null==t)return T.error("".concat(e,": you passed a null or undefined ").concat(n,", ").concat(n," must be a non-empty string.")),!1;if(Object(a.l)(t))return T.warn("".concat(e,": ").concat(n,' "').concat(t,'" is not of type string, converting.')),Object(a.q)(t);if(Object(a.j)(t)){if((t=t.trim()).length>0&&t.length<=250)return t;0===t.length?T.error("".concat(e,": you passed an empty string, ").concat(n," must be a non-empty string.")):t.length>250&&T.error("".concat(e,": ").concat(n," too long, ").concat(n," must be 250 characters or less."))}else T.error("".concat(e,": you passed an invalid ").concat(n," type, ").concat(n," must be a non-empty string."));return!1}function w(t,e){if(Object(a.i)(t)){var n=O(t.matchingKey,e,"matchingKey"),r=O(t.bucketingKey,e,"bucketingKey");return n&&r?{matchingKey:n,bucketingKey:r}:(T.error("".concat(e,": Key must be an object with bucketingKey and matchingKey with valid string properties.")),!1)}return O(t,e,"key")}var k=Object(s.b)(""),N=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function I(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"split name";if(null==t)k.error("".concat(e,": you passed a null or undefined ").concat(n,", ").concat(n," must be a non-empty string."));else if(Object(a.j)(t)){if(N.test(t)&&(k.warn("".concat(e,": ").concat(n,' "').concat(t,'" has extra whitespace, trimming.')),t=t.trim()),t.length>0)return t;k.error("".concat(e,": you passed an empty ").concat(n,", ").concat(n," must be a non-empty string."))}else k.error("".concat(e,": you passed an invalid ").concat(n,", ").concat(n," must be a non-empty string."));return!1}function C(t,e,n,r){return!t.get(t.constants.READY,!0)||"definition not found"!==n&&null!=n||(k.warn("".concat(r,': you passed "').concat(e,'" that does not exist in this environment, please double check what Splits exist in the web console.')),!1)}var A=Object(s.b)("");function j(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"split_names",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"split name";if(Array.isArray(t)&&t.length>0){var i=[];if(t.forEach((function(t){var n=I(t,e,r);n&&i.push(n)})),i.length)return Object(a.s)(i)}return A.error("".concat(e,": ").concat(n," must be a non-empty array.")),!1}var x="standalone",R="producer",D="consumer",M="control",L={treatment:M,config:null},P=[{type:"byName",maxLength:400,queryParam:"names="},{type:"byPrefix",maxLength:50,queryParam:"prefixes="}],U="DEBUG",F="OPTIMIZED",G=Object(s.b)(""),K=/[A-Z]/;function B(t,e){if(null==t)G.error("".concat(e,": you passed a null or undefined traffic_type_name, traffic_type_name must be a non-empty string."));else if(Object(a.j)(t)){if(0!==t.length)return K.test(t)&&(G.warn("".concat(e,": traffic_type_name should be all lowercase - converting string to lowercase.")),t=t.toLowerCase()),t;G.error("".concat(e,": you passed an empty traffic_type_name, traffic_type_name must be a non-empty string."))}else G.error("".concat(e,": you passed an invalid traffic_type_name, traffic_type_name must be a non-empty string."));return!1}function H(t,e){G.warn("".concat(t,": Traffic Type ").concat(e," does not have any corresponding Splits in this environment, make sure you're tracking your events to a valid traffic type defined in the Split console."))}function W(t,e,n){var r=e.get(e.constants.READY,!0),i=e.get(e.constants.SETTINGS),a=e.get(e.constants.STORAGE).splits;if(!r||"localhost"===i.mode)return!0;var s=a.trafficTypeExists(t);return o(s)?s.then((function(e){return e||H(n,t),e})):s||H(n,t),s}var z=Object(s.b)("",{displayAllErrors:!0});function Y(t){return!t.get(t.constants.DESTROYED,!0)||(z.error("Client has already been destroyed - no calls possible."),!1)}function V(t,e){return!(!t.get(t.constants.READY,!0)&&!t.get(t.constants.READY_FROM_CACHE,!0))||(z.warn("".concat(e,": the SDK is not ready, results may be incorrect. Make sure to wait for SDK readiness before using this method.")),!1)}var q=function(t){var e=t.conditions,n=Object(a.b)(e,(function(t){return"ROLLOUT"===t.conditionType}));return n||(n=e[0]),n?n.partitions.map((function(t){return t.treatment})):[]},Q=function(t){var e;try{e=JSON.parse(t)}catch(t){return null}return null==e?null:{name:e.name,trafficType:e.trafficTypeName||null,killed:e.killed,changeNumber:e.changeNumber||0,treatments:q(e),configs:e.configurations||{}}},J=function(t){var e=[];return t.forEach((function(t){var n=Q(t);null!=n&&e.push(n)})),e};var Z=function(t,e){var n=e.get(e.constants.STATUS_MANAGER);return i()(Object.create(n),{split:function(n){var r=I(n,"split");if(!Y(e)||!V(e,"split")||!r)return null;var i=t.getSplit(r);return o(i)?i.then((function(t){return C(e,r,t,"split"),Q(t)})):(C(e,r,i,"split"),Q(i))},splits:function(){if(!Y(e)||!V(e,"splits"))return[];var n=t.getAll();return o(n)?n.then(J):J(n)},names:function(){return Y(e)&&V(e,"names")?t.getKeys():[]}})},$=n(2),X=n(3);var tt=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0;e<t.length;e++)for(var n=t[e].matcherGroup.matchers,r=0;r<n.length;r++)if("IN_SEGMENT"===n[r].matcherType)return!0;return!1};function et(t,e,n){var r=this,i=this.getSplit(t);return(o(i)?i:Promise.resolve(i)).then((function(i){if(i){var o=JSON.parse(i);if(!o.changeNumber||o.changeNumber<n){o.killed=!0,o.defaultTreatment=e,o.changeNumber=n;var a=JSON.stringify(o);return r.addSplit(t,a)}}return!1}))}var nt=function(){function t(){Object($.a)(this,t),this.flush()}return Object(X.a)(t,[{key:"addSplit",value:function(t,e){var n=this.getSplit(t);if(n){var r=JSON.parse(n);if(r.trafficTypeName){var i=r.trafficTypeName;this.ttCache[i]--,this.ttCache[i]||delete this.ttCache[i]}tt(r.conditions)&&this.splitsWithSegmentsCount--}var o=JSON.parse(e);if(o){this.splitCache[t]=e;var a=o.trafficTypeName;return a&&(this.ttCache[a]||(this.ttCache[a]=0),this.ttCache[a]++),tt(o.conditions)&&this.splitsWithSegmentsCount++,!0}return!1}},{key:"addSplits",value:function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n}},{key:"removeSplit",value:function(t){var e=this.getSplit(t);if(e){delete this.splitCache[t];var n=JSON.parse(e),r=n.trafficTypeName;return r&&(this.ttCache[r]--,this.ttCache[r]||delete this.ttCache[r]),tt(n.conditions)&&this.splitsWithSegmentsCount--,1}return 0}},{key:"removeSplits",value:function(t){var e=this;return t.forEach((function(t){return e.removeSplit(t)})),t.length}},{key:"getSplit",value:function(t){return this.splitCache[t]}},{key:"setChangeNumber",value:function(t){return this.changeNumber=t,!0}},{key:"getChangeNumber",value:function(){return this.changeNumber}},{key:"getAll",value:function(){var t=this;return this.getKeys().map((function(e){return t.splitCache[e]}))}},{key:"getKeys",value:function(){return Object.keys(this.splitCache)}},{key:"trafficTypeExists",value:function(t){return Object(a.l)(this.ttCache[t])&&this.ttCache[t]>0}},{key:"usesSegments",value:function(){return-1===this.getChangeNumber()||this.splitsWithSegmentsCount>0}},{key:"flush",value:function(){this.splitCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0}},{key:"fetchMany",value:function(t){var e=this,n={};return t.forEach((function(t){n[t]=e.splitCache[t]||null})),n}},{key:"checkCache",value:function(){return!1}}]),t}();nt.prototype.killLocally=et;var rt=nt,it=Object(s.b)("splitio-storage:localstorage"),ot=function(){function t(e,n,r){Object($.a)(this,t),this.keys=e,this.splitFiltersValidation=r,this.__checkExpiration(n),this.__checkFilterQuery()}return Object(X.a)(t,[{key:"decrementCount",value:function(t){var e=Object(a.p)(localStorage.getItem(t))-1;e>0?localStorage.setItem(t,e):localStorage.removeItem(t)}},{key:"decrementCounts",value:function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);this.decrementCount(e)}if(tt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();this.decrementCount(n)}}}catch(t){it.error(t)}}},{key:"incrementCounts",value:function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);localStorage.setItem(e,Object(a.p)(localStorage.getItem(e))+1)}if(tt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();localStorage.setItem(n,Object(a.p)(localStorage.getItem(n))+1)}}}catch(t){it.error(t)}}},{key:"addSplit",value:function(t,e){try{var n=this.keys.buildSplitKey(t),r=localStorage.getItem(n),i=r?JSON.parse(r):null;this.decrementCounts(i),localStorage.setItem(n,e);var o=e?JSON.parse(e):null;return this.incrementCounts(o),!0}catch(t){return it.error(t),!1}}},{key:"addSplits",value:function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n}},{key:"removeSplit",value:function(t){try{var e=this.getSplit(t);localStorage.removeItem(this.keys.buildSplitKey(t));var n=JSON.parse(e);return this.decrementCounts(n),1}catch(t){return it.error(t),0}}},{key:"removeSplits",value:function(t){for(var e=0,n=t.length,r=0;e<n;e++)r+=this.removeSplit(t[e]);return r}},{key:"getSplit",value:function(t){return localStorage.getItem(this.keys.buildSplitKey(t))}},{key:"setChangeNumber",value:function(t){if(this.cacheReadyButNeedsToFlush&&(this.flush(),this.cacheReadyButNeedsToFlush=!1),this.updateNewFilter){it.info("Split filter query was modified. Updating cache.");var e=this.keys.buildSplitsFilterQueryKey(),n=this.splitFiltersValidation.queryString;try{n?localStorage.setItem(e,n):localStorage.removeItem(e)}catch(t){it.error(t)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),t+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0,!0}catch(t){return it.error(t),!1}}},{key:"getChangeNumber",value:function(){var t=localStorage.getItem(this.keys.buildSplitsTillKey());return null!==t?(t=parseInt(t,10),Object(a.m)(t)?-1:t):-1}},{key:"getAll",value:function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n),i=r&&localStorage.getItem(r);null!=r&&this.keys.isSplitKey(r)&&i&&e.push(i),n++}return e}},{key:"getKeys",value:function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&e.push(this.keys.extractKey(r)),n++}return e}},{key:"trafficTypeExists",value:function(t){var e=Object(a.p)(localStorage.getItem(this.keys.buildTrafficTypeKey(t)));return Object(a.l)(e)&&e>0}},{key:"usesSegments",value:function(){if(!this.hasSync)return!0;var t=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()),e=null===t?0:Object(a.p)(t);return!Object(a.l)(e)||e>0}},{key:"flush",value:function(){it.info("Flushing Splits data from localStorage");for(var t=localStorage.length,e=[],n=0;n<t;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitCacheKey(r)&&e.push(r)}e.forEach((function(t){localStorage.removeItem(t)})),this.hasSync=!1}},{key:"fetchMany",value:function(t){var e=this,n={};return t.forEach((function(t){n[t]=localStorage.getItem(e.keys.buildSplitKey(t))})),n}},{key:"checkCache",value:function(){return this.getChangeNumber()>-1||this.cacheReadyButNeedsToFlush}},{key:"__checkExpiration",value:function(t){var e=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==e&&(e=parseInt(e,10),!Object(a.m)(e)&&e<t&&this.flush())}},{key:"__checkFilterQuery",value:function(){var t=this,e=this.splitFiltersValidation,n=e.queryString,r=e.groupedFilters,i=this.keys.buildSplitsFilterQueryKey();if(localStorage.getItem(i)!==n)try{this.updateNewFilter=!0,this.checkCache()&&(localStorage.setItem(this.keys.buildSplitsTillKey(),"-1"),this.getKeys().forEach((function(e){n&&(r.byName.indexOf(e)>-1||r.byPrefix.some((function(t){return e.startsWith(t+"__")})))?t.cacheReadyButNeedsToFlush=!0:t.removeSplit(e)})))}catch(t){it.error(t)}}}]),t}();ot.prototype.killLocally=et;var at=ot,st=function(){function t(e){Object($.a)(this,t),this.keys=e,this.flush()}return Object(X.a)(t,[{key:"flush",value:function(){this.segmentCache={}}},{key:"addToSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return this.segmentCache[e]=!0,!0}},{key:"removeFromSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return delete this.segmentCache[e],!0}},{key:"resetSegments",value:function(t){var e,n=this,r=!1,i=Object.keys(this.segmentCache);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)}));else{for(e=0;e<t.length&&this.isInSegment(t[e]);e++);e<t.length&&(r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)})))}return r}},{key:"isInSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return!0===this.segmentCache[e]}},{key:"setChangeNumber",value:function(){return!0}},{key:"getChangeNumber",value:function(){return-1}},{key:"registerSegment",value:function(){return!1}},{key:"registerSegments",value:function(){return!1}},{key:"getRegisteredSegments",value:function(){return[]}}]),t}(),ct=Object(s.b)("splitio-storage:localstorage"),ut=function(){function t(e){Object($.a)(this,t),this.keys=e}return Object(X.a)(t,[{key:"addToSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.setItem(e,"1"),!0}catch(t){return ct.error(t),!1}}},{key:"removeFromSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.removeItem(e),!0}catch(t){return ct.error(t),!1}}},{key:"resetSegments",value:function(t){var e,n=this,r=!1,i=Object.keys(localStorage).reduce((function(t,e){var r=n.keys.extractSegmentName(e);return r&&t.push(r),t}),[]);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)}));else{for(e=0;e<t.length&&-1!==i.indexOf(t[e]);e++);e<t.length&&(r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)})))}return r}},{key:"isInSegment",value:function(t){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(t))}},{key:"setChangeNumber",value:function(){return!0}},{key:"getChangeNumber",value:function(){return-1}},{key:"registerSegment",value:function(){return!1}},{key:"registerSegments",value:function(){return!1}},{key:"getRegisteredSegments",value:function(){return[]}},{key:"flush",value:function(){ct.info("Flushing MySegments data from localStorage"),this.resetSegments([])}}]),t}();function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ft(t){return function(t){if(Array.isArray(t))return lt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var pt=function(){function t(){Object($.a)(this,t),this.queue=[]}return Object(X.a)(t,[{key:"state",value:function(){return this.queue}},{key:"track",value:function(t){var e;return(e=this.queue).push.apply(e,ft(t)),this}},{key:"clear",value:function(){return this.queue.length=0,this}},{key:"toJSON",value:function(){return this.queue}},{key:"isEmpty",value:function(){return 0===this.queue.length}}]),t}();var dt=function(t,e){for(var n=0,r=t.length-1,i=Math.floor((r+n)/2),o=n,a=r;t[i]!==e&&n<r;)e<t[i]?r=i-1:e>t[i]&&(n=i+1),i=Math.floor((r+n)/2);return i<o?i=o:i>a&&(i=a),e<t[i]&&i>o?i-1:i}.bind(null,[1,1.5,2.25,3.38,5.06,7.59,11.39,17.09,25.63,38.44,57.67,86.5,129.75,194.62,291.93,437.89,656.84,985.26,1477.89,2216.84,3325.26,4987.89,7481.83]),ht=function(){function t(){Object($.a)(this,t),this.clear()}return Object(X.a)(t,[{key:"clear",value:function(){return this.counters={},this}},{key:"state",value:function(){return this.counters}},{key:"track",value:function(t,e){return void 0===this.counters[t]&&(this.counters[t]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.counters[t][dt(e)]++,this}},{key:"isEmpty",value:function(){return 0===Object.keys(this.counters).length}},{key:"toJSON",value:function(){return this.counters}}]),t}(),gt=function(){function t(){Object($.a)(this,t),this.clear()}return Object(X.a)(t,[{key:"clear",value:function(){return this.counters={},this}},{key:"state",value:function(){return this.counters}},{key:"track",value:function(t){return void 0===this.counters[t]?this.counters[t]=1:this.counters[t]++,this.counters[t]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.counters).length}},{key:"toJSON",value:function(){return this.counters}}]),t}(),mt=function(){function t(e){var n=this;Object($.a)(this,t);var r=e.get(e.constants.SETTINGS),i=e.get(e.constants.EVENTS);this.onFullQueue=!1,this.maxQueue=r.scheduler.eventsQueueSize,this.queue=[],this.queueByteSize=0,o(i)?i.then((function(t){n.onFullQueue=t.flushAndResetTimer,n._checkForFlush()})):"function"==typeof i.flushAndResetTimer&&(this.onFullQueue=i.flushAndResetTimer)}return Object(X.a)(t,[{key:"state",value:function(){return this.queue}},{key:"track",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.queueByteSize+=e,this.queue.push(t),this._checkForFlush(),!0}},{key:"clear",value:function(){return this.queue=[],this.queueByteSize=0,this}},{key:"toJSON",value:function(){return this.queue}},{key:"isEmpty",value:function(){return 0===this.queue.length}},{key:"_checkForFlush",value:function(){(this.queueByteSize>5242880||this.maxQueue>0&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()}}]),t}(),vt=/[^.]+$/,yt=/count\.([^/]+)$/,bt=/latency\.([^/]+)\.bucket\.([0-9]+)$/,Et=function(){function t(e){Object($.a)(this,t),this.settings=e}return Object(X.a)(t,[{key:"buildSplitKey",value:function(t){return"".concat(this.settings.storage.prefix,".split.").concat(t)}},{key:"buildTrafficTypeKey",value:function(t){return"".concat(this.settings.storage.prefix,".trafficType.").concat(t)}},{key:"buildSplitsTillKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.till")}},{key:"buildSplitsReady",value:function(){return"".concat(this.settings.storage.prefix,".splits.ready")}},{key:"isSplitKey",value:function(t){return Object(a.o)(t,"".concat(this.settings.storage.prefix,".split."))}},{key:"buildSegmentNameKey",value:function(t){return"".concat(this.settings.storage.prefix,".segment.").concat(t)}},{key:"buildSegmentTillKey",value:function(t){return"".concat(this.settings.storage.prefix,".segment.").concat(t,".till")}},{key:"buildRegisteredSegmentsKey",value:function(){return"".concat(this.settings.storage.prefix,".segments.registered")}},{key:"buildSegmentsReady",value:function(){return"".concat(this.settings.storage.prefix,".segments.ready")}},{key:"buildVersionablePrefix",value:function(){return"".concat(this.settings.storage.prefix,"/").concat(this.settings.version,"/").concat(this.settings.runtime.ip)}},{key:"buildImpressionsKey",value:function(){return"".concat(this.settings.storage.prefix,".impressions")}},{key:"buildEventsKey",value:function(){return"".concat(this.settings.storage.prefix,".events")}},{key:"buildLatencyKeyPrefix",value:function(){return"".concat(this.buildVersionablePrefix(),"/latency")}},{key:"buildLatencyKey",value:function(t,e){return"".concat(this.buildLatencyKeyPrefix(),".").concat(t,".bucket.").concat(e)}},{key:"buildCountKey",value:function(t){return"".concat(this.buildVersionablePrefix(),"/count.").concat(t)}},{key:"buildGaugeKey",value:function(t){return"".concat(this.buildVersionablePrefix(),"/gauge.").concat(t)}},{key:"searchPatternForCountKeys",value:function(){return"".concat(this.buildVersionablePrefix(),"/count.*")}},{key:"searchPatternForSplitKeys",value:function(){return"".concat(this.settings.storage.prefix,".split.*")}},{key:"searchPatternForLatency",value:function(){return"".concat(this.buildLatencyKeyPrefix(),".*")}},{key:"extractKey",value:function(t){var e=t.match(vt);if(e&&e.length)return e[0];throw"Invalid latency key provided"}},{key:"extractCounterName",value:function(t){var e=t.match(yt);if(e&&e.length)return e[1];throw"Invalid counter key provided"}},{key:"extractLatencyMetricNameAndBucket",value:function(t){var e=t.match(bt);if(e&&e.length>2)return{metricName:e[1],bucketNumber:e[2]};throw"Invalid counter key provided"}}]),t}();function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function St(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}var Tt=n(6);function Ot(t,e){return!e||"object"!==Object(Tt.a)(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kt(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return Object(a.i)(n)?n[t]:e?void 0:n}}var Nt=kt("matchingKey"),It=kt("bucketingKey",!0);function Ct(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wt(t);if(e){var i=wt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ot(this,n)}}var At=function(t){St(n,t);var e=Ct(n);function n(t){var r;return Object($.a)(this,n),(r=e.call(this,t)).regexSplitCacheKey=new RegExp("^".concat(r.settings.storage.prefix,"\\.(splits?|trafficType)\\.")),r}return Object(X.a)(n,[{key:"buildSegmentNameKey",value:function(t){return"".concat(Nt(this.settings.core.key),".").concat(this.settings.storage.prefix,".segment.").concat(t)}},{key:"extractSegmentName",value:function(t){var e="".concat(Nt(this.settings.core.key),".").concat(this.settings.storage.prefix,".segment.");if(Object(a.o)(t,e))return t.substr(e.length)}},{key:"buildSplitsWithSegmentCountKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.usingSegments")}},{key:"buildLastUpdatedKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.lastUpdated")}},{key:"isSplitCacheKey",value:function(t){return this.regexSplitCacheKey.test(t)}},{key:"buildSplitsFilterQueryKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.filterQuery")}}]),n}(Et),jt=function(t){var e=t.get(t.constants.SETTINGS);switch(e.storage.type){case"MEMORY":var n=new Et(e);return{splits:new rt,segments:new st(n),impressions:new pt,metrics:new ht,count:new gt,events:new mt(t),shared:function(t){var e=new Et(t);return{splits:this.splits,segments:new st(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new rt,this.segments.flush()}}},destroy:function(){this.splits.flush(),this.segments.flush(),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};case"LOCALSTORAGE":var r=new At(e),i=Date.now()-864e6;return{splits:new at(r,i,e.sync.__splitFiltersValidation),segments:new ut(r),impressions:new pt,metrics:new ht,count:new gt,events:new mt(t),shared:function(t){var e=new At(t);return{splits:this.splits,segments:new ut(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new rt,this.segments=new st(e)}}},destroy:function(){this.splits=new rt,this.segments=new st(new Et(e)),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};default:throw new Error("Unsupported storage type")}},xt=n(7),Rt=n.n(xt),Dt="init::timeout",Mt="init::ready",Lt="init::cache-ready",Pt="state::splits-arrived",Ut="state::segments-arrived",Ft="state::splits-cache-loaded",Gt="state::update",Kt="state::check";var Bt=function(){var t=0,e=new Rt.a;e.SDK_SPLITS_CACHE_LOADED=Ft,e.SDK_SPLITS_ARRIVED=Pt;var n=0;function r(e,n){var r=new Rt.a,i=0,o=0;return r.on(Kt,(function(){14!==o&&t+i===6?(o=14,r.emit(Mt)):14===o&&r.emit(Gt)})),e.on(Pt,(function(e){e||(t=2),r.emit(Kt)})),e.once(Ft,(function(){setTimeout((function(){return r.emit(Lt)}),0)})),n.on(Ut,(function(){i=4,r.emit(Kt)})),r}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=0,o=new Rt.a;o.SDK_SEGMENTS_ARRIVED=Ut;var a=r(e,o);return t>0&&(i=setTimeout((function(){a.emit(Dt,"Split SDK emitted SDK_READY_TIMED_OUT event.")}),t),a.once(Mt,(function(){return clearTimeout(i)}))),a.SDK_READY=Mt,a.SDK_READY_FROM_CACHE=Lt,a.SDK_UPDATE=Gt,a.SDK_READY_TIMED_OUT=Dt,n++,{splits:e,segments:o,gate:a,destroy:function(){o.removeAllListeners(),a.removeAllListeners(),clearTimeout(i),n>0&&n--,0===n&&e.removeAllListeners()}}}},Ht={startup:{requestTimeoutBeforeReady:5,retriesOnFailureBeforeReady:1,readyTimeout:10,eventsFirstPushWindow:10}},Wt=n(10),zt=Object(s.b)("splitio-settings"),Yt=function(t){var e=t.mode,n=t.storage,r=n.type,i=void 0===r?"MEMORY":r,o=n.options,a=void 0===o?{}:o,s=n.prefix;return s?s+=".SPLITIO":s="SPLITIO","localhost"===e?{type:"MEMORY",prefix:s}:(("MEMORY"!==i&&"LOCALSTORAGE"!==i||"LOCALSTORAGE"===i&&!Object(Wt.a)())&&(i="MEMORY",zt.warn("Invalid or unavailable storage. Fallbacking into MEMORY storage")),{type:i,options:a,prefix:s})},Vt=Object(s.b)("splitio-settings"),qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.integrations;if(!Array.isArray(n)||0===n.length)return[];var r=n.filter((function(t){return t&&Object(a.j)(t.type)&&e.indexOf(t.type)>-1})),i=n.length-r.length;return i&&Vt.warn("".concat(i," integration ").concat(1===i?"item":"items"," at settings ").concat(1===i?"is":"are"," invalid: integration items must have a valid 'type' value")),r},Qt=function(t){return qt(t,["GOOGLE_ANALYTICS_TO_SPLIT","SPLIT_TO_GOOGLE_ANALYTICS"])};var Jt=function(t,e){if("localhost"===t)return"localhost";if(-1===[x,R,D].indexOf(e))throw Error("Invalid mode provided");return e},Zt=Object(s.b)("");function $t(t,e){var n,r,i={validFilters:[],queryString:null,groupedFilters:{}};return t?e!==x?(Zt.warn("Factory instantiation: split filters have been configured but will have no effect if mode is not '".concat(x,"', since synchronization is being deferred to an external tool.")),i):Array.isArray(t)&&0!==t.length?(P.forEach((function(t){i.groupedFilters[t.type]=[]})),i.validFilters=t.filter((function(t,e){return t&&(n=t.type,P.some((function(t){return t.type===n})))&&Array.isArray(t.values)?(i.groupedFilters[t.type]=i.groupedFilters[t.type].concat(t.values),!0):(Zt.warn("Factory instantiation: split filter at position '".concat(e,"' is invalid. It must be an object with a valid filter type ('byName' or 'byPrefix') and a list of 'values'.")),!1);var n})),P.forEach((function(t){var e=t.type,n=t.maxLength;i.groupedFilters[e].length>0&&(i.groupedFilters[e]=function(t,e,n){var r=j(e,"Factory instantiation","".concat(t," filter"),"".concat(t," filter value"));if(r){if(r.length>n)throw new Error("".concat(n," unique values can be specified at most for '").concat(t,"' filter. You passed ").concat(r.length,". Please consider reducing the amount or using other filter."));r.sort()}return r||[]}(e,i.groupedFilters[e],n))})),i.queryString=(n=i.groupedFilters,r=[],P.forEach((function(t){var e=t.type,i=t.queryParam,o=n[e];o.length>0&&r.push(i+o.map((function(t){return encodeURIComponent(t)})).join(","))})),r.length>0?"&"+r.join("&"):null),Zt.debug("Factory instantiation: splits filtering criteria is '".concat(i.queryString,"'.")),i):(Zt.warn("Factory instantiation: splitFilters configuration must be a non-empty array of filter objects."),i):i}var Xt=n(17),te=Object(s.b)("splitio-settings");var ee=function(t){return t=t.toUpperCase(),-1===[U,F].indexOf(t)&&(te.error("You passed an invalid impressionsMode, impressionsMode should be one of the following values: '".concat(U,"' or '").concat(F,"'. Defaulting to '").concat(F,"' mode.")),t=F),t},ne=Xt.version,re=/^\/(testImpressions|metrics|events)/,ie=/^\/auth/,oe=/^\/(sse|event-stream)/,ae={mode:x,core:{authorizationKey:void 0,key:void 0,trafficType:void 0,labelsEnabled:!0,IPAddressesEnabled:void 0},scheduler:{featuresRefreshRate:30,segmentsRefreshRate:60,metricsRefreshRate:120,impressionsRefreshRate:60,offlineRefreshRate:15,eventsPushRate:60,eventsQueueSize:500,authRetryBackoffBase:1,streamingReconnectBackoffBase:1},urls:{sdk:"https://sdk.split.io/api",events:"https://events.split.io/api",auth:"https://auth.split.io/api",streaming:"https://streaming.split.io"},storage:{type:"MEMORY"},debug:void 0,impressionListener:void 0,version:"".concat("javascript","-").concat(ne),integrations:void 0,streamingEnabled:!0,sync:{splitFilters:void 0,impressionsMode:F}};function se(t){return Math.round(1e3*t)}function ce(t){var e,n=Object(a.k)({},ae,Ht,t);n.scheduler.featuresRefreshRate=se(n.scheduler.featuresRefreshRate),n.scheduler.segmentsRefreshRate=se(n.scheduler.segmentsRefreshRate),n.scheduler.metricsRefreshRate=se(n.scheduler.metricsRefreshRate),n.scheduler.impressionsRefreshRate=se(n.scheduler.impressionsRefreshRate),n.scheduler.offlineRefreshRate=se(n.scheduler.offlineRefreshRate),n.scheduler.eventsPushRate=se(n.scheduler.eventsPushRate),n.startup.requestTimeoutBeforeReady=se(n.startup.requestTimeoutBeforeReady),n.startup.readyTimeout=se(n.startup.readyTimeout),n.startup.eventsFirstPushWindow=se(n.startup.eventsFirstPushWindow),n.mode=Jt(n.core.authorizationKey,n.mode),n.storage=Yt(n),"boolean"==typeof(e=n.debug)?e?s.a.enable():s.a.disable():"string"==typeof e&&s.a.setLogLevel(e),n.runtime=(n.core.IPAddressesEnabled,n.mode,{ip:!1,hostname:!1}),n.integrations=Qt(n),!1!==n.streamingEnabled&&(n.streamingEnabled=!0,n.scheduler.authRetryBackoffBase=se(n.scheduler.authRetryBackoffBase),n.scheduler.streamingReconnectBackoffBase=se(n.scheduler.streamingReconnectBackoffBase));var r=$t(n.sync.splitFilters,n.mode);return n.sync.splitFilters=r.validFilters,n.sync.__splitFiltersValidation=r,n.sync.impressionsMode=ee(n.sync.impressionsMode),n}var ue={url:function(t){return re.test(t)?"".concat(this.urls.events).concat(t):ie.test(t)?"".concat(this.urls.auth).concat(t):oe.test(t)?"".concat(this.urls.streaming).concat(t):"".concat(this.urls.sdk).concat(t)},overrideKeyAndTT:function(t,e){return i()(Object.create(ue),this,{core:i()({},this.core,{key:t,trafficType:e})})}},le=function(t){return i()(Object.create(ue),ce(t))},fe={COLLECTORS:"metrics_collectors",DESTROYED:"is_destroyed",EVENTS:"events_publisher",HAS_TIMEDOUT:"has_timedout",INTEGRATIONS_MANAGER:"integrations_manager",MY_SEGMENTS_CHANGE_WORKER:"my_segments_change_worker",PRODUCER:"producer",READINESS:"readiness_gate",READY:"is_ready",READY_FROM_CACHE:"is_ready_from_cache",SETTINGS:"settings",STATUS_MANAGER:"status_manager",STORAGE:"storage",IMPRESSIONS_COUNTER:"impressions_counter"},pe=function(){function t(){Object($.a)(this,t),this._map={},this.constants=fe}return Object(X.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof t&&("string"!=typeof t||t.length)){var n=this._map[t];if(void 0!==n)return n;if(!e){var r,i=new Promise((function(t){return r=t}));return i.manualResolve=r,this._map[t]=i,i}}}},{key:"getAll",value:function(){return i()({},this._map)}},{key:"put",value:function(t,e){var n=this;if("string"!=typeof t||"string"==typeof t&&!t.length||void 0===e)return!1;var r=this._map[t];return(void 0===r||"function"==typeof r.manualResolve)&&(o(r)&&r.manualResolve&&r.manualResolve(e),o(e)&&e.then((function(e){return n._map[t]=e,e})).catch((function(e){return n._map[t]=void 0,e})),this._map[t]=e,!0)}}]),t}(),de=function(t){return Object(a.i)(t)?{matchingKey:t.matchingKey,bucketingKey:t.bucketingKey}:{matchingKey:t,bucketingKey:t}};function he(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ge=n(5);var me="object"===("undefined"==typeof performance?"undefined":Object(Tt.a)(performance))&&"function"==typeof performance.now?performance.now.bind(performance):Date.now;var ve,ye=function(){var t=me();return function(){return Math.round(me()-t)}},be=new ge.b("[TIME TRACKER]",{showLevel:!1}),Ee={},_e={SDK_READY:"Getting ready - Split SDK",SDK_GET_TREATMENT:"SDK - Get Treatment",SDK_GET_TREATMENTS:"SDK - Get Treatments",SDK_GET_TREATMENT_WITH_CONFIG:"SDK - Get Treatment with config",SDK_GET_TREATMENTS_WITH_CONFIG:"SDK - Get Treatments with config",SPLITS_READY:"Getting ready - Splits",SEGMENTS_READY:"Getting ready - Segments",METRICS_PUSH:"Pushing - Metrics",IMPRESSIONS_PUSH:"Pushing - Impressions",EVENTS_PUSH:"Pushing - Events",MY_SEGMENTS_FETCH:"Fetching - My Segments",SEGMENTS_FETCH:"Fetching - Segments",SPLITS_FETCH:"Fetching - Splits"},Se=(he(ve={},_e.SDK_READY,{collector:"client",method:"ready"}),he(ve,_e.SDK_GET_TREATMENT,{collector:"client",method:"getTreatment"}),he(ve,_e.SDK_GET_TREATMENTS,{collector:"client",method:"getTreatments"}),he(ve,_e.SDK_GET_TREATMENT_WITH_CONFIG,{collector:"client",method:"getTreatmentWithConfig"}),he(ve,_e.SDK_GET_TREATMENTS_WITH_CONFIG,{collector:"client",method:"getTreatmentsWithConfig"}),he(ve,_e.MY_SEGMENTS_FETCH,{collector:"mySegments",method:"latency"}),he(ve,_e.SEGMENTS_FETCH,{collector:"segmentChanges",method:"latency"}),he(ve,_e.SPLITS_FETCH,{collector:"splitChanges",method:"latency"}),ve),Te=function(t,e){return"string"==typeof e?t+e:t},Oe=function(t,e){var n=Se[t];return!(!n||!e)&&e[n.collector]},we=function(t,e){var n=Se[t];return!(!n||!e)&&e[n.method]},ke={__attachToPromise:function(t,e,n,r){var i=this;return t.then((function(t){return i.stop(e,r),n&&n.count&&n.count(t.status),t})).catch((function(t){throw i.stop(e,r),n&&n.countException&&n.countException(),t}))},start:function(t,e,n){var r,i=Object(a.t)(),s=Oe(t,e);o(n)?r=this.__attachToPromise(n,t,s,i):(r=this.stop.bind(this,t,i),Se[t]&&!s&&(r.setCollectorForTask=this.setCollectorForTask.bind(this,t,i)));var c=Te(t,i),u=we(t,s);return Ee[c]={cb:u,timer:ye()},r},setCollectorForTask:function(t,e,n){var r=Oe(t,n);if(r){var i=Te(t,e);Ee[i].cb=we(t,r)}},stop:function(t,e){var n=Te(t,e),r=Ee[n];if(r){var i=r.timer();return be.debug("[".concat(t,"] took ").concat(i,"ms to finish.")),r.cb&&r.cb(i),delete Ee[n],i}},TaskNames:_e},Ne={ALL:1,SEGMENT:2,WHITELIST:3,EQUAL_TO:4,GREATER_THAN_OR_EQUAL_TO:5,LESS_THAN_OR_EQUAL_TO:6,BETWEEN:7,UNDEFINED:8,EQUAL_TO_SET:9,CONTAINS_ANY_OF_SET:10,CONTAINS_ALL_OF_SET:11,PART_OF_SET:12,ENDS_WITH:13,STARTS_WITH:14,CONTAINS_STRING:15,IN_SPLIT_TREATMENT:16,EQUAL_TO_BOOLEAN:17,MATCHES_STRING:18},Ie={BOOLEAN:"BOOLEAN",STRING:"STRING",NUMBER:"NUMBER",SET:"SET",DATETIME:"DATETIME",NOT_SPECIFIED:"NOT_SPECIFIED"};var Ce=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.segmentName},Ae=function(){function t(){var e=this;Object($.a)(this,t),this.__setData__=[];var n=arguments[0];Array.isArray(n)&&n.forEach((function(t){e.add(t)}))}return Object(X.a)(t,[{key:"clear",value:function(){this.__setData__.length&&(this.__setData__.length=0)}},{key:"add",value:function(t){return this.has(t)||this.__setData__.push(t),this}},{key:"delete",value:function(t){var e=this.__setData__.indexOf(t);return-1!==e&&(this.__setData__.splice(e,1),!0)}},{key:"has",value:function(t){return-1!==this.__setData__.indexOf(t)}},{key:"forEach",value:function(t){var e=arguments[1];if("function"!=typeof t)throw new TypeError(t+" is not a function");for(var n=0;n<this.__setData__.length;n++){var r=this.__setData__[n];t.call(e,r,r,this)}}},{key:"size",get:function(){return this.__setData__.length}}]),t}();function je(t){return t instanceof Ae?t.__setData__.slice():Array.from(t)}var xe=Array.from&&"function"==typeof Set&&Set.prototype&&Set.prototype.values?Set:Ae;var Re=function(t){return new xe(t.whitelist)};var De=function(t){return t.whitelist};var Me=function(t){return t.value};function Le(t){return new Date(t).setUTCHours(0,0,0,0)}function Pe(t){return new Date(t).setUTCSeconds(0,0)}var Ue=function(t){var e=t.map((function(t){var e=t.matcherType,n=t.negate,r=t.keySelector,i=t.userDefinedSegmentMatcherData,o=t.whitelistMatcherData,a=t.unaryNumericMatcherData,s=t.betweenMatcherData,c=t.dependencyMatcherData,u=t.booleanMatcherData,l=t.stringMatcherData,f=r&&r.attribute,p=function(t){switch(t){case"ALL_KEYS":return Ne.ALL;case"IN_SEGMENT":return Ne.SEGMENT;case"WHITELIST":return Ne.WHITELIST;case"EQUAL_TO":return Ne.EQUAL_TO;case"GREATER_THAN_OR_EQUAL_TO":return Ne.GREATER_THAN_OR_EQUAL_TO;case"LESS_THAN_OR_EQUAL_TO":return Ne.LESS_THAN_OR_EQUAL_TO;case"BETWEEN":return Ne.BETWEEN;case"EQUAL_TO_SET":return Ne.EQUAL_TO_SET;case"CONTAINS_ANY_OF_SET":return Ne.CONTAINS_ANY_OF_SET;case"CONTAINS_ALL_OF_SET":return Ne.CONTAINS_ALL_OF_SET;case"PART_OF_SET":return Ne.PART_OF_SET;case"ENDS_WITH":return Ne.ENDS_WITH;case"STARTS_WITH":return Ne.STARTS_WITH;case"CONTAINS_STRING":return Ne.CONTAINS_STRING;case"IN_SPLIT_TREATMENT":return Ne.IN_SPLIT_TREATMENT;case"EQUAL_TO_BOOLEAN":return Ne.EQUAL_TO_BOOLEAN;case"MATCHES_STRING":return Ne.MATCHES_STRING;default:return Ne.UNDEFINED}}(e),d=Ie.STRING,h=void 0;return p===Ne.SEGMENT?h=Ce(i):p===Ne.WHITELIST?h=Re(o):p===Ne.EQUAL_TO?(h=Me(a),d=Ie.NUMBER,"DATETIME"===a.dataType&&(h=Le(h),d=Ie.DATETIME)):p===Ne.GREATER_THAN_OR_EQUAL_TO||p===Ne.LESS_THAN_OR_EQUAL_TO?(h=Me(a),d=Ie.NUMBER,"DATETIME"===a.dataType&&(h=Pe(h),d=Ie.DATETIME)):p===Ne.BETWEEN?(h=s,d=Ie.NUMBER,"DATETIME"===s.dataType&&(h.start=Pe(h.start),h.end=Pe(h.end),d=Ie.DATETIME)):p===Ne.EQUAL_TO_SET||p===Ne.CONTAINS_ANY_OF_SET||p===Ne.CONTAINS_ALL_OF_SET||p===Ne.PART_OF_SET?(h=De(o),d=Ie.SET):p===Ne.STARTS_WITH||p===Ne.ENDS_WITH||p===Ne.CONTAINS_STRING?h=De(o):p===Ne.IN_SPLIT_TREATMENT?(h=c,d=Ie.NOT_SPECIFIED):p===Ne.EQUAL_TO_BOOLEAN?(d=Ie.BOOLEAN,h=u):p===Ne.MATCHES_STRING&&(h=l),{attribute:f,negate:n,type:p,value:h,dataType:d}}));return-1===Object(a.c)(e,(function(t){return t.type===Ne.UNDEFINED}))?e:[]};function Fe(t,e){if(!(this instanceof Fe))return new Fe(t,e);if(100!==t[t.length-1])throw new RangeError("Provided invalid dataset as input");this._ranges=t,this._treatments=e}Fe.parse=function(t){var e=t.reduce((function(t,e){var n=e.size,r=e.treatment;return t.ranges.push(t.inc+=n),t.treatments.push(r),t}),{inc:0,ranges:[],treatments:[]});return new Fe(e.ranges,e.treatments)},Fe.prototype.getTreatmentFor=function(t){if(t<0||t>100)throw new RangeError("Please provide a value between 0 and 100");var e=Object(a.c)(this._ranges,(function(e){return t<=e}));return this._treatments[e]};var Ge=Fe,Ke=Object(s.b)("splitio-engine:matcher");function Be(t){return Ke.debug("[allMatcher] is always true"),null!=t}var He=function(){return Be},We=Object(s.b)("splitio-engine:matcher");var ze=function(t,e){return function(n){var r=e.segments.isInSegment(t,n);return o(r)?r.then((function(e){return We.debug("[asyncSegmentMatcher] evaluated ".concat(t," / ").concat(n," => ").concat(r)),e})):We.debug("[segmentMatcher] evaluated ".concat(t," / ").concat(n," => ").concat(r)),r}},Ye=Object(s.b)("splitio-engine:matcher");var Ve=function(t){return function(e){var n=t.has(e);return Ye.debug("[whitelistMatcher] evaluated ".concat(e," in [").concat(je(t).join(","),"] => ").concat(n)),n}},qe=Object(s.b)("splitio-engine:matcher");var Qe=function(t){return function(e){var n=e===t;return qe.debug("[equalToMatcher] is ".concat(e," equal to ").concat(t,"? ").concat(n)),n}},Je=Object(s.b)("splitio-engine:matcher");var Ze=function(t){return function(e){var n=e>=t;return Je.debug("[greaterThanEqualMatcher] is ".concat(e," greater than ").concat(t,"? ").concat(n)),n}},$e=Object(s.b)("splitio-engine:matcher");var Xe=function(t){return function(e){var n=e<=t;return $e.debug("[lessThanEqualMatcher] is ".concat(e," less than ").concat(t,"? ").concat(n)),n}},tn=Object(s.b)("splitio-engine:matcher");var en=function(t){return function(e){var n=e>=t.start&&e<=t.end;return tn.debug("[betweenMatcher] is ".concat(e," between ").concat(t.start," and ").concat(t.end,"? ").concat(n)),n}},nn=Object(s.b)("splitio-engine:matcher");var rn=function(t){return function(e){for(var n=e.length===t.length,r=function(r){Object(a.c)(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return nn.debug("[equalToSetMatcher] is ".concat(e," equal to set ").concat(t,"? ").concat(n)),n}},on=Object(s.b)("splitio-engine:matcher");var an=function(t){return function(e){var n=!0;if(e.length<t.length)n=!1;else for(var r=function(r){Object(a.c)(e,(function(e){return e===t[r]}))<0&&(n=!1)},i=0;i<t.length&&n;i++)r(i);return on.debug("[containsAllMatcher] ".concat(e," contains all elements of ").concat(t,"? ").concat(n)),n}},sn=Object(s.b)("splitio-engine:matcher");var cn=function(t){return function(e){for(var n=!1,r=function(r){Object(a.c)(e,(function(e){return e===t[r]}))>=0&&(n=!0)},i=0;i<t.length&&!n;i++)r(i);return sn.debug("[containsAnyMatcher] ".concat(e," contains at least an element of ").concat(t,"? ").concat(n)),n}},un=Object(s.b)("splitio-engine:matcher");var ln=function(t){return function(e){for(var n=e.length<=t.length,r=function(r){Object(a.c)(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return un.debug("[partOfMatcher] ".concat(e," is part of ").concat(t,"? ").concat(n)),n}},fn=Object(s.b)("splitio-engine:matcher");var pn=function(t){return function(e){var n=t.some((function(t){return Object(a.o)(e,t)}));return fn.debug("[startsWithMatcher] ".concat(e," starts with ").concat(t,"? ").concat(n)),n}},dn=Object(s.b)("splitio-engine:matcher");var hn=function(t){return function(e){var n=t.some((function(t){return Object(a.a)(e,t)}));return dn.debug("[endsWithMatcher] ".concat(e," ends with ").concat(t,"? ").concat(n)),n}},gn=Object(s.b)("splitio-engine:matcher");var mn=function(t){return function(e){var n=t.some((function(t){return Object(a.j)(e)&&e.indexOf(t)>-1}));return gn.debug("[containsStringMatcher] ".concat(e," contains ").concat(t,"? ").concat(n)),n}},vn=Object(s.b)("splitio-engine:matcher");function yn(t,e,n){var r=!1;return Array.isArray(e)&&(r=-1!==e.indexOf(t.treatment)),vn.debug('[dependencyMatcher] Parent split "'.concat(n,'" evaluated to "').concat(t.treatment,'" with label "').concat(t.label,'". ').concat(n," evaluated treatment is part of [").concat(e,"] ? ").concat(r,".")),r}var bn=function(t,e){var n=t.split,r=t.treatments;return function(t,i){var a=t.key,s=t.attributes;vn.debug('[dependencyMatcher] will evaluate parent split: "'.concat(n,'" with key: ').concat(JSON.stringify(a)," ").concat(s?"\n attributes: ".concat(JSON.stringify(s)):""));var c=i(a,n,s,e);return o(c)?c.then((function(t){return yn(t,r,n)})):yn(c,r,n)}},En=Object(s.b)("splitio-engine:matcher");var _n=function(t){return function(e){var n=t===e;return En.debug("[booleanMatcher] ".concat(t," === ").concat(e)),n}},Sn=Object(s.b)("splitio-engine:matcher");var Tn=function(t){return function(e){var n;try{n=new RegExp(t)}catch(e){return Sn.debug("[stringMatcher] ".concat(t," is an invalid regex")),!1}var r=n.test(e);return Sn.debug("[stringMatcher] does ".concat(e," matches with ").concat(t,"? ").concat(r?"yes":"no")),r}};var On=function(t,e){var n,r=t.type,i=t.value;return r===Ne.ALL?n=He(i):r===Ne.SEGMENT?n=ze(i,e):r===Ne.WHITELIST?n=Ve(i):r===Ne.EQUAL_TO?n=Qe(i):r===Ne.GREATER_THAN_OR_EQUAL_TO?n=Ze(i):r===Ne.LESS_THAN_OR_EQUAL_TO?n=Xe(i):r===Ne.BETWEEN?n=en(i):r===Ne.EQUAL_TO_SET?n=rn(i):r===Ne.CONTAINS_ANY_OF_SET?n=cn(i):r===Ne.CONTAINS_ALL_OF_SET?n=an(i):r===Ne.PART_OF_SET?n=ln(i):r===Ne.STARTS_WITH?n=pn(i):r===Ne.ENDS_WITH?n=hn(i):r===Ne.CONTAINS_STRING?n=mn(i):r===Ne.IN_SPLIT_TREATMENT?n=bn(i,e):r===Ne.EQUAL_TO_BOOLEAN?n=_n(i):r===Ne.MATCHES_STRING&&(n=Tn(i)),n},wn=Object(s.b)("splitio-engine:sanitize"),kn=Ne,Nn=Ie;function In(t,e){return{key:t,attributes:e}}var Cn=function(t,e,n,r){var i,o,s,c=function(t,e){switch(t){case kn.EQUAL_TO:return"DATETIME"===e?Le:void 0;case kn.GREATER_THAN_OR_EQUAL_TO:case kn.LESS_THAN_OR_EQUAL_TO:case kn.BETWEEN:return"DATETIME"===e?Pe:void 0;case kn.IN_SPLIT_TREATMENT:return In;default:return}}(t,n);switch(n){case Nn.NUMBER:case Nn.DATETIME:o=e,s=Object(a.p)(o),i=isNaN(s)?void 0:s;break;case Nn.STRING:i=function(t){var e=t;Object(a.i)(t)&&(e=t.matchingKey?t.matchingKey:void 0);var n=Object(a.q)(e);return n||void 0}(e);break;case Nn.SET:i=function(t){var e=Array.isArray(t)?Object(a.s)(t.map((function(t){return t+""}))):[];return e.length?e:void 0}(e);break;case Nn.BOOLEAN:i=function(t){if(!0===t||!1===t)return t;if("string"==typeof t){var e=t.toLocaleLowerCase();if("true"===e)return!0;if("false"===e)return!1}}(e);break;case Nn.NOT_SPECIFIED:i=e;break;default:i=void 0}return c&&(i=c(i,r)),wn.debug("Attempted to sanitize [".concat(e,"] which should be of type [").concat(n,"]. \n Sanitized and processed value => [").concat(i instanceof Object?JSON.stringify(i):i,"]")),i},An=Object(s.b)("splitio-engine:value");var jn=function(t,e,n){var r=e.attribute,i=function(t,e,n){var r=void 0;return e?n?(r=n[e],An.debug("Extracted attribute [".concat(e,"], [").concat(r,"] will be used for matching."))):An.warn("Defined attribute [".concat(e,"], no attributes received.")):r=t,r}(t,r,n),o=Cn(e.type,i,e.dataType,n);return void 0!==o?o:void An.warn("Value ".concat(i," ").concat(r?"for attribute ".concat(r," "):0,"doesn't match with expected type."))};function xn(t){return e=function(t){return(t=Number(t))<0?Math.ceil(t):Math.floor(t)}(t),n=Math.pow(2,32),e-Math.floor(e/n)*n;var e,n}function Rn(t){var e=xn(t);return e>=Math.pow(2,31)?e-Math.pow(2,32):e}function Dn(t,e){for(var n=0,r=0;r<t.length;r++)n=Rn(Rn(31*n)+t.charCodeAt(r));return Rn(n^e)}var Mn=function(t,e){return Math.abs(Dn(t,e)%100)+1},Ln=n(11),Pn=n.n(Ln),Un=Pn.a.stringSource,Fn=Pn.a.stringDestination,Gn=Pn.a.encodeUTF16toUTF8;
/*!
 * +----------------------------------------------------------------------------------+
 * | murmurHash3.js v3.0.0 (http://github.com/karanlyons/murmurHash3.js)              |
 * | A TypeScript/JavaScript implementation of MurmurHash3's hashing algorithms.      |
 * |----------------------------------------------------------------------------------|
 * | Copyright (c) 2012-2020 Karan Lyons. Freely distributable under the MIT license. |
 * +----------------------------------------------------------------------------------+
 */
function Kn(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function Bn(t,e){return t<<e|t>>>32-e}
/*!
 * +----------------------------------------------------------------------------------+
 * | murmurHash3.js v3.0.0 (http://github.com/karanlyons/murmurHash3.js)              |
 * | A TypeScript/JavaScript implementation of MurmurHash3's hashing algorithms.      |
 * |----------------------------------------------------------------------------------|
 * | Copyright (c) 2012-2020 Karan Lyons. Freely distributable under the MIT license. |
 * +----------------------------------------------------------------------------------+
 */
function Hn(t,e){e=e||0;for(var n,r=(t=t||"").length%4,i=t.length-r,o=e,a=0,s=3432918353,c=461845907,u=0;u<i;u+=4)a=Kn(a=255&t.charCodeAt(u)|(255&t.charCodeAt(u+1))<<8|(255&t.charCodeAt(u+2))<<16|(255&t.charCodeAt(u+3))<<24,s),a=Kn(a=Bn(a,15),c),o=Kn(o=Bn(o^=a,13),5)+3864292196;switch(a=0,r){case 3:a^=(255&t.charCodeAt(u+2))<<16;case 2:a^=(255&t.charCodeAt(u+1))<<8;case 1:a=Kn(a^=255&t.charCodeAt(u),s),o^=a=Kn(a=Bn(a,15),c)}return o^=t.length,n=o,n=Kn(n^=n>>>16,2246822507),n=Kn(n^=n>>>13,3266489909),(o=n^=n>>>16)>>>0}function Wn(t,e){return Hn((Gn(Un(t),n=Fn()),n()),e>>>0);var n}var zn={hash:Wn,bucket:function(t,e){return Math.abs(Wn(t,e)%100)+1}},Yn=Object(s.b)("splitio-engine");function Vn(t){return 2===t?zn.bucket:Mn}var qn={getTreatment:function(t,e,n,r){var i=Vn(r)(t,e),o=n.getTreatmentFor(i);return Yn.debug("[engine] using algo ".concat(2!==r?"legacy":"murmur"," bucket ").concat(i," for key ").concat(t," using seed ").concat(e," - treatment ").concat(o)),o},shouldApplyRollout:function(t,e,n,r){if(t<100&&Vn(r)(e,n)>t)return!1;return!0}};function Qn(t,e,n,r,i,o){if(t)return{treatment:qn.getTreatment(e,n,r,o),label:i}}var Jn=function(t,e,n,r){return function(i,a,s,c,u,l,f){if("ROLLOUT"===r&&!qn.shouldApplyRollout(s,i.bucketingKey,c,f))return{treatment:void 0,label:"not in split"};var p=t(i,l,u);return o(p)?p.then((function(t){return Qn(t,i.bucketingKey,a,e,n,f)})):Qn(p,i.bucketingKey,a,e,n,f)}},Zn=Object(s.b)("splitio-engine:combiner");function $n(){return Zn.error("Invalid Split provided, no valid conditions found"),{treatment:M,label:"exception"}}function Xn(t){for(var e=t.length,n=0;n<e;n++){var r=t[n];if(void 0!==r)return Zn.debug("Treatment found: ".concat(r.treatment)),r}Zn.debug("All predicates evaluated, no treatment found.")}var tr=function(t){return!Array.isArray(t)||Array.isArray(t)&&0===t.length?$n:function(e,n,r,i,s,c,u){var l=t.map((function(t){return t(e,n,r,i,u,s,c)}));return-1!==Object(a.c)(l,o)?Promise.all(l).then((function(t){return Xn(t)})):Xn(l)}},er=Object(s.b)("splitio-engine:combiner");function nr(t){for(var e,n=0,r=t.length;n<r&&t[n];n++);return e=n===r,er.debug("[andCombiner] evaluates to ".concat(e)),e}var rr=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t.map((function(t){return t.apply(void 0,n)}));return-1!==Object(a.c)(i,o)?Promise.all(i).then(nr):nr(i)}};var ir=function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],a=i.matcherGroup.matchers,s=i.partitions,c=i.label,u=i.conditionType,l=(a=Ue(a)).map((function(t){var n=On(t,e);return function(e,r,i){var a=jn(e,t,r),s=void 0!==a&&n(a,i);return o(s)?s.then((function(e){return Boolean(e^t.negate)})):Boolean(s^t.negate)}}));if(0===l.length){n=[];break}n.push(Jn(rr(l),Ge.parse(s),c,u))}return tr(n)};function or(t,e){return{treatment:Object(a.e)(t,"treatment",e),label:Object(a.e)(t,"label","default rule")}}function ar(t,e){if(!(this instanceof ar))return new ar(t,e);var n;this.baseInfo=t,this.evaluator=e,"string"!=typeof(n=this).baseInfo.defaultTreatment&&(n.baseInfo.defaultTreatment=M)}ar.parse=function(t,e){var n=t.conditions,r=ir(n,e);return new ar(i()({},t),r)},ar.prototype.getKey=function(){return this.baseInfo.name},ar.prototype.getTreatment=function(t,e,n){var r,i,a,s=this.baseInfo,c=s.killed,u=s.seed,l=s.defaultTreatment,f=s.trafficAllocation,p=s.trafficAllocationSeed,d=s.algo;try{r=de(t)}catch(t){return{treatment:M,label:"exception"}}if(this.isGarbage())i=M,a="archived";else{if(!c){var h=this.evaluator(r,u,f,p,e,d,n);return o(h)?h.then((function(t){return or(t,l)})):or(h,l)}i=l,a="killed"}return{treatment:i,label:a}},ar.prototype.isGarbage=function(){return"ARCHIVED"===this.baseInfo.status},ar.prototype.getChangeNumber=function(){return this.baseInfo.changeNumber};var sr=ar,cr={treatment:M,label:"exception",config:null};function ur(t,e,n,r){var i;try{i=r.splits.getSplit(e)}catch(t){return Promise.resolve(cr)}return o(i)?i.then((function(e){return fr(e,t,n,r)})):fr(i,t,n,r)}function lr(t,e,n,r){var i,a={};try{i=r.splits.fetchMany(e)}catch(t){return e.forEach((function(t){a[t]=cr})),Promise.resolve(a)}return o(i)?i.then((function(i){return pr(e,i,t,n,r)})):pr(e,i,t,n,r)}function fr(t,e,n,r){var i={treatment:M,label:"definition not found",config:null};if(t){var s=JSON.parse(t),c=sr.parse(s,r);if(i=c.getTreatment(e,n,ur),o(i))return i.then((function(t){return t.changeNumber=c.getChangeNumber(),t.config=Object(a.e)(s,"configurations.".concat(t.treatment),null),t}));i.changeNumber=c.getChangeNumber(),i.config=Object(a.e)(s,"configurations.".concat(i.treatment),null)}return i}function pr(t,e,n,r,i){var a={},s=[];return t.forEach((function(t){var c=fr(e[t],n,r,i);o(c)?s.push(c.then((function(e){a[t]=e}))):a[t]=c})),s.length>0?Promise.all(s).then((function(){return a})):a}var dr=function t(e,n,r,i){Object($.a)(this,t),this.list=i,this.value=e,n?(n.next=this,this.prev=n):this.prev=null,r?(r.prev=this,this.next=r):this.next=null},hr=function(){function t(){Object($.a)(this,t),this.tail=null,this.head=null,this.length=0}return Object(X.a)(t,[{key:"removeNode",value:function(t){if(t&&t instanceof dr){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e}}},{key:"unshiftNode",value:function(t){if(t&&t instanceof dr&&t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}}},{key:"unshift",value:function(){for(var t=0,e=arguments.length;t<e;t++)this.head=new dr(arguments[t],null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length}}]),t}(),gr="undefined"!=typeof Map?Map:function(){function t(){Object($.a)(this,t)}return Object(X.a)(t,[{key:"set",value:function(t,e){this[t]=e}},{key:"get",value:function(t){return this[t]}},{key:"delete",value:function(t){delete this[t]}},{key:"size",get:function(){return Object.keys(this).length}}]),t}(),mr=function(){function t(e){Object($.a)(this,t),this.maxLen=e||1,this.items=new gr,this.lru=new hr}return Object(X.a)(t,[{key:"get",value:function(t){var e=this.items.get(t);if(e&&e instanceof dr)return this.lru.unshiftNode(e),e.value.value}},{key:"set",value:function(t,e){var n=this.items.get(t);if(n){if(!(n instanceof dr))return!1;this.lru.unshiftNode(n),this.lru.head.value.value=e}else{if(this.lru.length===this.maxLen){var r=this.lru.tail;if(!r)return!1;this.items.delete(r.value.key),this.lru.removeNode(this.lru.tail)}this.lru.unshift({key:t,value:e}),this.items.set(t,this.lru.head)}return!0}}]),t}(),vr=function(){function t(e,n){Object($.a)(this,t),this.cache=new mr(e),this.hasher=n}return Object(X.a)(t,[{key:"testAndSet",value:function(t){if(!t)return null;var e=this.hasher(t),n=this.cache.get(e);return this.cache.set(e,t.time),n}}]),t}();function yr(t){return t||"UNKNOWN"}function br(t){return t?zn.hash(function(t){return"".concat(yr(t.keyName),"\n    :").concat(yr(t.feature),"\n    :").concat(yr(t.treatment),"\n    :").concat(yr(t.label),"\n    :").concat(t.changeNumber||0)}(t)).toString():null}var Er=function(){return new vr(500,br)};function _r(t){return t-t%36e5}var Sr=Object(s.b)("splitio-client:impressions-tracker");function Tr(t){return[R,x].indexOf(t.mode)>-1}var Or=function(t){var e=t.get(t.constants.STORAGE).impressions,n=t.get(t.constants.SETTINGS),r=n.impressionListener,a=t.get(t.constants.INTEGRATIONS_MANAGER,!0),s=n.runtime,c=s.ip,u=s.hostname,l=n.version,f=[],p=Tr(n),d=function(t){return!!Tr(t)&&t.sync.impressionsMode===F}(n),h=Er(),g=t.get(t.constants.IMPRESSIONS_COUNTER);return{queue:function(t,e){f.push({impression:t,attributes:e})},track:function(){var t=f.length,n=f.splice(0,t),s=[];n.forEach((function(t){var e=t.impression;p&&(e.pt=h.testAndSet(e));var n=Date.now();d&&g&&g.inc(e.feature,n,1),(!d||!e.pt||e.pt<_r(n))&&s.push(e)}));var m=e.track(s);if(o(m)&&m.then((function(){Sr.debug("Successfully stored ".concat(t," impression").concat(1===t?"":"s","."))})).catch((function(e){Sr.error("Could not store impressions bulk with ".concat(t," impression").concat(1===t?"":"s",". Error: ").concat(e))})),r||a)for(var v=function(t){var e={impression:i()({},n[t].impression),attributes:n[t].attributes,ip:c,hostname:u,sdkLanguageVersion:l};setTimeout((function(){a&&a.handleImpression(e);try{r&&r.logImpression(e)}catch(t){Sr.error("Impression listener logImpression method threw: ".concat(t,"."))}}),0)},y=0;y<t;y++)v(y)}}},wr=Object(s.b)("splitio-client:event-tracker");var kr=function(t){var e=t.get(t.constants.STORAGE).events,n=t.get(t.constants.INTEGRATIONS_MANAGER,!0);function r(t,e){var r=t.eventTypeId,o=t.trafficTypeName,a=t.key,s=t.value,c=t.timestamp,u=t.properties,l='event of type "'.concat(r,'" for traffic type "').concat(o,'". Key: ').concat(a,". Value: ").concat(s,". Timestamp: ").concat(c,". ").concat(u?"With properties.":"With no properties.");return e?(wr.info("Successfully qeued ".concat(l)),n&&setTimeout((function(){var e=i()({},t);t.properties&&(e.properties=i()({},t.properties)),n.handleEvent(e)}),0)):wr.warn("Failed to queue ".concat(l)),e}return{track:function(t,n){var i=e.track(t,n);return o(i)?i.then(r.bind(null,t)):r(t,i)}}},Nr=Object(s.b)("splitio-client");var Ir=function(t){var e=t.get(t.constants.STORAGE),n=t.get(t.constants.COLLECTORS),r=Or(t),i=kr(t);function a(t,i,a){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=ke.TaskNames[s?"SDK_GET_TREATMENT_WITH_CONFIG":"SDK_GET_TREATMENT"],l=ke.start(u,n),f=ur(t,i,a,e),p=function(e){var n=c(e,i,t,a,s,"getTreatment".concat(s?"withConfig":""));return r.track(),l(),n};return o(f)?f.then((function(t){return p(t)})):p(f)}function s(t,i,a){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=ke.TaskNames[s?"SDK_GET_TREATMENTS_WITH_CONFIG":"SDK_GET_TREATMENTS"],l=ke.start(u,n),f=function(e){var n={};return Object.keys(e).forEach((function(r){n[r]=c(e[r],r,t,a,s,"getTreatments".concat(s?"withConfig":""))})),r.track(),l(),n},p=lr(t,i,a,e);return o(p)?p.then((function(t){return f(t)})):f(p)}function c(e,n,i,o,a,s){var c=t.get(t.constants.READY,!0)||t.get(t.constants.READY_FROM_CACHE,!0),u=Nt(i),l=It(i);c||(e={treatment:M,label:"not ready"});var f=e,p=f.treatment,d=f.label,h=f.changeNumber,g=f.config,m=void 0===g?null:g;return Nr.info("Split: ".concat(n,". Key: ").concat(u,". Evaluation: ").concat(p,". Label: ").concat(d)),C(t,n,d,s)&&(Nr.info("Queueing corresponding impression."),r.queue({feature:n,keyName:u,treatment:p,time:Date.now(),bucketingKey:l,label:d,changeNumber:h},o)),a?{treatment:p,config:m}:p}return{getTreatment:a,getTreatmentWithConfig:function(t,e,n){return a(t,e,n,!0)},getTreatments:s,getTreatmentsWithConfig:function(t,e,n){return s(t,e,n,!0)},track:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1024,c=Nt(e),u=Date.now(),l={eventTypeId:r,trafficTypeName:n,value:o,timestamp:u,key:c,properties:a};return W(n,t,"track"),i.track(l,s)}}};var Cr=function(t,e,n){var r="REDIS"!==t.get(t.constants.SETTINGS).storage.type,o=Ir(t),s=o.getTreatment,c=o.getTreatmentWithConfig,u=o.getTreatments,l=o.getTreatmentsWithConfig,p=o.track;function d(n,r,i,o){var s,c,u=Object(a.o)(o,"getTreatments"),l=e?n:w(n,o),p=u?j(r,o):I(r,o),d=(s=i,c=o,Object(a.i)(s)||null==s?s:(f.error("".concat(c,": attributes must be a plain object.")),!1)),h=Y(t);return V(t,o),{valid:h&&l&&p&&!1!==d,key:l,splitOrSplits:p,attributes:d}}return o.getTreatment=function(t,e,n){var i=d(t,e,n,"getTreatment");return i.valid?s(i.key,i.splitOrSplits,i.attributes):r?M:Promise.resolve(M)},o.getTreatmentWithConfig=function(t,e,n){var o=d(t,e,n,"getTreatmentWithConfig");return o.valid?c(o.key,o.splitOrSplits,o.attributes):r?i()({},L):Promise.resolve(i()({},L))},o.getTreatments=function(t,e,n){var i=d(t,e,n,"getTreatments");if(i.valid)return u(i.key,i.splitOrSplits,i.attributes);var o={};return i.splitOrSplits&&i.splitOrSplits.forEach((function(t){return o[t]=M})),r?o:Promise.resolve(o)},o.getTreatmentsWithConfig=function(t,e,n){var o=d(t,e,n,"getTreatmentsWithConfig");if(o.valid)return l(o.key,o.splitOrSplits,o.attributes);var a={};return o.splitOrSplits&&o.splitOrSplits.forEach((function(t){return a[t]=i()({},L)})),r?a:Promise.resolve(a)},o.track=function(i,o,a,s,c){var u=e?i:w(i,"track"),l=n?o:B(o,"track"),f=h(a,"track"),d=m(s,"track"),g=S(c,"track"),v=g.properties,y=g.size;return Y(t)&&u&&l&&f&&!1!==d&&!1!==v?p(u,l,f,d,v,y):!r&&Promise.resolve(!1)},o};var Ar=function(t){var e,n=t.get(t.constants.SETTINGS),r=Object(a.e)(n,"core.key",void 0),i=Object(a.e)(n,"core.trafficType",void 0);"localhost"===n.mode&&void 0===r?n.core.key="localhost_key":n.core.key=w(r,"Client instantiation");var o=[n.core.key];if(void 0!==i){var s=B(i,"Client instantiation");n.core.trafficType=s,o.push(s)}var c=Cr(t,!0,o.length>1);return c.isBrowserClient=!0,c.getTreatment=c.getTreatment.bind(c,n.core.key),c.getTreatmentWithConfig=c.getTreatmentWithConfig.bind(c,n.core.key),c.getTreatments=c.getTreatments.bind(c,n.core.key),c.getTreatmentsWithConfig=c.getTreatmentsWithConfig.bind(c,n.core.key),c.track=(e=c.track).bind.apply(e,[c].concat(o)),c};var jr=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a=!1;function s(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length,i=new Array(r>1?r-1:0),c=1;c<r;c++)i[c-1]=arguments[c];a||(o=setTimeout((function(){t.apply(void 0,i.concat([s]))}),n))}function c(){clearTimeout(o),o=void 0,a=!0}return c.reset=function(){clearTimeout(o),o=void 0,s.apply(void 0,[e].concat(r))},t.apply(void 0,r.concat([s])),c},xr=function(t,e){return e=e||{},new Promise((function(n,r){var i=new XMLHttpRequest,o=[],a=[],s={},c=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:c,headers:{keys:function(){return o},entries:function(){return a},get:function(t){return s[t.toLowerCase()]},has:function(t){return t.toLowerCase()in s}}}};for(var u in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(t,e,n){o.push(e=e.toLowerCase()),a.push([e,n]),s[e]=s[e]?s[e]+","+n:n})),n(c())},i.onerror=r,i.withCredentials="include"==e.credentials,e.headers)i.setRequestHeader(u,e.headers[u]);i.send(e.body||null)}))};function Rr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Dr(t,e,n){return(Dr=Rr()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&_t(i,n.prototype),i}).apply(null,arguments)}function Mr(t){var e="function"==typeof Map?new Map:void 0;return(Mr=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Dr(t,arguments,wt(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_t(r,t)})(t)}function Lr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wt(t);if(e){var i=wt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ot(this,n)}}var Pr=function(t){St(n,t);var e=Lr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Split Error";return Object($.a)(this,n),(t=e.call(this,r)).message=r,t}return n}(Mr(Error)),Ur=function(t){St(n,t);var e=Lr(n);function n(t){return Object($.a)(this,n),e.call(this,t||"Split Timeout Error")}return n}(Pr),Fr=function(t){St(n,t);var e=Lr(n);function n(t,r){var i;return Object($.a)(this,n),(i=e.call(this,t||"Split Network Error")).statusCode=r,i}return n}(Pr),Gr=Object(s.b)("splitio-services:service");function Kr(t){var e=t.url;return("undefined"!=typeof window&&window.fetch||xr)(e,t).then((function(t){if(!t.ok)throw{response:t};return t})).catch((function(n){var r=n.response,i="";if(r)switch(r.status){case 404:i="Invalid API key or resource not found.";break;default:i=r.statusText}else i=n.message;throw r&&403===r.status||Gr[t.logErrorsAsInfo?"info":"error"]("Response status is not OK. Status: ".concat(r?r.status:"NO_STATUS",". URL: ").concat(e,". Message: ").concat(i)),new Fr(i,r&&r.status)}))}var Br=Kr;var Hr=function(t,e,n,r){var o=t.core.authorizationKey,a=t.version,s=t.runtime,c=s.ip,u=s.hostname,l={},f={};return l.Accept="application/json",l["Content-Type"]="application/json",l.Authorization="Bearer ".concat(o),l.SplitSDKVersion=a,c&&(l.SplitSDKMachineIP=c),u&&(l.SplitSDKMachineName=u),r&&i()(l,r),i()({headers:l,url:t.url(e)},f,n)};function Wr(t){var e=[],n=t.toJSON();return Object(a.d)(n,(function(t,n){e.push({name:n,delta:t})})),e}var zr=Kr;function Yr(t,e){return Hr(t,"/testImpressions/bulk",i()({method:"POST"},e),{SplitSDKImpressionsMode:t.sync.impressionsMode===F?F:U})}function Vr(t,e){return Hr(t,"/testImpressions/count",i()({method:"POST"},e))}function qr(t,e){var n=e.core.labelsEnabled,r=Object(a.g)(t.state(),"feature"),i=[];return Object(a.d)(r,(function(t,e){i.push({f:e,i:t.map((function(t){var e={k:t.keyName,t:t.treatment,m:t.time,c:t.changeNumber};return n&&(e.r=t.label),t.bucketingKey&&(e.b=t.bucketingKey),t.pt&&(e.pt=t.pt),e}))})})),i}function Qr(t){var e=[];if(0===(t?t.size():0))return e;for(var n=t.popAll(),r=Object.keys(n),i=0;i<r.length;i++){var o=r[i].split("::");if(2===o.length){var a=o[0],s=o[1],c={f:a,m:Number(s),rc:n[r[i]]};e.push(c)}}return e}function Jr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wt(t);if(e){var i=wt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Ot(this,n)}}var Zr=function(){function t(e){Object($.a)(this,t),this.storage=e,this.latency=this.latency.bind(this),this.count=this.count.bind(this),this.countException=this.countException.bind(this)}return Object(X.a)(t,[{key:"latency",value:function(t){this.storage.metrics.track("".concat(this.metricType,".time"),t)}},{key:"count",value:function(t){this.storage.count.track("".concat(this.metricType,".status.").concat(t))}},{key:"countException",value:function(){this.storage.count.track("".concat(this.metricType,".exception"))}}]),t}(),$r=function(t){St(n,t);var e=Jr(n);function n(t){var r;return Object($.a)(this,n),(r=e.call(this,t)).metricType="segmentChangeFetcher",r}return n}(Zr),Xr=function(t){St(n,t);var e=Jr(n);function n(t){var r;return Object($.a)(this,n),(r=e.call(this,t)).metricType="splitChangeFetcher",r}return n}(Zr),ti=function(t){St(n,t);var e=Jr(n);function n(t){var r;return Object($.a)(this,n),(r=e.call(this,t)).metricType="mySegmentsFetcher",r}return n}(Zr),ei=function(){function t(e){Object($.a)(this,t),this.storage=e,this.ready=this.ready.bind(this),this.getTreatment=this.getTreatment.bind(this),this.getTreatments=this.getTreatments.bind(this),this.getTreatmentWithConfig=this.getTreatmentWithConfig.bind(this),this.getTreatmentsWithConfig=this.getTreatmentsWithConfig.bind(this)}return Object(X.a)(t,[{key:"ready",value:function(t){this.storage.metrics.track("sdk.ready",t)}},{key:"getTreatment",value:function(t){this.storage.metrics.track("sdk.getTreatment",t)}},{key:"getTreatments",value:function(t){this.storage.metrics.track("sdk.getTreatments",t)}},{key:"getTreatmentWithConfig",value:function(t){this.storage.metrics.track("sdk.getTreatmentWithConfig",t)}},{key:"getTreatmentsWithConfig",value:function(t){this.storage.metrics.track("sdk.getTreatmentsWithConfig",t)}}]),t}(),ni=Object(s.b)("splitio-metrics"),ri=function(t){var e=0,n=t.get(t.constants.SETTINGS),r=t.get(t.constants.STORAGE),o=t.get(t.constants.IMPRESSIONS_COUNTER),s=n.sync.impressionsMode===F,c=function(){if(r.metrics.isEmpty()&&r.count.isEmpty())return Promise.resolve();ni.info("Pushing metrics");var t,e,o,s=ke.start(ke.TaskNames.METRICS_PUSH),c=r.metrics.isEmpty()?null:Br(function(t,e){return Hr(t,"/metrics/times",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify((t=r.metrics,e=[],o=t.toJSON(),Object(a.d)(o,(function(t,n){e.push({name:n,latencies:t})})),e))})).then((function(){return r.metrics.clear()})).catch((function(){return r.metrics.clear()})),u=r.count.isEmpty()?null:Br(function(t,e){return Hr(t,"/metrics/counters",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify(Wr(r.count))})).then((function(){return r.count.clear()})).catch((function(){return r.count.clear()}));return Promise.all([c,u]).then((function(t){return s(),t}))},u=function(){if(r.impressions.isEmpty())return Promise.resolve();var t=r.impressions.queue.length;ni.info("Pushing ".concat(t," impressions"));var i=ke.start(ke.TaskNames.IMPRESSIONS_PUSH);return zr(Yr(n,{body:JSON.stringify(qr(r.impressions,n))})).then((function(){e=0,r.impressions.clear()})).catch((function(n){e?(ni.warn("Droping ".concat(t," impressions after retry. Reason ").concat(n,".")),e=0,r.impressions.clear()):(e++,ni.warn("Failed to push ".concat(t," impressions, keeping data to retry on next iteration. Reason ").concat(n,".")))})).then((function(){return i()}))},l=function(){var t=Qr(o),r=t.length;return 0===r?Promise.resolve():(ni.info("Pushing count of impressions for ".concat(r," features")),zr(Vr(n,{body:JSON.stringify({pf:t})})).then((function(){e=0})).catch((function(t){e?(ni.warn("Droping count of impressions for ".concat(r," features after retry. Reason ").concat(t,".")),e=0):(e++,ni.warn("Failed to push impressions count for ".concat(r," features, keeping data to retry on next iteration. Reason ").concat(t,".")))})))},f=!1,p=!1,d=!1;return{start:function(){f=jr((function(t){return u().then((function(){return t()}))}),n.scheduler.impressionsRefreshRate),p=jr((function(t){return c().then((function(){return t()}))}),n.scheduler.metricsRefreshRate),s&&(d=jr((function(t){return l().then((function(){return t()}))}),18e5))},flush:function(){return s&&l(),u()},stop:function(){f&&f(),p&&p(),d&&d()},collectors:{segmentChanges:new $r(r),splitChanges:new Xr(r),mySegments:new ti(r),client:new ei(r)}}},ii=Kr;function oi(t,e){return Hr(t,"/events/bulk",i()({method:"POST"},e))}var ai=Object(s.b)("splitio-events"),si=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE),r=function(){if(n.events.isEmpty())return Promise.resolve();ai.info("Pushing ".concat(n.events.state().length," queued events."));var t=ke.start(ke.TaskNames.EVENTS_PUSH),r=JSON.stringify(n.events.toJSON()),i=function(){return t()};return n.events.clear(),ii(oi(e,{body:r})).then(i).catch(i)},i=!1,o=!1,a=function(){return o=jr((function(t){return r().then((function(){return t()}))}),e.scheduler.eventsPushRate)};return{start:function(){e.startup.eventsFirstPushWindow>0?i=setTimeout(a,e.startup.eventsFirstPushWindow):a()},flush:function(){return r()},stop:function(){i&&clearTimeout(i),o&&o()},flushAndResetTimer:function(){return ai.info("Flushing events and reseting timer."),o&&o.reset(),r()}}},ci=Kr;function ui(t){return"users="+encodeURIComponent(t)}function li(t){var e,n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent((e=n,atob(e)).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}function fi(t,e){return ci(function(t,e){var n="/auth";if(e){var r=e.map(ui).join("&");r&&(n+="?"+r)}return Hr(t,n)}(t,e)).then((function(t){return t.json()})).then((function(t){if(t.token){var e=li(t.token);if("number"!=typeof e.iat||"number"!=typeof e.exp)throw'token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid';var n=JSON.parse(e["x-ably-capability"]);return i()({decodedToken:e,channels:n},t)}return t}))}function pi(){return"undefined"!=typeof window&&"function"==typeof window.EventSource?window.EventSource:void 0}var di=function(){function t(e,n,r){Object($.a)(this,t),this.baseMillis=n||t.DEFAULT_BASE_MILLIS,this.maxMillis=r||t.DEFAULT_MAX_MILLIS,this.attempts=0,this.cb=e}return Object(X.a)(t,[{key:"scheduleCall",value:function(){var t=this,e=Math.min(this.baseMillis*Math.pow(2,this.attempts),this.maxMillis);return this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout((function(){t.cb()}),e),this.attempts++,e}},{key:"reset",value:function(){this.attempts=0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=0)}}]),t}();di.DEFAULT_BASE_MILLIS=1e3,di.DEFAULT_MAX_MILLIS=18e5;var hi=di,gi=function(){function t(e,n){Object($.a)(this,t),this.mySegmentsStorage=e,this.mySegmentsProducer=n,this.maxChangeNumber=0,this.segmentList=void 0,this.currentChangeNumber=-1,this.put=this.put.bind(this),this.__handleMySegmentUpdateCall=this.__handleMySegmentUpdateCall.bind(this),this.backoff=new hi(this.__handleMySegmentUpdateCall)}return Object(X.a)(t,[{key:"__handleMySegmentUpdateCall",value:function(){var t=this;if(this.maxChangeNumber>this.currentChangeNumber){this.handleNewEvent=!1;var e=this.maxChangeNumber;this.mySegmentsProducer.synchronizeMySegments(this.segmentList).then((function(n){!1!==n&&(t.currentChangeNumber=Math.max(t.currentChangeNumber,e)),t.handleNewEvent?t.__handleMySegmentUpdateCall():t.backoff.scheduleCall()}))}}},{key:"put",value:function(t,e){t<=this.currentChangeNumber||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.segmentList=e,this.mySegmentsProducer.isSynchronizingMySegments()||this.__handleMySegmentUpdateCall())}}]),t}(),mi=function(){function t(e,n,r){Object($.a)(this,t),this.splitStorage=e,this.splitProducer=n,this.maxChangeNumber=0,this.splitsEventEmitter=r,this.put=this.put.bind(this),this.killSplit=this.killSplit.bind(this),this.__handleSplitUpdateCall=this.__handleSplitUpdateCall.bind(this),this.backoff=new hi(this.__handleSplitUpdateCall)}return Object(X.a)(t,[{key:"__handleSplitUpdateCall",value:function(){var t=this;this.maxChangeNumber>this.splitStorage.getChangeNumber()&&(this.handleNewEvent=!1,this.splitProducer.synchronizeSplits().then((function(){t.handleNewEvent?t.__handleSplitUpdateCall():t.backoff.scheduleCall()})))}},{key:"put",value:function(t){t<=this.splitStorage.getChangeNumber()||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.splitProducer.isSynchronizingSplits()||this.__handleSplitUpdateCall())}},{key:"killSplit",value:function(t,e,n){var r=this;this.splitStorage.killLocally(e,n,t).then((function(e){e&&r.splitsEventEmitter.emit(r.splitsEventEmitter.SDK_SPLITS_ARRIVED,!0),r.put(t)}))}}]),t}(),vi=/^control_/,yi=function(){function t(e,n){Object($.a)(this,t),this.EventSource=e,this.streamingUrl=n.url("/sse"),this.reopen=this.reopen.bind(this)}return Object(X.a)(t,null,[{key:"getInstance",value:function(e){var n=pi();if(n)return new t(n,e)}}]),Object(X.a)(t,[{key:"setEventHandler",value:function(t){this.handler=t}},{key:"open",value:function(t){this.close(),this.authToken=t;var e=Object.keys(t.channels).map((function(t){var e=vi.test(t)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(e+t)})).join(","),n="".concat(this.streamingUrl,"?channels=").concat(e,"&accessToken=").concat(t.token,"&v=").concat("1.1","&heartbeats=true");this.connection=new this.EventSource(n),this.handler&&(this.connection.onopen=this.handler.handleOpen,this.connection.onmessage=this.handler.handleMessage,this.connection.onerror=this.handler.handleError)}},{key:"close",value:function(){this.connection&&this.connection.close()}},{key:"reopen",value:function(){this.open(this.authToken)}}]),t}(),bi="STREAMING_DISABLED",Ei="STREAMING_PAUSED",_i="STREAMING_RESUMED";var Si=/control_pri$/;var Ti=Object(s.b)("splitio-sync:sse-handler");function Oi(t){var e,n,r,i,o,s=(e=t,n=-1,r=!0,i=-1,o=!0,{handleOpen:function(){e.emit("PUSH_CONNECT")},isStreamingUp:function(){return o&&r},handleOccupancyEvent:function(t,i,a){Si.test(i)&&a>n&&(n=a,o&&(0===t&&r?e.emit("PUSH_DISCONNECT"):0===t||r||e.emit("PUSH_CONNECT")),r=0!==t)},handleControlEvent:function(t,n,a){Si.test(n)&&a>i&&(i=a,t===bi?e.emit("PUSH_DISABLED"):r&&(t===Ei&&o?e.emit("PUSH_DISCONNECT"):t!==_i||o||e.emit("PUSH_CONNECT")),o=t===_i)}});return{handleOpen:function(){s.handleOpen()},handleError:function(e){var n=e;try{n=function(t){return Object(a.j)(t.data)&&(t.parsedData=JSON.parse(t.data)),t}(e)}catch(t){Ti.warn("Error parsing SSE error notification: ".concat(t))}t.emit("SSE_ERROR",n)},handleMessage:function(e){var n;try{n=function(t){var e=JSON.parse(t.data);return e.parsedData=JSON.parse(e.data),e.name&&"[meta]occupancy"===e.name&&(e.parsedData.type="OCCUPANCY"),e}(e)}catch(t){return void Ti.warn("Error parsing new SSE message notification: ".concat(t))}var r=n,i=r.parsedData,o=r.data,a=r.channel,c=r.timestamp;if(Ti.debug("New SSE message received, with data: ".concat(o,".")),s.isStreamingUp()||"OCCUPANCY"===i.type||"CONTROL"===i.type)switch(i.type){case"SPLIT_UPDATE":t.emit("SPLIT_UPDATE",i.changeNumber);break;case"SEGMENT_UPDATE":t.emit("SEGMENT_UPDATE",i.changeNumber,i.segmentName);break;case"MY_SEGMENTS_UPDATE":t.emit("MY_SEGMENTS_UPDATE",i,a);break;case"SPLIT_KILL":t.emit("SPLIT_KILL",i.changeNumber,i.splitName,i.defaultTreatment);break;case"OCCUPANCY":s.handleOccupancyEvent(i.metrics.publishers,a,c);break;case"CONTROL":s.handleControlEvent(i.controlType,a,c)}}}}function wi(t){return e=zn.hash(t,0).toString(),btoa(e);var e}var ki=Object(s.b)("splitio-sync:push-manager");function Ni(t,e){if(n=ki,pi()?"function"==typeof atob&&"function"==typeof btoa||(n.warn('"atob" and "btoa" functions for Base64 encoding are not available. Falling back to polling mode.'),0):(n.warn("EventSource API is not available. Falling back to polling mode."),0)){var n,r=new Rt.a,o=t.get(t.constants.READINESS).splits,a=t.get(t.constants.SETTINGS),s=t.get(t.constants.STORAGE),c=yi.getInstance(a),u=Oi(r);c.setEventHandler(u);var l,f={},p=[],d=!1,h=new hi(E,a.scheduler.authRetryBackoffBase),g=new hi(c.reopen,a.scheduler.streamingReconnectBackoffBase),m=0;r.on("PUSH_DISCONNECT",S),r.on("PUSH_DISABLED",(function(){_(),r.emit("PUSH_DISCONNECT")})),r.on("SSE_ERROR",(function(t){var e;c.close(),e=!t.parsedData||400!==t.parsedData.statusCode&&401!==t.parsedData.statusCode?g.scheduleCall():h.scheduleCall();var n=t.parsedData&&t.parsedData.message;ki.error("Fail to connect to streaming".concat(n?', with error message: "'.concat(n,'"'):"",". Attempting to reconnect in ").concat(e/1e3," seconds.")),r.emit("PUSH_DISCONNECT")}));var v=t.get(t.constants.PRODUCER),y=new mi(s.splits,v,o);if(p.push(y),r.on("SPLIT_KILL",y.killSplit),r.on("SPLIT_UPDATE",y.put),e)r.on("MY_SEGMENTS_UPDATE",(function(n,r){var i=r.split("_")[2],o=f[i];if(o&&e[o]){var a=e[o].get(t.constants.MY_SEGMENTS_CHANGE_WORKER,!0);a&&a.put(n.changeNumber,n.includesPayload?n.segmentList?n.segmentList:[]:void 0)}}));else{var b=new gi(s.segments,v);p.push(b),r.on("SEGMENT_UPDATE",b.put)}return i()(Object.create(r),{stop:function(){_(),S()},start:E,startNewClient:function(t,e){var n=wi(t),r=e.get(e.constants.STORAGE),i=e.get(e.constants.PRODUCER);f[n]||(f[n]=t,d=!0);var o=new gi(r.segments,i);p.push(o),e.put(e.constants.MY_SEGMENTS_CHANGE_WORKER,o),setTimeout((function(){d&&(d=!1,E())}),0)},removeClient:function(t){var e=wi(t);delete f[e]}})}function E(){l=!1,ki.info("Connecting to push streaming.");var t=e?Object.keys(e):void 0;fi(a,t).then((function(n){if(!l){if(h.reset(),g.reset(),!n.pushEnabled)return ki.info("Streaming is not available. Switching to polling mode."),void r.emit("PUSH_DISCONNECT");if(!(t&&t.length<Object.keys(e).length)){var i=n.decodedToken;c.open(n),function(t,e){m&&clearTimeout(m);var n=e-t-600;ki.info("Refreshing streaming token in ".concat(n," seconds.")),m=setTimeout(E,1e3*n)}(i.iat,i.exp)}}})).catch((function(t){if(!l){c.close(),r.emit("PUSH_DISCONNECT");var e='Failed to authenticate for streaming. Error: "'.concat(t.message,'".');if(t.statusCode>=400&&t.statusCode<500)ki.error(e);else{var n=h.scheduleCall();ki.error("".concat(e,". Attempting to reauthenticate in ").concat(n/1e3," seconds."))}}}))}function _(){l=!0,ki.info("Disconnecting from push streaming."),c.close(),m&&clearTimeout(m),h.reset(),g.reset()}function S(){p.forEach((function(t){return t.backoff.reset()}))}}var Ii=Object(s.b)("splitio-producer:task"),Ci=function(t,e){var n=Object(a.f)(t),r=!1;return{start:function(){r||(Ii.debug("Starting ".concat(n," refreshing each ").concat(e)),r=jr((function(e){Ii.debug("Running ".concat(n)),t().then((function(){return e()}))}),e))},stop:function(){Ii.debug("Stopping ".concat(n)),r&&r(),r=!1},isRunning:function(){return!!r}}};var Ai=function(t,e){return t<1?e:new Promise((function(n,r){var i=setTimeout((function(){r(new Ur("Operation timed out because it exceeded the configured time limit of ".concat(t,"ms.")))}),t);e.then((function(t){clearTimeout(i),n(t)}),(function(t){clearTimeout(i),r(t)}))}))},ji=Kr;function xi(t,e,n){return Hr(t,"/splitChanges?since=".concat(e).concat(n||""))}var Ri=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=t.sync.__splitFiltersValidation.queryString,a=ji(xi(t,e,o)),s=n||i;return a=ke.start(ke.TaskNames.SPLITS_FETCH,!!s&&r,a),n&&(a=Ai(t.startup.requestTimeoutBeforeReady,a)),a.then((function(t){return t.json().catch((function(t){throw new Pr(t.message)}))}))},Di=function(t){var e=new xe;return t.forEach((function(t){t.matcherGroup.matchers.forEach((function(t){var n=t.matcherType,r=t.userDefinedSegmentMatcherData;"IN_SEGMENT"===n&&e.add(r.segmentName)}))})),e},Mi=Object(s.b)("splitio-producer:split-changes");function Li(t){var e=t.reduce((function(t,e){return"ACTIVE"===e.status?(t.added.push([e.name,JSON.stringify(e)]),Di(e.conditions).forEach((function(e){t.segments.add(e)}))):t.removed.push(e.name),t}),{added:[],removed:[],segments:new xe});return e.segments=je(e.segments),e}var Pi=Kr;function Ui(t){return Hr(t,"/mySegments/".concat(encodeURIComponent(Nt(t.core.key))))}var Fi=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=Pi(Ui(t));return r=ke.start(ke.TaskNames.MY_SEGMENTS_FETCH,!!e&&n,r),e&&(r=Ai(t.startup.requestTimeoutBeforeReady,r)),r.then((function(t){return t.json().catch((function(t){throw new Pr(t.message)}))})).then((function(t){return t.mySegments.map((function(t){return t.name}))}))},Gi=Object(s.b)("splitio-producer:my-segments");var Ki=Object(s.b)("splitio-producer:mySegmentsHandler"),Bi=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE).splits,r=t.get(t.constants.READINESS),i=r.splits,o=r.segments,a=function(t){var e=t.getAll(),n=e[t.constants.SETTINGS],r=e[t.constants.READINESS],i=e[t.constants.STORAGE],o=e[t.constants.COLLECTORS],a=r.segments,s=!0,c=!0;function u(t){var e=i.segments.resetSegments(t);i.splits.usesSegments()&&(e||s)&&(s=!1,a.emit(a.SDK_SEGMENTS_ARRIVED))}return function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return(r?new Promise((function(t){u(r),t()})):Fi(n,c,o).then((function(t){c=!1,u(t)}))).catch((function(r){return r instanceof Pr||setTimeout((function(){throw r}),0),c&&n.startup.retriesOnFailureBeforeReady>e?(e+=1,Gi.warn("Retrying download of segments #".concat(e,". Reason: ").concat(r)),t(e)):(c=!1,!1)}))}}(t),s=Ci(u,e.scheduler.segmentsRefreshRate);i.on(i.SDK_SPLITS_ARRIVED,(function(){if(!l)return;var t=n.usesSegments();t!==s.isRunning()&&(Ki.info("Turning segments data polling ".concat(t?"ON":"OFF",".")),t?s.start():s.stop())})),n.usesSegments()?i.once(i.SDK_SPLITS_ARRIVED,f):setTimeout(f,0);var c=!1;function u(t){return c=!0,a(0,t).then((function(t){return c=!1,t}))}var l=!1;function f(){t.get(t.constants.READY,!0)||n.usesSegments()||o.emit(o.SDK_SEGMENTS_ARRIVED)}return{start:function(){l=!0,n.usesSegments()&&s.start()},stop:function(){l=!1,s.stop()},isRunning:function(){return l},isSynchronizingMySegments:function(){return c},synchronizeMySegments:u}},Hi=Object(s.b)("splitio-producer:updater"),Wi=function(t){var e=t.get(t.constants.SETTINGS),n=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.getAll(),r=n[t.constants.SETTINGS],i=n[t.constants.READINESS],a=n[t.constants.STORAGE],s=n[t.constants.COLLECTORS],c=i.splits,u=!0,l=!0;return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;function i(i){Mi.debug("Spin up split update using since = ".concat(i));var o=Ri(r,i,u,s,e).then((function(t){u=!1;var e=Li(t.splits);return Mi.debug("New splits ".concat(e.added.length)),Mi.debug("Removed splits ".concat(e.removed.length)),Mi.debug("Segment names collected ".concat(e.segments)),Promise.all([a.splits.setChangeNumber(t.till),a.splits.addSplits(e.added),a.splits.removeSplits(e.removed),a.segments.registerSegments(e.segments)]).then((function(){(i!==t.till||l)&&(l=!1,c.emit(c.SDK_SPLITS_ARRIVED))}))})).catch((function(e){return e instanceof Pr||(setTimeout((function(){throw e}),0),u=!1),Mi.warn("Error while doing fetch of Splits. ".concat(e)),u&&r.startup.retriesOnFailureBeforeReady>n?(n+=1,Mi.info("Retrying download of splits #".concat(n,". Reason: ").concat(e)),t(n)):(u=!1,!1)}));return u&&a.splits.checkCache()&&c.emit(c.SDK_SPLITS_CACHE_LOADED),o}var f=a.splits.getChangeNumber(),p=o(f)?f:Promise.resolve(f);return p.then(i)}}(t),r=Ci(s,e.scheduler.featuresRefreshRate),i=Bi(t),a=!1;function s(){return a=!0,n().then((function(t){return a=!1,t}))}return{start:function(){Hi.info("Starting BROWSER producer"),r.start(),i.start()},stop:function(){Hi.info("Stopping BROWSER producer"),r.stop(),i.stop()},isRunning:r.isRunning,isSynchronizingSplits:function(){return a},synchronizeSplits:s,isSynchronizingMySegments:i.isSynchronizingMySegments,synchronizeMySegments:i.synchronizeMySegments}},zi=Object(s.b)("splitio-sync:sync-manager");var Yi=Object(s.b)("splitio-client:cleanup"),Vi=function(){function t(e){Object($.a)(this,t),this.storage=e.get(e.constants.STORAGE),this.settings=e.get(e.constants.SETTINGS),this.flushData=this.flushData.bind(this),this.settings.sync.impressionsMode===F&&(this.impressionsCounter=e.get(e.constants.IMPRESSIONS_COUNTER))}return Object(X.a)(t,[{key:"start",value:function(){"undefined"!=typeof window&&window.addEventListener&&(Yi.debug("Registering flush handler when unload page event is triggered."),window.addEventListener("unload",this.flushData))}},{key:"stop",value:function(){"undefined"!=typeof window&&window.removeEventListener&&(Yi.debug("Deregistering flush handler when unload page event is triggered."),window.removeEventListener("unload",this.flushData))}},{key:"flushData",value:function(){this._flushImpressions(),this._flushEvents(),this.impressionsCounter&&this._flushImpressionsCount()}},{key:"_flushImpressions",value:function(){var t=this.storage.impressions;if(!t.isEmpty()){var e=this.settings.url("/testImpressions/beacon"),n=qr(t,this.settings),r={sim:this.settings.sync.impressionsMode===F?F:U};this._sendBeacon(e,n,r)||zr(Yr(this.settings,{body:JSON.stringify(n)})),t.clear()}}},{key:"_flushImpressionsCount",value:function(){var t={pf:Qr(this.impressionsCounter)};if(0!==t.pf.length){var e=this.settings.url("/testImpressions/count/beacon");this._sendBeacon(e,t)||zr(Vr(this.settings,{body:JSON.stringify(t)}))}}},{key:"_flushEvents",value:function(){var t=this.storage.events;if(!t.isEmpty()){var e=this.settings.url("/events/beacon"),n=t.toJSON();this._sendBeacon(e,n)||ii(oi(this.settings,{body:JSON.stringify(n)})),t.clear()}}},{key:"_sendBeacon",value:function(t,e,n){if("undefined"!=typeof navigator&&navigator.sendBeacon){var r={entries:e,token:this.settings.core.authorizationKey,sdk:this.settings.version};n&&i()(r,n);var o=JSON.stringify(r);return navigator.sendBeacon(t,o)}return!1}}]),t}(),qi={};var Qi=function(t,e,n){var r,o=!!n,s=t.get(t.constants.SETTINGS),c=t.get(t.constants.READINESS),u=t.get(t.constants.STORAGE),f=t.get(t.constants.STATUS_MANAGER),p=c.gate,d=c.splits,h=c.segments,g=p.SDK_READY,m=o?void 0:ri(t),v=o?void 0:si(t),y=o?void 0:new Vi(t);switch(s.mode){case R:case x:t.put(t.constants.COLLECTORS,m&&m.collectors),o?r=qi[s.core.authorizationKey].shared(t):(r=function(t){var e={},n=t.get(t.constants.SETTINGS),r=l(!1,t),i=n.streamingEnabled?Ni(t,e):void 0,o=t.get(t.constants.PRODUCER);function s(){o.isRunning()?zi.info("Streaming couldn't connect. Continue periodic fetch of data."):(zi.info("Streaming not available. Starting periodic fetch of data."),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).start()})))}function c(){o.isRunning()&&(zi.info("PUSH (re)connected. Syncing and stopping periodic fetch of data."),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).stop()}))),u()}function u(){t.get(t.constants.PRODUCER).synchronizeSplits(),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).synchronizeMySegments()}))}function l(t,n){var r=t?Bi(n):Wi(n),l=n.get(n.constants.SETTINGS),f=Object(a.q)(Nt(l.core.key));return n.put(n.constants.PRODUCER,r),e[f]&&zi.warn("A client with the same user key has already been created. Only the new instance will be properly synchronized."),e[f]=n,{start:function(){i?(t?o.isRunning()?r.start():r.synchronizeMySegments():(u(),i.on("PUSH_CONNECT",c),i.on("PUSH_DISCONNECT",s)),i.startNewClient(f,n)):r.start()},stop:function(){e[f]&&(delete e[f],i&&(i.removeClient(f),t||i.stop()),r.isRunning()&&r.stop())}}}return r.shared=l.bind(null,!0),r}(t),qi[s.core.authorizationKey]=r);break;case D:t.put(t.constants.READY_FROM_CACHE,!0)}if(e&&r&&!o){var b=e.sdkReadyTracker,E=e.splitsReadyTracker,_=e.segmentsReadyTracker;b.setCollectorForTask(m.collectors),p.once(g,b),d.once(d.SDK_SPLITS_ARRIVED,E),h.once(h.SDK_SEGMENTS_ARRIVED,_)}r&&r.start(),m&&m.start(),v&&t.put(t.constants.EVENTS,v)&&v.start(),t.put(t.constants.COLLECTORS,n);var S=i()(Object.create(f),Ar(t),{destroy:function(){return r&&r.stop(),m&&m.stop(),v&&v.stop(),Promise.all([m&&m.flush(),v&&v.flush()]).then((function(){c.destroy(),y&&y.stop(),u.destroy&&u.destroy(),t.put(t.constants.DESTROYED,!0),o||(l(s.core.authorizationKey),delete qi[s.core.authorizationKey])}))}});return!o&&y.start(S.destroy),{api:S,metricCollectors:m&&m.collectors}};function Ji(t){var e=t.treatment;return t.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:Object(a.j)(t.keys)?[t.keys]:t.keys}}]},partitions:[{treatment:e,size:100}],label:"whitelisted ".concat(e)}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:e,size:100}],label:"default rule"}}var Zi={emptyMock:1};function $i(t){var e=Object.keys(t);return e.length!==Object.keys(Zi).length?(Zi=t,!0):e.some((function(e){var n,r,i=!Zi[e],o=(n=Zi[e],r=t[e],Object(Tt.a)(n)!==Object(Tt.a)(r)||("string"==typeof n?n!==r:n.treatment!==r.treatment||n.config!==r.config)),a=i||o;return a&&(Zi=t),a}))}var Xi=function(t){var e=t.features||{};if(!$i(e))return!1;var n={};return Object(a.d)(e,(function(t,e){var r=t,i=null;Object(a.i)(t)&&(r=t.treatment,i=t.config||i);var o={};null!==i&&(o[r]=i),n[e]={conditions:[Ji({treatment:r})],configurations:o}})),n},to=Object(s.b)("splitio-producer:offline");var eo=function(t,e){var n=e.getAll(),r=n[e.constants.SETTINGS],i=n[e.constants.READINESS],o=n[e.constants.STORAGE];return function(){var e=[],n=null,s={};try{s=t(r)}catch(t){n=t,to.error("There was an issue loading the mock Splits data, no changes will be applied to the current cache. ".concat(t))}return!n&&s?(to.debug("Splits data: "),to.debug(JSON.stringify(s)),Object(a.d)(s,(function(t,n){e.push([n,JSON.stringify({name:n,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:"control",conditions:t.conditions||[],configurations:t.configurations,trafficTypeName:t.trafficTypeName})])})),Promise.all([o.splits.flush(),o.splits.addSplits(e)]).then((function(){i.splits.emit(i.splits.SDK_SPLITS_ARRIVED),i.segments.emit(i.segments.SDK_SEGMENTS_ARRIVED)}))):Promise.resolve()}}.bind(null,Xi),no=function(t){var e=t.get(t.constants.SETTINGS),n=eo(t);return Ci(n,e.scheduler.offlineRefreshRate)};var ro=function(t,e){var n=!e,r=t.get(t.constants.READINESS),o=t.get(t.constants.STORAGE),a=t.get(t.constants.STATUS_MANAGER);n&&setTimeout((function(){r.gate.emit(r.gate.SDK_READY)}),0);var s=n?void 0:no(t);return s&&s.start(),{api:i()(Object.create(a),Ar(t),{destroy:function(){return s&&s.stop(),r.destroy(),o.destroy&&o.destroy(),t.put(t.constants.DESTROYED,!0),!n&&l(),Promise.resolve()}}),metricCollectors:!1}};function io(t,e){var n=!1,r=!1;var i=function t(i){var o=new Promise((function(t,n){return i.then(t,(function(t){r?n(t):e(t)}))})),a=o.then;return o.then=function(e,i){var s=a.call(o,e,i);return"function"==typeof e&&(n=!0),"function"==typeof i?(r=!0,s):t(s)},o}(t);return i.hasOnFulfilled=function(){return n},i}var oo=Object(s.b)("");function ao(t){oo.error(t)}function so(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.get(t.constants.READINESS).gate,r=0,o=!1,a=!1,s=n.SDK_READY,c=n.SDK_READY_FROM_CACHE,u=n.SDK_UPDATE,l=n.SDK_READY_TIMED_OUT;n.on("removeListener",(function(t){t===s&&r--})),n.on("newListener",(function(t){t!==s&&t!==l||(o?oo.error("A listener was added for ".concat(t===s?"SDK_READY":"SDK_READY_TIMED_OUT"," on the SDK, which has already fired and won't be emitted again. The callback won't be executed.")):t===s&&r++)}));var f=p();function p(){var i=io(new Promise((function(c,u){n.once(s,(function(){r!==e||i.hasOnFulfilled()||oo.warn("No listeners for SDK Readiness detected. Incorrect control treatments could have been logged if you called getTreatment/s while the SDK was not yet ready."),t.put(t.constants.READY,!0),o=!0,c()})),n.once(l,(function(e){t.put(t.constants.HAS_TIMEDOUT,!0),a=!0,u(e)}))})),ao);return i}return n.once(c,(function(){oo.info("Split SDK is ready from cache."),t.put(t.constants.READY_FROM_CACHE,!0)})),i()(Object.create(n),{Event:{SDK_READY:s,SDK_READY_FROM_CACHE:c,SDK_UPDATE:u,SDK_READY_TIMED_OUT:l},ready:function(){return a?o?Promise.resolve():io(Promise.reject("Split SDK has emitted SDK_READY_TIMED_OUT event."),ao):f},__context:t})}var co="splitio-ga-to-split:mapper",uo=Object(s.b)("splitio-ga-to-split");var lo,fo=(lo={eventTypeId:{event:"eventAction",social:"socialAction"},eventValue:{event:"eventValue",timing:"timingValue"},eventProperties:{pageview:["page"],screenview:["screenName"],event:["eventCategory","eventLabel"],social:["socialNetwork","socialTarget"],timing:["timingCategory","timingVar","timingLabel"],exception:["exDescription","exFatal"]}},function(t){var e=t.get("hitType"),n=t.get(lo.eventTypeId[e]||"hitType"),r=t.get(lo.eventValue[e]),i={},o=lo.eventProperties[e];if(o)for(var a=0;a<o.length;a++)i[o[a]]=t.get(o[a]);return{eventTypeId:n,value:r,properties:i,timestamp:Date.now()}});var po=/^[^a-zA-Z0-9]+/,ho=/[^-_.:a-zA-Z0-9]+/g;var go=function(t,e,n){var r,o,s,c={prefix:"ga",identities:n.key&&n.trafficType?[{key:n.key,trafficType:n.trafficType}]:void 0};r="splitTracker",o=function n(r,o){Object($.a)(this,n);var s=i()({},c,t,o);this.tracker=r;var u,l=(u=s.identities,Array.isArray(u)?Object(a.r)(u).filter((function(t){if(!t)return!1;var e=t.key,n=t.trafficType;return!(!Object(a.j)(e)&&!Object(a.l)(e)||!Object(a.j)(n))})):[]);if(0!==l.length){var f=l.length-s.identities.length;f&&uo.warn("".concat(f," identities were discarded because they are invalid or duplicated. Identities must be an array of objects with key and trafficType.")),s.identities=l,Object(a.j)(s.prefix)||(uo.warn("The provided `prefix` was ignored since it is invalid. Please check that you are passing a string object as `prefix`."),s.prefix=void 0);var p=r.get("sendHitTask");r.set("sendHitTask",(function(t){if(p(t),!1!==s.hits&&!t.get("splitHit")){try{if(s.filter&&!s.filter(t))return}catch(t){return void uo.warn("GaToSplit custom filter threw: ".concat(t))}var n=fo(t);if(s.mapper){try{n=s.mapper(t,n)}catch(t){return void uo.warn("GaToSplit custom mapper threw: ".concat(t))}if(!n)return}s.prefix&&(n.eventTypeId="".concat(s.prefix,".").concat(n.eventTypeId)),n.eventTypeId=function(t){if(!Object(a.j)(t)||0===t.length)return t;var e=t.replace(po,"").replace(ho,"_"),n=e.slice(0,80);return n.length<e.length&&uo.warn("EventTypeId was truncated because it cannot be more than 80 characters long."),n}(n.eventTypeId),function(t){return!(!h(t.eventTypeId,co)||!1===m(t.value,co)||!1===S(t.properties,co).properties||t.timestamp&&!Object(a.l)(t.timestamp)||t.key&&!1===w(t.key,co)||t.trafficTypeName&&!1===B(t.trafficTypeName,co))}(n)&&(n.key&&n.trafficTypeName?e.events.track(n):s.identities.forEach((function(t){var r=i()({key:t.key,trafficTypeName:t.trafficType},n);e.events.track(r)})))}})),uo.info("Started GA-to-Split integration")}else uo.warn("No valid identities were provided. Please check that you are passing a valid list of identities or providing a traffic type at the SDK configuration.")},s=window.GoogleAnalyticsObject||"ga",window[s]=window[s]||function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];(window[s].q=window[s].q||[]).push(e)},window[s]("provide",r,o)},mo=Object(s.b)("splitio-split-to-ga"),vo=function(){function t(e){if(Object($.a)(this,t),"function"!=typeof t.getGa())return mo.warn("`ga` command queue not found. No hits will be sent."),{};this.trackerNames=t.defaultTrackerNames,e&&("function"==typeof e.filter&&(this.filter=e.filter),"function"==typeof e.mapper&&(this.mapper=e.mapper),Array.isArray(e.trackerNames)&&(this.trackerNames=Object(a.s)(e.trackerNames)),this.impressions=e.impressions,this.events=e.events),mo.info("Started Split-to-GA integration")}return Object(X.a)(t,null,[{key:"defaultMapper",value:function(t){var e=t.type,n=t.payload;switch(e){case"IMPRESSION":return{hitType:"event",eventCategory:"split-impression",eventAction:"Evaluate "+n.impression.feature,eventLabel:"Treatment: "+n.impression.treatment+". Targeting rule: "+n.impression.label+".",nonInteraction:!0};case"EVENT":return{hitType:"event",eventCategory:"split-event",eventAction:n.eventTypeId,eventValue:n.value,nonInteraction:!0}}return null}},{key:"getGa",value:function(){return"undefined"!=typeof window?window[window.GoogleAnalyticsObject||"ga"]:void 0}},{key:"validateFieldsObject",value:function(t){return!(!t||!t.hitType)||(mo.warn("your custom mapper returned an invalid FieldsObject instance. It must be an object with at least a `hitType` field."),!1)}}]),Object(X.a)(t,[{key:"queue",value:function(e){var n=t.getGa();if(n){if(!1===this.impressions&&"IMPRESSION"===e.type)return;if(!1===this.events&&"EVENT"===e.type)return;var r;try{if(this.filter&&!this.filter(e))return;if(r=t.defaultMapper(e),this.mapper&&(!(r=this.mapper(e,r))||!t.validateFieldsObject(r)))return}catch(t){return void mo.warn("SplitToGa queue method threw: ".concat(t,". No hit was sent."))}this.trackerNames.forEach((function(t){var e=t?"".concat(t,".send"):"send";r.splitHit=!0,n(e,r)}))}}}]),t}();vo.defaultTrackerNames=[""];var yo=vo,bo=function(t){var e=t.get(t.constants.SETTINGS),n=[];if(e.integrations.forEach((function(r){var i;switch(r.type){case"GOOGLE_ANALYTICS_TO_SPLIT":var o=t.get(t.constants.STORAGE),a=e.core;i=go(r,o,a);break;case"SPLIT_TO_GOOGLE_ANALYTICS":i=new yo(r)}i&&i.queue&&n.push(i)})),0!==n.length)return{handleImpression:function(t){n.forEach((function(e){return e.queue({type:"IMPRESSION",payload:t})}))},handleEvent:function(t){n.forEach((function(e){return e.queue({type:"EVENT",payload:t})}))}}},Eo=function(){function t(){Object($.a)(this,t),this.cache={}}return Object(X.a)(t,[{key:"_makeKey",value:function(t,e){return"".concat(t,"::").concat(_r(e))}},{key:"inc",value:function(t,e,n){var r=this._makeKey(t,e),i=this.cache[r];this.cache[r]=i?i+n:n}},{key:"popAll",value:function(){var t={};return i()(t,this.cache),this.cache={},t}},{key:"size",value:function(){return Object.keys(this.cache).length}}]),t}(),_o=Object(s.b)("splitio"),So=function(t,e){return"".concat(t.matchingKey?t.matchingKey:t,"-").concat(t.bucketingKey?t.bucketingKey:t,"-").concat(void 0!==e?e:"")};function To(t){var e,n,r={},i={splitsReadyTracker:ke.start(ke.TaskNames.SPLITS_READY),segmentsReadyTracker:ke.start(ke.TaskNames.SEGMENTS_READY),sdkReadyTracker:ke.start(ke.TaskNames.SDK_READY)},o=new pe,l=le(t);o.put(o.constants.SETTINGS,l),e=l.core.authorizationKey,n=!1,null==e?c.error("Factory instantiation: you passed a null or undefined api_key, api_key must be a non-empty string."):Object(a.j)(e)?e.length>0?n=e:c.error("Factory instantiation: you passed an empty api_key, api_key must be a non-empty string."):c.error("Factory instantiation: you passed an invalid api_key, api_key must be a non-empty string."),n&&(u[n]?(c.warn("Factory instantiation: You already have ".concat(u[n]," ").concat(1===u[n]?"factory":"factories"," with this API Key. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application.")),u[n]++):(u[n]=1,Object.keys(u).length>1&&c.warn("Factory instantiation: You already have an instance of the Split factory. Make sure you definitely want this additional instance. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application.")));var f=Bt(),p=f(l.startup.readyTimeout);o.put(o.constants.READINESS,p);var d=so(o);o.put(o.constants.STATUS_MANAGER,d);var h=jt(o);o.put(o.constants.STORAGE,h);var g=new Eo;o.put(o.constants.IMPRESSIONS_COUNTER,g);var m=bo(o);o.put(o.constants.INTEGRATIONS_MANAGER,m);var v="localhost"===l.mode?ro:Qi,y=v(o,i),b=y.api,E=y.metricCollectors,_=Z(h.splits,o),S=de(l.core.key),T=So(S,l.core.trafficType);return r[T]=b,_o.info("New Split SDK instance created."),{client:function(t,e){if(void 0===t)return _o.debug("Retrieving default SDK client."),b;if("function"!=typeof h.shared)throw"Shared Client not supported by the storage mechanism. Create isolated instances instead.";var n,i=w(t,"Shared Client instantiation");if(!1===i)throw"Shared Client needs a valid key.";if(void 0!==e&&!1===(n=B(e,"Shared Client instantiation")))throw"Shared Client needs a valid traffic type or no traffic type at all.";var a=So(i,n);if(r[a])_o.debug("Retrieving existing SDK client.");else{var s=l.overrideKeyAndTT(i,n),c=new pe,u=f(s.startup.readyTimeout);c.put(o.constants.READY_FROM_CACHE,o.get(o.constants.READY_FROM_CACHE,!0)),c.put(o.constants.READINESS,u),c.put(o.constants.STATUS_MANAGER,so(c,-1)),c.put(o.constants.SETTINGS,s),c.put(o.constants.STORAGE,h.shared(s)),c.put(o.constants.IMPRESSIONS_COUNTER,g),r[a]=v(c,!1,E).api,_o.info("New shared client instance created.")}return r[a]},manager:function(){return _o.info("Manager instance retrieved."),_},Logger:s.a,settings:l}}},function(t,e,n){"use strict";n.r(e);n(21);var r=n(9),i=n.n(r);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t){var e;switch(t.env){case"dev":e="p920quvf2i1oppah0u6kichrhi8hnsn6ed79";break;case"test":e="d87lh4b0eoo7sts4efjk3k1l7h55vs05cafm";break;case"prod":e="qian243vmc5db0vgr9srj8m8ta9qo7kp4a0f";break;default:e="qian243vmc5db0vgr9srj8m8ta9qo7kp4a0f"}var n=new i.a({app:"liveengage-tag",splitioOptions:{core:{authorizationKey:e}},subject:s(t),usePreload:!1});return n.ready.then((function(){return n.getCohorts({labels:["LiveEngage-Tag"],attributes:t})}))}var s=function(t){var e;return t.shopper?(o(e={},r.hivemindConstants.idTypes.VISITOR_GUID,t.visitorGuid),o(e,r.hivemindConstants.idTypes.SHOPPER_ID,t.shopper),e):o({},r.hivemindConstants.idTypes.VISITOR_GUID,t.visitorGuid)},c=function(t){return document.cookie.split(";").reduce((function(t,e){var n=e.indexOf("=");return t[e.substring(0,n).trim()]=e.substring(n+1),t}),{})[t]},u=function(){var t=c("visitor");return t&&t.length>4?t.split("=")[1]:""},l=function(t){return t["cp.market"]},f=function(t){return t.app_name||""},p=function(t){var e;if(t["cp.info_idp"])try{(e=JSON.parse(t["cp.info_idp"])).e2s&&(e=e.e2s)}catch(t){console.error("Failed to parse shopper ID in utag.")}return e},d=function(t){var e=p(t);return e?e.info_shopperId:""},h=function(){var t=document.domain,e=t.indexOf("-")>0?t.substring(t.indexOf(".")+1,t.indexOf("-")):"";return""!==e?"".concat(e,"-"):e},g=function(t){var e=null;if(!t.section||!Array.isArray(t.section))return e;var n=t.section.find((function(t){return t.includes("managementLevel")})),r=t.section.find((function(t){return t.includes("managedLevel")})),i=t.section.find((function(t){return t.includes("gdpServiceType")}));switch(!0){case!!n:e=n;break;case!!r:e=r;break;case!!i:e=i}return e};function m(t,e){Object.assign(t,e)}function v(t,e){return new Promise((function(n,r){var i=0,o=Math.max(e,200)/100,a=setInterval((function(){(i+=1)>o&&(clearInterval(a),r("Timed out getting market from utag")),t()&&(clearInterval(a),n())}),100)}))}function y(t){var e=t.utag,n=t.lpTag,r=t.section,i=t.ctmrInfo,o=t.splitioAttributes,a=t.customVars,s=t.maxWaitTime;return new Promise((function(t,c){return e?(e.app_name&&(r.push("app:".concat(e.app_name)),o.app=e.app_name),e.pl_id&&(r.push("plid:".concat(e.pl_id)),a.push({plid:e.pl_id}),r.push("isgd:".concat(1===e.pl_id)),o.plid=e.pl_id),function(t,e){return v((function(){return!!t["cp.market"]}),e).then((function(){return t["cp.market"]}))}(e,s).then((function(s){r.push("market:".concat(e["cp.market"])),o.market=e["cp.market"],a.push({market:e["cp.market"]});var c=e["cp.market"].split("-");2===c.length&&(r.push("lang:".concat(c[0])),o.lang=c[0]);var u=p(e);return u&&(o.shopper=u.info_shopperId,m(i,{customerId:u.info_shopperId}),n.sdes.push({type:"personal",personal:{firstname:u.firstname,lastname:u.lastname}})),t(s)})).catch((function(t){return c(t)}))):t()}))}var b=function(t,e,n,r){var i=function(t,e,n){t.customVars=t.customVars||[],t.ctmrInfo=t.ctmrInfo||{},t.lpTag=t.lpTag||{};var r=t.lpTag;return r.sdes=r.sdes||[],r.section=r.section||[],{utag:e,lpTag:r,section:r.section,location:t.location,ux:t.ux,gdChat:t.gdchat,splitioAttributes:t.splitioAttributes||{},customVars:t.customVars,ctmrInfo:t.ctmrInfo,window:t,maxWaitTime:n||14e3}}(t,e,r);return function(t,e){return v((function(){return t._trfq&&t._trfq.push}),e).then((function(){return t._trfq})).catch((function(){return[]}))}(t,r).then((function(t){return i.trfq=t,function(t){var e=t.trfq,n=t.splitioAttributes,r=t.ctmrInfo;return new Promise((function(t){e.push(["cmdGetTrackingValues",function(e){var i="".concat(e.vtg,"|").concat(e.vg);m(r,{socialId:i}),n.visitorGuid=e.vtg,n.sessionGuid=e.vg,t(e)}])}))}(i).then((function(){return function(t){var e=t.gdChat,n=t.section;return e&&(e.managedLevel&&n.push("managedLevel:".concat(e.managedLevel)),e.vars&&Object.keys(e.vars).forEach((function(t){n.push("".concat(t,":").concat(e.vars[t]))}))),Promise.resolve(e)}(i)})).then((function(){return function(t){var e=t.location,n=t.section,r=t.splitioAttributes,i=t.window;if(e){if(e.hostname){var o=e.hostname.split("."),a="prod";if(o.length>=2){var s=o[o.length-2].split("-");s.length>=2&&(a=s[0])}if("dev"!==a&&"test"!==a||(i.license="5945340"),r.env=a,n.push("env:".concat(a)),o.length>=3){var c=o[o.length-3];n.push("subdomain:".concat(c)),r.subdomain=c}}if(e.pathname&&""!==e.pathname&&"/"!==e.pathname||(n.push("home"),r.context="home",r.path=""),n.push("path:".concat(e.pathname)),r.path=e.pathname,e.pathname){var u=e.pathname.split("/");if(u.length>=2){var l=u[1];l&&(n.push(l),r.context=l)}}/\bCHAT_ENABLE=(true|1)\b/i.test(e.search)&&n.push("chat_enable")}return Promise.resolve(e)}(i)})).then((function(){return y(i)})).then((function(){return function(t){t.ux;var e=t.section,n=t.splitioAttributes,r=t.lpTag;return a(n).then((function(t){for(var n=t.cohorts,i=0,o=Object.keys(n);i<o.length;i++){var a=o[i];e.push("".concat(a,":").concat(n[a].cohortId)),r.sdes.push({type:"service",service:{topic:a,category:n[a].cohortId,serviceId:n[a].eid}})}}))}(i)})).then((function(){var t,e,r,o,a,s;i.customVars.push({chatSourceId:9}),e=(t=i).customVars,m(t.ctmrInfo,{cstatus:JSON.stringify(e)}),r=i.ctmrInfo,o="",a=sessionStorage.getItem("help-bots-api-host"),s=sessionStorage.getItem("help-bots-api-path"),a&&s&&(o="https://".concat(a).concat(s)),m(r,{storeNumber:o}),function(t){var e=t.lpTag,n=t.ctmrInfo;e.sdes.push({type:"ctmrinfo",info:n})}(i),n()})).catch((function(t){return n(t)}))})),i},E=function(t,e){t.lpTag=t.lpTag||{},void 0===t.lpTag._tagCount?(t.lpTag={wl:lpTag.wl||null,scp:lpTag.scp||null,site:t.license||"",section:lpTag.section||"",tagletSection:lpTag.tagletSection||null,autoStart:!1!==lpTag.autoStart,ovr:lpTag.ovr||{},_v:"1.10.0",_tagCount:1,protocol:"https:",events:{bind:function(t,e,n){lpTag.defer((function(){lpTag.events.bind(t,e,n)}),0)},trigger:function(t,e,n){lpTag.defer((function(){lpTag.events.trigger(t,e,n)}),1)}},defer:function(t,e){0===e?(this._defB=this._defB||[],this._defB.push(t)):1===e?(this._defT=this._defT||[],this._defT.push(t)):(this._defL=this._defL||[],this._defL.push(t))},load:function(t,e,n){var r=this;setTimeout((function(){r._load(t,e,n)}),0)},_load:function(t,n,r){var i=t;t||(i=this.protocol+"//"+(this.ovr&&this.ovr.domain?this.ovr.domain:"lptag.liveperson.net")+"/tag/tag.js?site="+this.site);var o=e.createElement("script");o.setAttribute("charset",n||"UTF-8"),r&&o.setAttribute("id",r),o.setAttribute("src",i),e.getElementsByTagName("head").item(0).appendChild(o)},init:function(){this._timing=this._timing||{},this._timing.start=(new Date).getTime();var e=this;t.attachEvent?t.attachEvent("onload",(function(){e._domReady("domReady")})):(t.addEventListener("DOMContentLoaded",(function(){e._domReady("contReady")}),!1),t.addEventListener("load",(function(){e._domReady("domReady")}),!1)),void 0===t._lptStop&&this.load()},start:function(){this.autoStart=!0},_domReady:function(t){this.isDom||(this.isDom=!0,this.events.trigger("LPT","DOM_READY",{t:t})),this._timing[t]=(new Date).getTime()},vars:lpTag.vars||[],dbs:lpTag.dbs||[],ctn:lpTag.ctn||[],sdes:lpTag.sdes||[],hooks:lpTag.hooks||[],identities:lpTag.identities||[],ev:lpTag.ev||[]},lpTag.init()):t.lpTag._tagCount+=1},_=function(t,e,n){var r=t.createElement("div");r.setAttribute("id",e),r.className=n,t.body.appendChild(r)},S=function(t){_(t,"gdchat-fixed-bottom-left","gdchat-fixed-bottom-left"),_(t,"gdchat-fixed-bottom-right","gdchat-fixed-bottom-right")},T=n(18),O=n.n(T),w=function(t,e,n){if(n){var r=t.getElementsByClassName(e);[].forEach.call(r,(function(t){t.innerHTML=n}))}},k=function(t,e){if(t&&t.utilityChatEnabled&&t.target){var n=e.getElementById(t.target);if(n)n.innerHTML=O.a,w(n,"title",t.messages.ChatNow),w(n,"message",t.messages.Chat),w(n,"hour",t.messages.ChatHours),w(n,"online",t.messages.ChatNow),w(n,"offline",t.messages.ChatOffline),new MutationObserver((function(e){e.forEach((function(e){var n=e.target;w(n,"title",t.messages.ChatNow),w(n,"message",t.messages.Chat),w(n,"hour",t.messages.ChatHours),w(n,"online",t.messages.ChatNow),w(n,"offline",t.messages.ChatOffline)}))})).observe(n,{subtree:!0,childList:!0})}},N=function(t,e,n){return function(r){t.push(["cmdLogPageEvent",e,n,[["campaignId",r.campaignId],["engagementId",r.engagementId],["state",r.state],["engagementName",r.engagementName]]])}},I=function(t,e){t.events.bind({eventName:"OFFER_IMPRESSION",func:N(e,"impress","chat.offer.impress"),async:!0,triggerOnce:!1}),t.events.bind({eventName:"OFFER_CLICK",func:N(e,"click","chat.offer.click"),async:!0,triggerOnce:!1}),t.events.bind({eventName:"OFFER_TIMEOUT",func:N(e,"timeout","chat.offer.timeout"),async:!0,triggerOnce:!1}),t.events.bind({eventName:"OFFER_DECLINED",func:N(e,"declined","chat.offer.declined"),async:!0,triggerOnce:!1})},C=function(t,e){t.vars=t.vars||{},e&&(t.vars.enableHelpSearchContactTray=!!e.enableHelpSearchContactTray)},A=function(t,e,n){if(t.location.host){var r,i=t.location.host.split(".");if(i.length>=3&&(r=i[i.length-3]),r&&"cart"==r)new MutationObserver((function(r){r.forEach((function(r){n.getElementById("cart-chat")&&""==n.getElementById("cart-chat").innerHTML&&e.newPage(t.location.href)}))})).observe(n.getElementById("app"),{subtree:!0,childList:!0})}},j=["/websites/web-design","/websites/logo-design","/websites/ecommerce-website-design","/wordpress/wordpress-website-design","/online-marketing/seo-tools","/online-marketing/seo-services"],x={proxyButtonId:"le-proxy-button",findContainerInterval:50,findContainerTimeout:2500,findLiveEngageButtonInterval:50,findLiveEngageButtonTimeout:3e4,contactUsText:{"en-AE":"Contact Us","en-AU":"Contact Us","en-CA":"Contact Us","en-GB":"Contact Us","en-HK":"Contact Us","en-MY":"Contact Us","en-NZ":"Contact Us","en-PH":"Contact Us","en-PK":"Contact Us","en-SG":"Contact Us","en-US":"Contact Us","id-ID":"Ngobrol Sekarang","vi-VN":"nói chuyện ngay","zh-HK":"聯繋客服"},chatNowText:{"en-AE":"Chat Now","en-AU":"Chat Now","en-CA":"Chat Now","en-GB":"Chat Now","en-HK":"Chat Now","en-MY":"Chat Now","en-NZ":"Chat Now","en-PH":"Chat Now","en-PK":"Chat Now","en-SG":"Chat Now","en-US":"Chat Now","id-ID":"Ngobrol Sekarang","vi-VN":"nói chuyện ngay","zh-HK":"聯繋客服"},chatOfflineText:{"en-AE":"Chat Offline","en-AU":"Chat Offline","en-CA":"Chat Offline","en-GB":"Chat Offline","en-HK":"Chat Offline","en-MY":"Chat Offline","en-NZ":"Chat Offline","en-PH":"Chat Offline","en-PK":"Chat Offline","en-SG":"Chat Offline","en-US":"Chat Offline","id-ID":"Obrolan Nonaktif","vi-VN":"Trò chuyện ngoại tuyến","zh-HK":"當前客服不在綫"},chatIconSrc:"https://img1.wsimg.com/dc-assets/live-engage/images/chat-baloon.svg",loadingIconSrc:"https://img1.wsimg.com/dc-assets/live-engage/images/spinner.svg",rules:[{market:"en-US",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:j},{market:"en-US",app:"help",enabled:!1,containers:["gdchat-button-seechange"],exceptions:["/help/contact-us"]},{market:"en-CA",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:[].concat(j,["/"])},{market:"en-CA",app:"help",enabled:!0,containers:["gdchat-button","gdchat"]},{market:"en-GB",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:["/"]},{market:"en-GB",app:"help",enabled:!0,containers:["gdchat"]},{market:"en-AU",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:[].concat(j,["/"])},{market:"en-AU",app:"help",enabled:!0,containers:["gdchat","gdchat-button"]},{market:"en-AE",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:["/"]},{market:"en-AE",app:"help",enabled:!0,containers:["gdchat"]},{market:"en-SG",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:[j,"/"]},{market:"en-SG",app:"help",enabled:!0,containers:["gdchat","gdchat-button"]},{market:"vi-VN",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:[j,"/"]},{market:"vi-VN",app:"help",enabled:!0,containers:["gdchat","gdchat-button"]},{market:"id-ID",app:"help",enabled:!0,containers:["gdchat","gdchat-button"]},{market:"en-PK",app:"sales",enabled:!0,containers:["gdchat-fixed-bottom-right"],exceptions:["/"]},{market:"en-PK",app:"help",enabled:!0,containers:["gdchat"]},{market:"en-NZ",app:"help",enabled:!0,containers:["gdchat","gdchat-button"]}]},R=function(t){document.styleSheets[0].insertRule(t)},D=function(t,e){R("a[data-eid*='it.chat.sticky'] { display: none !important; }");var n=document.createElement("button");n.className="help--contact-us";var r=t.contactUsText[e],i=document.createElement("img");i.src=t.chatIconSrc,i.alt=r;var o=document.createElement("span");o.textContent=r;var a=document.createElement("div");return a.appendChild(i),a.appendChild(o),n.appendChild(a),n},M=function(t,e){R("button[class*='btn-info'] { display: none !important; }");var n=document.createElement("button");n.className="help--chat-now";var r=t.chatNowText[e],i=document.createElement("img");i.src=t.chatIconSrc,i.alt=r;var o=document.createElement("span");return o.textContent=r,n.appendChild(i),n.appendChild(o),n},L={};L.gdchat=M,L["gdchat-button"]=M,L["gdchat-button-seechange"]=M,L["gdchat-fixed-bottom-left"]=D,L["gdchat-fixed-bottom-right"]=D;var P=L;function U(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var G=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.renderers=n}var e,n,r,i,o;return e=t,(n=[{key:"getEnabledForApp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{app_name:null},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.app_name,r=window.location.pathname,i=this.config.rules.find((function(t){var i=t.exceptions||[];return t.market===e&&t.app===n&&(t.enabled&&!i.includes(r)||!t.enabled&&i.includes(r))}));return!!i}},{key:"getContainerIds",value:function(t,e){var n=t.app_name,r=this.config.rules.find((function(t){return t.market===e&&t.app===n}));return r?r.containers:[]}},{key:"getButtonContainer",value:function(t){var e=this.config,n=e.findContainerInterval,r=e.findContainerTimeout;return new Promise((function(e){var i=!1,o=setInterval((function(){var n=document.getElementById(t);n&&(clearInterval(o),i=!0,e(n))}),n);setTimeout((function(){i||(clearInterval(o),e(null))}),r)}))}},{key:"showLoadingIndicator",value:function(t){var e=t.getElementsByTagName("img")[0];e.addEventListener("load",(function t(){e.style.animation="help--load-spin 1s linear infinite",e.removeEventListener("load",t)})),e.src=this.config.loadingIconSrc}},{key:"hideLoadingIndicator",value:function(t){var e=t.getElementsByTagName("img")[0];e.style.animation="none",e.src=this.config.chatIconSrc}},{key:"renderButton",value:function(t,e,n){var r=this,i=this.config,o=i.findLiveEngageButtonInterval,a=i.findLiveEngageButtonTimeout,s=i.chatOfflineText,c=i.proxyButtonId,u=!1,l=!1,f=(0,this.renderers[t.id])(i,n),p="".concat(c,"_").concat(e);f.id=p,t.appendChild(f);var d=setInterval((function(){if(t.lastElementChild&&t.lastElementChild.id!==p&&t.lastElementChild.firstElementChild){var e=t.lastElementChild.firstElementChild;u=!0,r.hideLoadingIndicator(f),e.disabled?(f.disabled=!0,f.title=s[n]):l&&e.click(),clearInterval(d)}}),o);f.addEventListener("click",(function(){u?t.lastElementChild.firstElementChild.click():(l=!0,r.showLoadingIndicator(f))})),setTimeout((function(){u||(f.disabled=!0,f.title=s[n],r.hideLoadingIndicator(f),clearInterval(d))}),a)}},{key:"main",value:(i=regeneratorRuntime.mark((function t(e,n){var r,i,o,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("1"!==c("disable_site_intercept")){t.next=2;break}return t.abrupt("return");case 2:if(r=l(e)){t.next=5;break}return t.abrupt("return");case 5:if(this.getEnabledForApp(e,r)){t.next=8;break}return t.abrupt("return");case 8:return i=this.getContainerIds(e,r),o=i.map((function(t){return a.getButtonContainer(t)})),t.next=12,Promise.all(o);case 12:t.sent.forEach((function(t,e){t&&a.renderButton(t,e,r)}));case 14:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){U(o,n,r,a,s,"next",t)}function s(t){U(o,n,r,a,s,"throw",t)}a(void 0)}))},function(t,e){return o.apply(this,arguments)})}])&&F(e.prototype,n),r&&F(e,r),t}(),K=function(t,e){new G(x,P).main(t,e)},B=function(t){t.events.bind({eventName:"conversationInfo",appName:"lpUnifiedWindow",func:function(t){var e=t.conversationId;e&&function(t){var e=h(),n="https://sso.".concat(e,"godaddy.com/v1/api/validation/token"),r=JSON.stringify({channel_id:"webMessaging",session_id:t});try{fetch(n,{method:"post",body:r,mode:"cors",credentials:"include",headers:{"Content-Type":"application/json"}})}catch(t){}}(e)}})};function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){z(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function z(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Y=function(t){var e=c("info_idp"),n=(e&&JSON.parse(e)||{}).info_shopperId,r=c("pathway"),i=u();return W(W({},{shopperId:n||"",visitorId:i,pathway:r||"",socialId:i?"".concat(i,"|").concat(r):"",conversationId:sessionStorage.getItem("conversationId")||""}),t)};function V(){return window.lpTag||{}}function q(){return window&&window._expDataLayer?window._expDataLayer:[]}function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){Z(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return[]},e=t(),n={sendEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.push({eid:t,schema:"add_event",version:"v2",data:{eid:t,type:"custom",custom_properties:n}})},sendImpression:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.push({eid:t,schema:"add_impression",version:"v2",data:{eid:t,type:"custom",custom_properties:n}})},expDataLayer:e};return n}function X(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=V(),n=J({},t);return e.taglets&&e.taglets.lp_monitoringSDK&&(n.sessionId=e.taglets.lp_monitoringSDK.getSid()),n}function tt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Y(X(e));$(q).sendEvent(t,n)}function et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Y(X(e));$(q).sendImpression(t,n)}var nt=$(q);function rt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ot=function(){var t=function(t){for(var e=t.getElementsByTagName("button"),n=0;n<e.length;n++){var r=e[n];"1"!==r.marked&&function(){r.marked="1";var t=r.innerText;et("dc.messaging.ui.button.impression",{text:t}),r.addEventListener("click",(function(){tt("dc.messaging.ui.button.click",{text:t})}))}()}for(var i=t.getElementsByTagName("img"),o=function(t){var e=i[t],n=e.className,r=e.marked,o=e.src;if(n.includes("agent_avatar"))return"break";"1"!==r&&(e.marked="1",et("dc.messaging.ui.image.impression",{src:o}),e.addEventListener("click",(function(){tt("dc.messaging.ui.image.click",{src:o})})))},a=0;a<i.length;a++){if("break"===o(a))break}for(var s=t.getElementsByTagName("a"),c=function(t){var e=s[t],n=e.href,r=e.marked,i=e.innerText;"1"!==r&&(e.marked="1",et("dc.messaging.ui.link.impression",{href:n,text:i}),e.addEventListener("click",(function(){tt("dc.messaging.ui.link.click",{href:n,text:i})})))},u=0;u<s.length;u++)c(u)},e=window.setInterval((function(){var n=document.getElementsByClassName("lpc_transcript");if(0!==n.length){clearInterval(e);var r=n[0];try{new MutationObserver((function(e){var n,r=rt(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;"childList"===i.type&&i.addedNodes.forEach(t)}}catch(t){r.e(t)}finally{r.f()}})).observe(r,{attributes:!0,childList:!0,subtree:!0})}catch(t){console.error("=== observer failed",t)}}}),200)},at={messageBoxActive:!1,incomingObserver:!1},st=["BEFORE_SURVEY_SUBMIT","BEFORE_ENG_DISPLAY","BEFORE_ENG_CHANNEL_OPEN","AFTER_GET_SURVEY","BEFORE_SUBMIT_SURVEY","BEFORE_SEND_VISITOR_LINE","AFTER_GET_LINES"],ct=function(t){var e=t.name;if("BEFORE_SEND_VISITOR_LINE"===e&&(tt("dc.messaging.ui.user.message.sent"),at.incomingObserver=!0,window.setTimeout(ot(),1e3)),"AFTER_GET_LINES"===e&&at.incomingObserver){var n=t.data.lines;n&&n.forEach((function(t){"agent"===t.source&&tt("dc.messaging.ui.user.message.received")}))}"AFTER_GET_SURVEY"===e&&tt("dc.messaging.ui.user.survey.shown")},ut=["1be4b538-23fe-5c64-aa9a-aef08169bcf3","6f3076f2-7e0d-51b1-a094-4c32cefcfb8c"],lt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0";return ut.includes(t)};function ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var dt={VAR_ADDED:"lp_sdes",MONITORING_STATE:"lp_SMT",state:"lpUnifiedWindow",conversationInfo:"lpUnifiedWindow",engagementData:"lpUnifiedWindow",START:"LP_OFFERS",OFFER_DISPLAY:"LP_OFFERS",OFFER_CLICK:"LP_OFFERS",OFFER_TIMEOUT:"LP_OFFERS",OFFER_REMOVE:"LP_OFFERS"};function ht(){return window.lpTag=window.lpTag||{},window.lpTag}function gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return mt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vt(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}var yt,bt,Et=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,n,r){var i,o,s,p,m,v,y,b,E,_,S,T,O,w,k,N,I;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=h(),t.t0=i,t.next="dev"===t.t0?4:"test"===t.t0?6:8;break;case 4:return o="origin-help.dev-godaddy.com",t.abrupt("break",9);case 6:return o="origin-help.test-godaddy.com",t.abrupt("break",9);case 8:o="gui.godaddy.com";case 9:return(s=sessionStorage.getItem("help-bots-api-host"))&&(o=s),p="https://".concat(o,"/dc-apis/help-bots-api/clientInfo"),m=sessionStorage.getItem("help-bots-api-market")||l(e),v=sessionStorage.getItem("help-bots-api-app")||f(e),y=d(e),b=c("pathway"),E=u(),_=sessionStorage.getItem("help-bots-api-location")||window.location.href,S=g(r),T=sessionStorage.getItem("dialogflow-project-id")||"",O=sessionStorage.getItem("dialogflow-environment")||"",t.next=23,a(window.splitioAttributes);case 23:w=t.sent,k=w.cohorts,N=sessionStorage.getItem("help-bots-api-experiments")||Object.entries(k).map((function(t){var e=gt(t,2),n=e[0],r=e[1];return"".concat(n,"=").concat(r.cohortId)})).join(";"),I=JSON.stringify({conversationId:n,market:m,app:v,shopperId:y,visitId:b,visitorId:E,experiments:N,location:_,routeKey:S,dialogflowProjectId:T,dialogflowEnvironment:O});try{fetch(p,{method:"post",body:I,mode:"cors",headers:{"Content-Type":"application/json"}})}catch(t){}case 28:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){vt(o,r,i,a,s,"next",t)}function s(t){vt(o,r,i,a,s,"throw",t)}a(void 0)}))});return function(t,n,r){return e.apply(this,arguments)}}(),_t=function(t,e){e.events.bind({eventName:"conversationInfo",appName:"lpUnifiedWindow",func:function(n){var r=n.conversationId;r&&r!==yt&&(Et(t,r,e),yt=r)}})},St=function(t){t.events.bind({eventName:"conversationInfo",appName:"lpUnifiedWindow",func:function(t){var e=t.conversationId;e&&e!==bt&&(sessionStorage.setItem("conversationId",e),bt=e)}})};function Tt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var wt=!1,kt=!0;try{document.createEvent("TouchEvent")}catch(t){kt=!1}var Nt=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r+=n["offset".concat(e)],n.offsetParent&&(r+=t(e,n.offsetParent)),r},It=function(){return document.querySelector(".lpc_transcript")},Ct=function(t){var e=document.createElement("a");document.body.appendChild(e),e.href=t,e.setAttribute("download",""),e.setAttribute("target","_blank"),e.click()},At=function(t){if(!wt){var e=t.offsetWidth,n=t.offsetHeight,r=Nt("Left",t),i=Nt("Top",t),o=document.querySelector(".lp_location_center"),a=function(t,e,n,r,i){var o=document.createElement("div");o.className="help--media-overlay",o.style.left="".concat(e,"px"),o.style.top="".concat(n,"px"),o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px"),o.style.backgroundColor="rgba(0, 0, 0, 0.9)",o.style.transition="background-color ".concat(".5s",", left ").concat(".5s",", top ").concat(".5s",", width ").concat(".5s",", height ").concat(".5s");var a=t.cloneNode();a.style.backgroundColor="#fff",a.style.border="1px solid rgba(20, 20, 20, 0)",a.style.transition="border ".concat(".5s"),o.appendChild(a);var s=document.createElement("div");s.className="button-container",s.style.opacity="0",s.style.transition="opacity ".concat(".5s");var c=document.createElement("div"),u=document.createElement("img");u.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xOC4zMzM0IDE0LjE2NjdWMTguMzMzNEgxLjY2NjY5VjE0LjE2NjdIMy4zMzMzNlYxNi42NjY3SDE2LjY2NjdWMTQuMTY2N0gxOC4zMzM0Wk0xMC4wMDAxIDE1LjM0MTdMMTEuMTc1MSAxNC4xNjY3TDE1LjM0MTggMTBMMTQuMTY2OCA4LjgyNTAyTDEwLjgzMzQgMTIuMTU4NFYxLjY2NjY5SDkuMTY2NzVWMTIuMTU4NEw1LjgzMzQyIDguODI1MDJMNC42NTg0MiAxMEw4LjgyNTA5IDE0LjE2NjdMMTAuMDAwMSAxNS4zNDE3WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",c.appendChild(u),c.addEventListener("click",(function(){return Ct(t.src)})),s.appendChild(c);var l=function(){o.style.left="".concat(e,"px"),o.style.top="".concat(n,"px"),o.style.width="".concat(r,"px"),o.style.height="".concat(i,"px"),o.style.backgroundColor="rgba(0, 0, 0, 0)",a.style.border="1px solid rgba(20, 20, 20, 0)",s.style.opacity="0"},f=document.createElement("div"),p=document.createElement("img");p.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE5IDYuNEwxNy42IDVMMTIgMTAuNkw2LjQgNUw1IDYuNEwxMC42IDEyTDUgMTcuNkw2LjQgMTlMMTIgMTMuNEwxNy42IDE5TDE5IDE3LjZMMTMuNCAxMkwxOSA2LjRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",f.appendChild(p),f.addEventListener("click",l),s.appendChild(f);var d=It();return d&&d.addEventListener("keydown",(function(t){wt&&"Escape"===t.key&&l()})),window.addEventListener("keydown",(function(t){wt&&"Escape"===t.key&&l()})),o.appendChild(s),setTimeout((function(){o.style.left="0px",o.style.top="0px",o.style.width="".concat(window.innerWidth,"px"),o.style.height="".concat(window.innerHeight,"px"),s.style.opacity="1",a.style.border="1px solid rgba(20, 20, 20, 1)",o.style.boxShadow="10px 10px 10px rgba(0, 0, 0, .25)",o.addEventListener("transitionend",(function(t){t.target===o&&"top"===t.propertyName&&(wt&&o.parentElement.removeChild(o),wt=!wt)}))}),50),o}(t,r,i-(o?o.scrollTop:0),e,n);document.body.appendChild(a)}},jt=function(){var t=[],e=setInterval((function(){var n=It();if(n){clearInterval(e);var r=setInterval((function(){n||(clearInterval(r),addMediaClickHandlers());var e,i=Tt(n.querySelectorAll(".lp-json-pollock-element-image"));try{var o=function(){var n=e.value;if(!t.includes(n)){var r=n.firstElementChild;if(kt)n.addEventListener("click",(function(){return At(r)}));else{var i=document.createElement("div");i.className="help--media-hover",i.style.opacity=0,i.style.width=n.offsetWidth+"px",i.style.height=n.offsetHeight+"px";var o=document.createElement("button");o.className="hover-icon";var a=document.createElement("img");a.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMy42MTQ2IDAuNzMzODg3VjYuMjE1MzVIMTIuMTgzNFYzLjE3NDA3TDguMzQ3ODMgNy4wMDk2N0w3LjMzODg0IDYuMDAwNjhMMTEuMTc0NCAyLjE2NTA4SDguMTQwMzFWMC43MzM4ODdIMTMuNjE0NlpNNi4wMDA2OCA3LjMzMTY2TDIuMTY1MDggMTEuMTc0NFY4LjE0MDI5SDAuNzMzODg3VjEzLjYxNDZINi4yMTUzNVYxMi4xODM0SDMuMTc0MDdMNy4wMDk2NyA4LjM0NzgxTDYuMDAwNjggNy4zMzE2NloiIGZpbGw9IiMwOTc1N0EiLz4KPC9zdmc+Cg==",o.appendChild(a);var s=document.createElement("button");s.className="hover-icon";var c=document.createElement("img");c.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUiIGhlaWdodD0iMTUiIHZpZXdCb3g9IjAgMCAxNSAxNSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNC45ODE2IDEwLjc1MjNWMTQuMzMwMkgwLjY2OTY3OFYxMC43NTIzSDIuMTAwODdWMTIuODk5SDEzLjU1MDRWMTAuNzUyM0gxNC45ODE2Wk03LjgyNTY0IDExLjc2MTJMOC44MzQ2MyAxMC43NTIzTDEyLjQxMjYgNy4xNzQyN0wxMS40MDM2IDYuMTY1MjhMOC41NDEyMyA5LjAyNzY3VjAuMDE4MzEwNUg3LjExMDA0VjkuMDI3NjdMNC4yNDc2NiA2LjE2NTI4TDMuMjM4NjcgNy4xNzQyN0w2LjgxNjY1IDEwLjc1MjNMNy44MjU2NCAxMS43NjEyWiIgZmlsbD0iIzA5NzU3QSIvPgo8L3N2Zz4K",s.appendChild(c),o.addEventListener("click",(function(){return At(r)})),s.addEventListener("click",(function(){return Ct(n.firstElementChild.src)})),n.addEventListener("mouseover",(function(){return(t=i).style.opacity=1,void(t.style.backgroundColor="rgba(0, 0, 0, 0.1)");var t})),n.addEventListener("mouseout",(function(){return(t=i).style.opacity=0,void(t.style.backgroundColor="transparent");var t})),i.appendChild(o),i.appendChild(s),n.appendChild(i)}t.push(n)}};for(i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}}),1e3)}}),500)};window.utag_data=window.utag_data||{};var xt=window.utag_data;window.gdchat=window.gdchat||{};var Rt=window.gdchat,Dt=window.ux,Mt=Dt&&Dt.eldorado&&Dt.eldorado.chat_data;window.license=Rt.site||"30187337",window.splitioAttributes={},window.lpTag&&window.lpTag.section&&(window.splitioAttributes.newCustomer=window.lpTag.section.includes("newCustomer:true")),function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t={offers:{campaignId:0,confKey:"",connectorId:0,contextId:"",contexts:[],conversationType:null,engagementId:0,engagementName:"",engagementRevision:0,engagementType:null,eventName:"",instantiated:null,renderingType:null,state:null,surveySkillIds:[],windowId:0,zoneId:0},conversation:{agentId:"",agentName:"",conversationId:"",language:"",skill:"",visitorId:""}},e=function(e,n){var r=t[e]||{};Object.entries(n).forEach((function(t){var e=ft(t,2),n=e[0],i=e[1];i&&(r[n]=i)})),t[e]=r},n=window.setInterval((function(){var t=ht();t&&t.sdes&&t.events&&(window.clearInterval(n),t.hooks&&st.forEach((function(e){t.hooks.push({name:e,callback:ct})})),t.events?Object.entries(dt).forEach((function(n){var r=ft(n,2),i=r[0],o=r[1],a={eventName:i,appName:o,func:function(t){if("LP_OFFERS"===o&&e("offers",t),"lpUnifiedWindow"===o&&("conversationInfo"===i&&(e("conversation",t),lt(t.agentId)&&tt("dc.messaging.ui.user.survey.shown")),"state"===i)){var n=t.state;"init"===n&&tt("dc.messaging.ui.window.init"),"waiting"===n&&tt("dc.messaging.ui.window.waiting")}}};t.events.bind(a)})):console.warn("== no lpTag.events found =="))}),100)}(nt),C(Rt,Mt),b(window,xt,(function(){E(window,document),St(window.lpTag),window._trfq=window._trfq||[],I(window.lpTag,window._trfq),A(window,window.lpTag,document),K(xt,window.lpTag),B(window.lpTag),_t(xt,window.lpTag),jt()})),S(document),k(Mt,document)}]);